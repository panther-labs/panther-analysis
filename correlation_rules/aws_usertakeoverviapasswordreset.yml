AnalysisType: correlation_rule
RuleID: "AWS.UserTakeoverViaPasswordReset"
DisplayName: "AWS.UserTakeoverViaPasswordReset"
Enabled: true
Severity: High
Detection:
    - Sequence:
        - ID: Password Reset
          RuleID: AWS.CloudTrail.LoginProfileCreatedOrModified
          MinMatchCount: 1
          # TODO add a discovery step
        - ID: Login
          RuleID: AWS.Console.Login
          MinMatchCount: 1
      Transitions:
        - ID: Match on IP
          From: Password Reset
          To: Login
          Match:
            - On: sourceIPAddress
      Schedule:
        RateMinutes: 15
        TimeoutMinutes: 2
      LookbackWindowMinutes: 60
