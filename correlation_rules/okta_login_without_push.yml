AnalysisType: correlation_rule
RuleID: "Okta.Login.Without.Push"
DisplayName: "Okta Login Without Push"
Enabled: false
Tags:
  - Okta
  - Push Security
  - Identity Verification
  - Configuration Required
  - Credential Access
Reports:
  MITRE ATT&CK:
    - TA0001:T1078 # Initial Access: Valid Accounts
    - TA0006:T1539 # Credential Access: Steal Web Session Cookie
    - TA0006:T1621 # Credential Access: Multi-Factor Authentication Request Generation
Severity: Critical
Description: >
  This correlation rule identifies successful Okta authentication events that are not followed by a corresponding Push Security authorized login within 60 minutes for the same user. Push Security provides an additional layer of identity verification and authentication assurance beyond standard Okta MFA. When a legitimate user logs into Okta, they should subsequently authenticate through Push Security as part of the organization's layered security controls. The absence of a Push Security login following an Okta authentication may indicate several security concerns: compromised credentials being used by an attacker who cannot complete the Push Security verification, session hijacking where an attacker has obtained a valid Okta session token without possessing the user's Push Security authentication factors, MFA bypass attempts through phishing-resistant authentication gaps, or unauthorized access through stolen or weak credentials. This detection helps identify cases where standard Okta MFA was satisfied but the additional Push Security verification layer was bypassed or not completed, suggesting potential credential compromise or session theft. Organizations using Push Security as a defense-in-depth strategy should investigate these events to determine if the Okta login was legitimate but the user forgot to complete Push verification, or if the access represents unauthorized activity. This rule requires configuration to match your organization's specific Push Security integration and expected authentication workflows. The 60-minute time window accounts for users who may delay their Push Security login after Okta authentication, but this should be adjusted based on organizational policies and typical user behavior patterns.
Runbook: |
  1. Review the alert details to identify the user account that logged into Okta without a corresponding Push Security login and note the timestamp of the Okta authentication event
  2. Check the user's recent Okta authentication history in the Okta admin console (Reports > System Log) and verify whether Push Security authentication occurred after the 60-minute detection window
  3. Contact the user directly through a trusted communication channel to verify if they logged into Okta during the identified timeframe and if they completed the Push Security authentication step
  4. Review the source IP address, geolocation, device, and user agent information from the Okta session to identify unfamiliar locations, devices, or signs of impossible travel
  5. Examine the Okta MFA method used for this authentication and assess if it could have been compromised, then analyze actions taken during the session for suspicious activities
  6. Check for other anomalous behavior from this user account across all systems including cloud resources, VPN connections, email activity, and file access
  7. If credential compromise or session hijacking is suspected: Force password reset, revoke all active Okta sessions and refresh tokens, require re-enrollment of MFA devices, and scan user devices for malware
  8. Review Push Security configuration and integration settings to ensure proper enforcement and that it is configured as a required step after Okta login
  9. Document the incident including timeline, findings, user verification results, and remediation actions in your security incident management system
  10. If this is a false positive, adjust the correlation rule parameters or implement conditional access policies in Okta to enforce Push Security authentication before granting access to sensitive applications
Reference: https://www.okta.com/resources/datasheet/okta-adaptive-multi-factor-authentication-product-datasheet/
Detection:
  - Sequence:
      - ID: Okta
        RuleID: Okta.Login.Success
      - ID: Push
        RuleID: Push.Security.Authorized.IdP.Login
        Absence: true
    Transitions:
      - ID: Okta to Push
        From: Okta
        To: Push
        WithinTimeFrameMinutes: 60
        Match:
          - From: actor.alternateId
            To: new.email
    Schedule:
      RateMinutes: 1440
      TimeoutMinutes: 10
    LookbackWindowMinutes: 2160
Tests:
  - Name: Okta Login, Followed By Push Authorized Login
    ExpectedResult: false
    RuleOutputs:
      - ID: Okta
        Matches:
          actor.alternateId:
            frodo.baggins@hobbiton.com:
              - 0
      - ID: Push
        Matches:
          new.email:
            frodo.baggins@hobbiton.com:
              - 3
  - Name: Okta Login, Not Followed By Push Authorized Login
    ExpectedResult: true
    RuleOutputs:
      - ID: Okta
        Matches:
          actor.alternateId:
            frodo.baggins@hobbiton.com:
              - 0
  - Name: Okta Login, Followed By Push Authorized Login By Other User
    ExpectedResult: true
    RuleOutputs:
      - ID: Okta
        Matches:
          actor.alternateId:
            frodo.baggins@hobbiton.com:
              - 0
      - ID: Push
        Matches:
          new.email:
            samwise.gamgee@hobbiton.com:
              - 3
