AnalysisType: rule
Filename: aws_vpcflow_successful_inbound_ssh_signal_demo.py
RuleID: "AWS.VPCFlow.SuccessfulInboundSSH.Signal.Demo"
DisplayName: "AWS VPCFlow Successful Inbound SSH (Signal)"
Enabled: true
LogTypes:
  - AWS.VPCFlow
Tags:
  - vpc
  - network
  - demo
  - ssh
Severity: Info
CreateAlert: false
Description: >
  Signal for successful inbound TCP connections to port 22 (SSH) in AWS VPCFlow logs. 
  Use this to monitor for external SSH access attempts that were allowed by security groups or NACLs. 
  This is a signal only and does not generate alerts directly.
SummaryAttributes:
  - srcAddr
  - dstAddr
  - srcPort
  - dstPort
  - action
  - protocol
  - account
  - interfaceId
  - vpcId
Tests:
  - Name: Successful inbound SSH from external IP
    ExpectedResult: true
    Log:
      action: ACCEPT
      protocol: 6
      dstPort: 22
      srcAddr: 8.8.8.8
      dstAddr: 172.31.10.5
      account: "123456789012"
      interfaceId: eni-12345678
      vpcId: vpc-12345678
  - Name: Outbound SSH or not port 22
    ExpectedResult: false
    Log:
      action: ACCEPT
      protocol: 6
      dstPort: 22
      srcAddr: 172.31.10.5
      dstAddr: 8.8.8.8
      account: "123456789012"
      interfaceId: eni-12345678
      vpcId: vpc-12345678
  - Name: Rejected SSH connection
    ExpectedResult: false
    Log:
      action: REJECT
      protocol: 6
      dstPort: 22
      srcAddr: 8.8.8.8
      dstAddr: 172.31.10.5
      account: "123456789012"
      interfaceId: eni-12345678
      vpcId: vpc-12345678 