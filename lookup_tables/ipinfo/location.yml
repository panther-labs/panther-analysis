AnalysisType: lookup_table
LookupName: ipinfo_location
Schema: IpInfo.Location
Refresh:
  RoleARN: arn:aws:iam::893421435052:role/panther-ipinfo-access-role
  ObjectPath: s3://panther-ipinfo-ha771dhqm13j11czzb6kcpuy6ueccusw2a-s3alias/luts/data/ipinfo/location.csv
  PeriodMinutes: 60
Description: IpInfo Location data is the identification of an IP address' geographic location in the real world.
Reference: https://docs.panther.com/enrichment/ipinfo
Enabled: false
LogTypeMap:
  PrimaryKey: ip
  AssociatedLogTypes:
    - LogType: AlphaSOC.Alert
      Selectors:
        - "$.event.srcIP"
    - LogType: Apache.AccessCombined
      Selectors:
        - "remote_host_ip_address"
    - LogType: Apache.AccessCommon
      Selectors:
        - "remote_host_ip_address"
    - LogType: Asana.Audit
      Selectors:
        - "$.context.client_ip_address"
    - LogType: Atlassian.Audit
      Selectors:
        - "$.attributes.location.ip"
    - LogType: AWS.ALB
      Selectors:
        - "clientIp"
    - LogType: AWS.CloudTrail
      Selectors:
        # add p_any_ip_addresses because we extract ip addresses from polymorphic events
        - "sourceIPAddress"
        - "p_any_ip_addresses"
    - LogType: AWS.GuardDuty
      Selectors:
        # use p_any_ip_addresses because we extract ip addresses from polymorphic events
        - "p_any_ip_addresses"
    - LogType: AWS.S3ServerAccess
      Selectors:
        - "remoteip"
    - LogType: AWS.VPCDns
      Selectors:
        # use p_any_ip_addresses because the answers are variable and not always ip addresses
        - "p_any_ip_addresses"
    - LogType: AWS.VPCFlow
      Selectors:
        - "dstAddr"
        - "srcAddr"
    - LogType: AWS.WAFWebACL
      Selectors:
        - "$.httpRequest.clientIp"
    - LogType: CiscoUmbrella.CloudFirewall
      Selectors:
        - "destinationIp"
        - "sourceIp"
    - LogType: CiscoUmbrella.DNS
      Selectors:
        - "externalIp"
        - "internalIp"
    - LogType: CiscoUmbrealla.IP
      Selectors:
        - "destinationIp"
        - "sourceIp"
    - LogType: CiscoUmbrella.Proxy
      Selectors:
        - "destinationIp"
        - "externalIp"
        - "internalIp"
    - LogType: Cloudflare.HttpRequest
      Selectors:
        - "ClientIP"
        - "EdgeServerIP"
        - "OriginIP"
    - LogType: Cloudflare.Firewall
      Selectors:
        - "ClientIP"
    - LogType: Cloudflare.Spectrum
      Selectors:
        - "ClientIP"
        - "OriginIP"
    - LogType: Crowdstrike.AIDMaster
      Selectors:
        - "aip"
    - LogType: Crowdstrike.ActivityAudit
      Selectors:
        - "UserIp"
    - LogType: Crowdstrike.CriticalFile
      Selectors:
        - "aip"
    - LogType: Crowdstrike.DetectionSummary
      Selectors:
        - "LocalIP"
        - "OriginSourceIpAddress"
    - LogType: Crowdstrike.DNSRequest
      Selectors:
        - "IpAddress"
    - LogType: Crowdstrike.GroupIdentity
      Selectors:
        - "aip" 
    - LogType: Crowdstrike.ManagedAssets
      Selectors:
        - "GatewayIP"
    - LogType: Crowdstrike.NetworkConnect
      Selectors:
        - "LocalAddressIP4"
        - "LocalAddressIP6"
        - "RemoteAddressIP4"
        - "RemoteAddressIP6"
    - LogType: Crowdstrike.NetworkListen
      Selectors:
        - "LocalAddressIP4"
        - "LocalAddressIP6"
        - "RemoteAddressIP4"
        - "RemoteAddressIP6"
    - LogType: Crowdstrike.NotManagedAssets
      Selectors:
        - "aip"
        - "CurrentLocalIP"
        - "LocalAddressIP4"
    - LogType: Crowdstike.ProcessRollup2
      Selectors:
        - "aip"
    - LogType: Crowdstrike.ProcessRollup2Stats
      Selectors:
        - "aip"
    - LogType: Crowdstrike.SyntheticProcessRollup2
      Selectors:
        - "aip"
    - LogType: Crowdstrike.Unknown
      Selectors:
        - "aip"
    - LogType: Crowdstrike.UserIdentity
      Selectors:
        - "aip"
    - LogType: Crowdstrike.UserLogonLogoff
      Selectors:
        - "aip"
    - LogType: Dropbox.TeamEvent
      Selectors:
        - "$.origin.geo_location.ip_address"
    - LogType: Duo.Authentication
      Selectors:
        - "$.access_device.ip"
        - "$.auth_device.ip"
    - LogType: Box.Event
      Selectors:
        - "ip_address"
    - LogType: Fastly.Access
      Selectors:
        - "remote_host_ip_address"
    - LogType: GCP.AuditLog
      Selectors:
        - "$.protoPayload.requestMetadata.callerIP"
        - "$.httpRequest.remoteIP"
        - "$.httpRequest.serverIP"
    - LogType: GCP.HTTPLoadBalancer
      Selectors:
        - "$.httpRequest.remoteIP"
        - "$.httpRequest.serverIP"
    - LogType: GitLab.API
      Selectors:
        - "remote_ip"
    - LogType: GitLab.Exceptions
      Selectors:
        - "remote_ip"
    - LogType: GitLab.Integrations
      Selectors:
        - "p_any_ip_addresses"
    - LogType: GitLab.Production
      Selectors:
        - "remote_ip"
    - LogType: Gravitational.TeleportAudit
      Selectors:
        - "dst_addr"
        - "src_addr"
    - LogType: GSuite.ActivityEvent
      Selectors:
        - "ipAddress"
    - LogType: GSuite.Reports
      Selectors:
        - "ipAddress"
    - LogType: Jamfpro.Login
      Selectors:
        - "ipAddress"
    - LogType: Juniper.Access
      Selectors:
        # use p_any_ip_addresses because we extract ip addresses but have no fields
        - "p_any_ip_addresses"
    - LogType: Juniper.Audit
      Selectors:
        - "login_ip"
    - LogType: Juniper.Firewall
      Selectors:
        - "SRC"
        - "DST"
    - LogType: Juniper.Security
      Selectors:
        - "source_ip"
    - LogType: Lacework.Events
      Selectors:
        # use p_any_ip_addresses because we extract ip addresses but fields are variable
        - "p_any_ip_addresses"
    - LogType: Lacework.AgentManagement
      Selectors:
        - "IP_ADDR"
    - LogType: Lacework.Connections
      Selectors:
        - "$.ENDPOINT_DETAILS.dst_ip_addr"
        - "$.ENDPOINT_DETAILS.src_ip_addr"
    - LogType: Lacework.ContainerSummary
      Selectors:
        - "$.PROPS_CONTAINER.POD_IP_ADDR"
        - "$.PROPS_CONTAINER.IPV4"
    - LogType: Lacework.DNSQuery
      Selectors:
        - "DNS_SERVER_IP"
        - "HOST_IP_ADDR"
    - LogType: Lacework.Image
      Selectors:
        - "p_any_ip_addresses"
    - LogType: Lacework.Interfaces
      Selectors:
        - "IP_ADDR"
    - LogType: Lacework.InternalIPA
      Selectors:
        - "IP_ADDR"
    - LogType: Lacework.MachineSummary
      Selectors:
        - "PRIMARY_IP_ADDR"
    - LogType: Lacework.PodSummary
      Selectors:
        - "PRIMARY_IP_ADDR"
    - LogType: Microsoft365.Audit.AzureActiveDirectory
      Selectors:
        - "ActorIpAddress"
        - "ClientIP"
    - LogType: Microsoft365.Audit.Exchange
      Selectors:
        - "ClientIP"
        - "ClientIPAddress"
    - LogType: Microsoft365.Audit.SharePoint
      Selectors:
        - "ClientIP"
    - LogType: Microsoft365.Audit.General
      Selectors:
        - "ClientIP"
    - LogType: Microsoft365.DLP.All
      Selectors:
        - "ClientIP"
    - LogType: MicrosoftGraph.SecurityAlert #Beta
      Selectors:
        - "$.cloudAppStates[0].destinationServiceIp"
        - "$.hostStates[6].privateIpAddress"
        - "$.cloudAppStates[7].publicIpAddress"
        - "$.networkConnections[1].destinationAddress"
        - "$.networkConnections[9].natDestinationAddress"
        - "$.networkConnections[11].natSourceAddress"
        - "$.networkConnections[15].sourceAddress"
    - LogType: MongoDB.OrganizationalEvent
      Selectors:
        - "remoteAddress"
    - LogType: MongoDB.ProjectEvent
      Selectors:
        - "remoteAddress"
    - LogType: Nginx.Access
      Selectors:
        - "remoteAddr"
    - LogType: Okta.SystemLog
      Selectors:
        - "$.client.ipAddress"
    - LogType: OneLogin.Events
      Selectors:
        - "ipaddr"
    - LogType: OnePassword.ItemUsage
      Selectors:
        - "$.client.ip_address"
    - LogType: OnePassword.SignInAttempt
      Selectors:
        - "$.client.ip_address"
    - LogType: OSSEC.EventInfo
      Selectors:
        - "srcip"
        - "agentip"
        - "dstgeoip"
        - "dstip"
    - LogType: Salesforce.Login
      Selectors:
        - "CLIENT_IP"
        - "SOURCE_IP"
    - LogType: Salesforce.LoginAs
      Selectors:
        - "CLIENT_IP"
    - LogType: Salesforce.Logout
      Selectors:
        - "CLIENT_IP"
    - LogType: Salesforce.URI
      Selectors:
        - "CLIENT_IP"
    - LogType: Slack.AccessLogs
      Selectors:
        - "ip"
    - LogType: Slack.AuditLogs
      Selectors:
        - "$.context.ip_address"
    - LogType: Sophos.Central
      Selectors:
        - "$.source_info.ip"
    - LogType: Suricata.Alert
      Selectors:
        - "$.tls.sni"
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.DHCP
      Selectors:
        - "dest_ip"
        - "$.dhcp.assigned_ip"
        - "src_ip"
    - LogType: Suricata.Anomaly
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.DNS
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.FileInfo
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.Flow
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.HTTP
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.SSH
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Suricata.TLS
      Selectors:
        - "dest_ip"
        - "src_ip"
    - LogType: Zeek.Conn
      Selectors:
        - "id.orig_h"
        - "id.resp_h" 
    - LogType: Zeek.DHCP
      Selectors:
        - "requested_addr"
    - LogType: Zeek.DNS
      Selectors:
        - "id.orig_h"
        - "id.resp_h"
    - LogType: Zeek.DPD
      Selectors:
        - "id.orig_h"
        - "id.resp_h"
    - LogType: Zeek.Files
      Selectors:
        - "$.rx_hosts[0]" # type array
        - "$.tx_hosts[0]" # type array
    - LogType: Zeek.HTTP
      Selectors:
        - "id.orig_h"
        - "id.resp_h"
    - LogType: Zeek.Notice
      Selectors:
        - "dst"
        - "id.orig_h"
        - "id.resp_h"
        - "src"
    - LogType: Zeek.NTP
      Selectors:
        - "id.orig_h"
        - "id.resp_h"   
    - LogType: Zeek.Software
      Selectors:
        - "host"
    - LogType: Zeek.SSH
      Selectors:
        - "id.orig_h"
        - "id.resp_h"
    - LogType: Zeek.Stats
      Selectors:
        - "id.orig_h"
        - "id.resp_h"        
    - LogType: Zeek.Tunnel
      Selectors:
        - "id.orig_h"
        - "id.resp_h"        
    - LogType: Zeek.Weird
      Selectors:
        - "id.orig_h"
        - "id.resp_h"                     
    - LogType: Zendesk.Audit
      Selectors:
        - "ip_address"
    - LogType: Zoom.Activity
      Selectors:
        - "ip_address"
