{"eventName": "LeaveOrganization", "eventSource": "organizations.amazonaws.com", "awsService": "Organizations", "description": "Removes a member account from its parent organization.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "An AWS account attempted to leave the AWS Organization", "link": "hhttps://docs.datadoghq.com/security/default_rules/aws-organizations-leave-organization/"}], "securityImplications": "Attackers might use LeaveOrganization to disassociate resources and disrupt the structure of AWS organizations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws organizations leave-organization"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.organizations-leave"}], "permissions": "https://aws.permissions.cloud/iam/organizations#organizations-LeaveOrganization"}
{"eventName": "ListOrganizationalUnitsForParent", "eventSource": "organizations.amazonaws.com", "awsService": "Organizations", "description": "Lists the organizational units (OUs) in a parent organizational unit or root.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [], "securityImplications": "Attackers might use ListOrganizationalUnitsForParent to map the structure of an organization's AWS environment for potential vulnerabilities.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws organizations list-organizational-units-for-parent --parent-id r-traildiscover"}], "permissions": "https://aws.permissions.cloud/iam/organizations#organizations-ListOrganizationalUnitsForParent"}
{"eventName": "ListAccounts", "eventSource": "organizations.amazonaws.com", "awsService": "Organizations", "description": "Lists all the accounts in the organization.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [], "securityImplications": "Attackers might use ListAccounts to gather information about the structure and resources of an organization's AWS environment.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws organizations list-accounts"}], "permissions": "https://aws.permissions.cloud/iam/organizations#organizations-ListAccounts"}
{"eventName": "DescribeOrganization", "eventSource": "organizations.amazonaws.com", "awsService": "Organizations", "description": "Retrieves information about the organization that the user's account belongs to.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeOrganization to gather information about the structure and details of an AWS organization.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws organizations describe-organization"}], "permissions": "https://aws.permissions.cloud/iam/organizations#organizations-DescribeOrganization"}
{"eventName": "GetParameters", "eventSource": "ssm.amazonaws.com", "awsService": "SSM", "description": "Get information about one or more parameters by specifying multiple parameter names.", "mitreAttackTactics": ["TA0007 - Discovery", "TA0006 - Credential Access"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery", "T1552 - Unsecured Credentials"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Detecting and removing risky actions out of your IAM security policies", "link": "https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/"}], "securityImplications": "Attackers might use GetParameters to gather sensitive information such as api keys or other secrets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ssm get-parameters --names TrailDiscoverParameters"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.ssm-retrieve-securestring-parameters"}], "permissions": "https://aws.permissions.cloud/iam/ssm#ssm-GetParameters"}
{"eventName": "StartSession", "eventSource": "ssm.amazonaws.com", "awsService": "SSM", "description": "Initiates a connection to a target (for example, a managed node) for a Session Manager session.", "mitreAttackTactics": ["TA0008 - Lateral Movement", "TA0002 - Execution"], "mitreAttackTechniques": ["T1021 - Remote Services", "T1651 - Cloud Administration Command"], "usedInWild": true, "incidents": [{"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "Run Shell Commands on EC2 with Send Command or Session Manager", "link": "https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/"}], "securityImplications": "Attackers might use StartSession to gain unauthorized access to managed instances.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ssm start-session --target TrailDiscoverTarget"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.execution.ssm-start-session"}], "permissions": "https://aws.permissions.cloud/iam/ssm#ssm-StartSession"}
{"eventName": "DescribeInstanceInformation", "eventSource": "ssm.amazonaws.com", "awsService": "SSM", "description": "Provides information about one or more of your managed nodes, including the operating system platform, SSM Agent version, association status, and IP address.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeInstanceInformation to gather sensitive information about the instances, potentially leading to unauthorized access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ssm describe-instance-information --instance-information-filter-list key=InstanceIds,valueSet=TrailDiscoverInstanceIds"}], "permissions": "https://aws.permissions.cloud/iam/ssm#ssm-DescribeInstanceInformation"}
{"eventName": "SendCommand", "eventSource": "ssm.amazonaws.com", "awsService": "SSM", "description": "Runs commands on one or more managed nodes.", "mitreAttackTactics": ["TA0008 - Lateral Movement", "TA0002 - Execution"], "mitreAttackTechniques": ["T1021 - Remote Services", "T1651 - Cloud Administration Command"], "usedInWild": true, "incidents": [{"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "Run Shell Commands on EC2 with Send Command or Session Manager", "link": "https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/"}], "securityImplications": "Attackers might use SendCommand to execute malicious commands on managed instances.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ssm send-command --instance-ids \"TrailDiscoverInstanceID\" --document-name \"AWS-RunShellScript\" --parameters commands=ls --output text"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.execution.ssm-send-command"}], "permissions": "https://aws.permissions.cloud/iam/ssm#ssm-SendCommand"}
{"eventName": "GetSecretValue", "eventSource": "secretsmanager.amazonaws.com", "awsService": "SecretsManager", "description": "Retrieves the contents of the encrypted fields SecretString or SecretBinary from the specified version of a secret, whichever contains content.", "mitreAttackTactics": ["TA0006 - Credential Access"], "mitreAttackTechniques": ["T1555 - Credentials from Password Stores"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [], "securityImplications": "Attackers might use GetSecretValue to illicitly access sensitive information stored in the SecretsManager.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws secretsmanager get-secret-value --secret-id TrailDiscoverSecretId"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.secretsmanager-batch-retrieve-secrets"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.secretsmanager-retrieve-secrets"}], "permissions": "https://aws.permissions.cloud/iam/secretsmanager#secretsmanager-GetSecretValue"}
{"eventName": "ScheduleKeyDeletion", "eventSource": "kms.amazonaws.com", "awsService": "KMS", "description": "Schedules the deletion of a KMS key.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": " Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use ScheduleKeyDeletion to schedule the deletion of crucial encryption keys, disrupting data security and access.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-7"}], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/kms#kms-ScheduleKeyDeletion"}
{"eventName": "RemoveTargets", "eventSource": "events.amazonaws.com", "awsService": "events", "description": "Removes the specified targets from the specified rule.", "mitreAttackTactics": ["TA0040 - Impact", "TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1489 - Service Stop", "T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use RemoveTargets in AWS EventBridge to eliminate crucial targets from event rules, effectively disabling intended actions or notifications triggered by specific events.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws events remove-targets --rule TrailDiscoverRule --ids TrailDiscoverTargetId"}], "permissions": "https://aws.permissions.cloud/iam/events#events-RemoveTargets"}
{"eventName": "PutRule", "eventSource": "events.amazonaws.com", "awsService": "events", "description": "Creates or updates the specified rule.", "mitreAttackTactics": ["TA0040 - Impact", "TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1489 - Service Stop", "T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use PutRule in AWS EventBridge to create unauthorized event rules, potentially automating malicious actions or triggering unwarranted responses within the environment.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws events put-rule --name TrailDiscoverRule --schedule-expression 'rate(5 minutes)' --state ENABLED --description \"TrailDiscover rule\""}], "permissions": "https://aws.permissions.cloud/iam/events#events-PutRule"}
{"eventName": "DisableRule", "eventSource": "events.amazonaws.com", "awsService": "events", "description": "Disables the specified rule.", "mitreAttackTactics": ["TA0040 - Impact", "TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1489 - Service Stop", "T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS EventBridge Rule Disabled or Deleted", "link": "https://www.elastic.co/guide/en/security/7.17/rules-api-delete.html"}, {"description": "AWS EventBridge rule disabled or deleted", "link": "https://docs.datadoghq.com/security/default_rules/aws-eventbridge-rule-disabled-or-deleted/"}], "securityImplications": "Attackers might use DisableRule to deactivate AWS EventBridge rules, effectively silencing alarms and automated responses designed for incident detection and mitigation.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws events disable-rule --name TrailDiscoverRule --event-bus-name TrailDiscoverBus"}], "permissions": "https://aws.permissions.cloud/iam/events#events-DisableRule"}
{"eventName": "DeleteRule", "eventSource": "events.amazonaws.com", "awsService": "events", "description": "Deletes the specified rule.", "mitreAttackTactics": ["TA0040 - Impact", "TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1489 - Service Stop", "T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS EventBridge Rule Disabled or Deleted", "link": "https://www.elastic.co/guide/en/security/7.17/rules-api-delete.html"}, {"description": "AWS EventBridge rule disabled or deleted", "link": "https://docs.datadoghq.com/security/default_rules/aws-eventbridge-rule-disabled-or-deleted/"}], "securityImplications": "Attackers might use DeleteRule to disrupt automated security responses and event logging in AWS EventBridge, potentially masking unauthorized activities or compromising system integrity.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws events delete-rule --name TrailDiscoverRule"}], "permissions": "https://aws.permissions.cloud/iam/events#events-DeleteRule"}
{"eventName": "ListTargetsByRule", "eventSource": "events.amazonaws.com", "awsService": "events", "description": "Lists the targets assigned to the specified rule.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use ListTargetsByRule in AWS EventBridge to enumerate the targets of specific rules, gaining insights into the architecture and response mechanisms of an environment.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws events list-targets-by-rule --rule TrailDiscoverRule"}], "permissions": "https://aws.permissions.cloud/iam/events#events-ListTargetsByRule"}
{"eventName": "ListRules", "eventSource": "events.amazonaws.com", "awsService": "events", "description": "Lists your Amazon EventBridge rules. You can either list all the rules or you can provide a prefix to match to the rule names.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use ListRules in AWS EventBridge to catalog active event rules, identifying critical automated security mechanisms or logging functions to target for disruption or evasion.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws events list-rules --name-prefix TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/events#events-ListRules"}
{"eventName": "DeleteLogStream", "eventSource": "logs.amazonaws.com", "awsService": "CloudWatchLogs", "description": "Deletes the specified log stream and permanently deletes all the archived log events associated with the log stream.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Generate Strong Security Signals with Sumo Logic & AWS Cloudtrail", "link": "https://expel.com/blog/following-cloudtrail-generating-aws-security-signals-sumo-logic/"}], "securityImplications": "Attackers might use DeleteLogStream to erase CloudWatch logs, erasing evidence of their activities within AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws logs delete-log-stream --log-group-name TrailDiscoverLogGroupName --log-stream-name TrailDiscoverLogStreamName"}], "permissions": "https://aws.permissions.cloud/iam/logs#logs-DeleteLogStream"}
{"eventName": "DescribeLogGroups", "eventSource": "logs.amazonaws.com", "awsService": "CloudWatchLogs", "description": "Lists the specified log groups.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeLogGroups to discover CloudWatch log configurations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws logs describe-log-groups --log-group-name-prefix TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/logs#logs-DescribeLogGroups"}
{"eventName": "DeleteLogGroup", "eventSource": "logs.amazonaws.com", "awsService": "CloudWatchLogs", "description": "Deletes the specified log group and permanently deletes all the archived log events associated with the log group.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Penetration testing of aws-based environments", "link": "https://essay.utwente.nl/76955/1/Szabo_MSc_EEMCS.pdf"}, {"description": "Generate Strong Security Signals with Sumo Logic & AWS Cloudtrail", "link": "https://expel.com/blog/following-cloudtrail-generating-aws-security-signals-sumo-logic/"}], "securityImplications": "Attackers might use DeleteLogGroup to erase CloudWatch logs, erasing evidence of their activities within AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws logs delete-log-group --log-group-name TrailDiscoverLogGroup"}], "permissions": "https://aws.permissions.cloud/iam/logs#logs-DeleteLogGroup"}
{"eventName": "GetLogRecord", "eventSource": "logs.amazonaws.com", "awsService": "CloudWatchLogs", "description": "Retrieves all of the fields and values of a single log event.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetLogRecord to precisely extract information from CloudWatch logs, potentially exposing sensitive data or insights into AWS operational activities.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/logs#logs-GetLogRecord"}
{"eventName": "DescribeLogStreams", "eventSource": "logs.amazonaws.com", "awsService": "CloudWatchLogs", "description": "Lists the log streams for the specified log group.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeLogStreams to discover CloudWatch log configurations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws logs describe-log-streams --log-group-name TrailDiscoverLogGroupName"}], "permissions": "https://aws.permissions.cloud/iam/logs#logs-DescribeLogStreams"}
{"eventName": "DescribeSubscriptionFilters", "eventSource": "logs.amazonaws.com", "awsService": "CloudWatchLogs", "description": "Lists the subscription filters for the specified log group.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeSubscriptionFilters to discover CloudWatch log configurations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws logs describe-subscription-filters --log-group-name TrailDiscoverLogGroupName"}], "permissions": "https://aws.permissions.cloud/iam/logs#logs-DescribeSubscriptionFilters"}
{"eventName": "DeleteAlarms", "eventSource": "monitoring.amazonaws.com", "awsService": "CloudWatch", "description": "Deletes the specified alarms. You can delete up to 100 alarms in one operation.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS CloudWatch Alarm Deletion", "link": "https://www.elastic.co/guide/en/security/current/aws-cloudwatch-alarm-deletion.html"}], "securityImplications": "Attackers might use DeleteAlarms to disable critical CloudWatch alerts, undermining AWS environment monitoring", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws cloudwatch delete-alarms --alarm-names TrailDiscoverAlarm"}], "permissions": "https://aws.permissions.cloud/iam/cloudwatch#cloudwatch-DeleteAlarms"}
{"eventName": "UpdateDevEndpoint", "eventSource": "glue.amazonaws.com", "awsService": "Glue", "description": "Updates a specified development endpoint.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use UpdateDevEndpoint to modify the settings of a development endpoint, potentially disrupting data processing tasks or gaining unauthorized access to data.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_passed_role_to_glue_development_endpoint.yml"}], "simulation": [{"type": "commandLine", "value": "aws glue update-dev-endpoint --endpoint-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/glue#glue-UpdateDevEndpoint"}
{"eventName": "CreateJob", "eventSource": "glue.amazonaws.com", "awsService": "Glue", "description": "Creates a new job definition.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use CreateJob to create a glue job with a role with higer privileges to gain these privileges.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws glue create-job --name TrailDiscoverJob --role TrailDiscoverRole --command Name=pythonshell,ScriptLocation=s3://TrailDiscoverBucket/TrailDiscoverScript.py --default-arguments '{\"--job-language\": \"python\"}'"}], "permissions": "https://aws.permissions.cloud/iam/glue#glue-CreateJob"}
{"eventName": "CreateDevEndpoint", "eventSource": "glue.amazonaws.com", "awsService": "Glue", "description": "Creates a new development endpoint.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use CreateDevEndpoint in AWS Glue to escalate privileges or provision development endpoints, potentially exploiting them.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_passed_role_to_glue_development_endpoint.yml"}], "simulation": [{"type": "commandLine", "value": "aws glue create-dev-endpoint --endpoint-name TrailDiscover --role-arn arn:aws:iam::111122223333:role/TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/glue#glue-CreateDevEndpoint"}
{"eventName": "UpdateJob", "eventSource": "glue.amazonaws.com", "awsService": "Glue", "description": "Updates an existing job definition.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use UpdateJob to modify Glue job parameters, potentially disrupting data processing or injecting malicious code.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws glue update-job --job-name TrailDiscoverJob --job-update '{\"Role\": \"TrailDiscoverRole\", \"Command\": {\"Name\": \"glueetl\", \"ScriptLocation\": \"s3://mybucket/myscript.py\"}}'"}], "permissions": "https://aws.permissions.cloud/iam/glue#glue-UpdateJob"}
{"eventName": "ListServiceQuotas", "eventSource": "servicequotas.amazonaws.com", "awsService": "ServiceQuotas", "description": "Lists the applied quota values for the specified AWS service.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use ListServiceQuotas to identify potential services to exploit by understanding their usage limits.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws service-quotas list-service-quotas --service-code TrailDiscoverServiceCode"}], "permissions": "https://aws.permissions.cloud/iam/servicequotas#servicequotas-ListServiceQuotas"}
{"eventName": "RequestServiceQuotaIncrease", "eventSource": "servicequotas.amazonaws.com", "awsService": "ServiceQuotas", "description": "Submits a quota increase request for the specified quota at the account or resource level.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}], "researchLinks": [], "securityImplications": "Attackers might use RequestServiceQuotaIncrease to increase the quotas and so resource hijacking will have a bigger impact.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws service-quotas request-service-quota-increase --service-code ec2 --quota-code L-20F13EBD --desired-value 2"}], "permissions": "https://aws.permissions.cloud/iam/servicequotas#servicequotas-RequestServiceQuotaIncrease"}
{"eventName": "GetPublicAccessBlock", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Retrieves the PublicAccessBlock configuration for an Amazon S3 bucket.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetPublicAccessBlock to identify S3 buckets with public access for potential data breaches.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "N/A"}
{"eventName": "GetObject", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Retrieves an object from Amazon S3.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1048 - Exfiltration Over Alternative Protocol"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Incident 2 - Additional details of the attack", "link": "https://support.lastpass.com/s/document-item?language=en_US&bundleId=lastpass&topicId=LastPass/incident-2-details.html&_LANG=enus"}, {"description": "Aruba Central Security Incident", "link": "https://www.arubanetworks.com/support-services/security-bulletins/central-incident-faq/"}, {"description": "Sendtech Pte. Ltd", "link": "https://www.pdpc.gov.sg/-/media/Files/PDPC/PDF-Files/Commissions-Decisions/Decision---Sendtech-Pte-Ltd---220721.ashx?la=en"}, {"description": "GotRoot! AWS root Account Takeover", "link": "https://medium.com/@gchib/naturesbasket-aws-root-account-takeover-e4aa5c5e95e1"}, {"description": "A Technical Analysis of the Capital One Cloud Misconfiguration Breach", "link": "https://www.fugue.co/blog/a-technical-analysis-of-the-capital-one-cloud-misconfiguration-breach"}, {"description": "Chegg, Inc", "link": "https://www.ftc.gov/system/files/ftc_gov/pdf/2023151-Chegg-Complaint.pdf"}, {"description": "Scattered Spider Attack Analysis", "link": "https://www.reliaquest.com/blog/scattered-spider-attack-analysis-account-compromise/"}, {"description": "Enumerate AWS Account ID from a Public S3 Bucket", "link": "https://hackingthe.cloud/aws/enumeration/account_id_from_s3_bucket/"}], "researchLinks": [{"description": "Data Exfiltration through S3 Server Access Logs", "link": "https://hackingthe.cloud/aws/exploitation/s3_server_access_logs/"}, {"description": "S3 Streaming Copy", "link": "https://hackingthe.cloud/aws/exploitation/s3_streaming_copy/"}], "securityImplications": "Attackers might use GetObject to download data from S3 buckets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.impact.s3-ransomware-client-side-encryption"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.impact.s3-ransomware-batch-deletion"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.impact.s3-ransomware-individual-deletion"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-GetObject"}
{"eventName": "GetBucketPolicy", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Returns the policy of a specified bucket.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetBucketPolicy to identify weak security policies and exploit them for unauthorized access to S3 buckets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws s3api get-bucket-policy --bucket TrailDiscoverBucket"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-GetBucketPolicy"}
{"eventName": "ListBuckets", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Returns a list of all buckets owned by the authenticated sender of the request.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "A Technical Analysis of the Capital One Cloud Misconfiguration Breach", "link": "https://www.fugue.co/blog/a-technical-analysis-of-the-capital-one-cloud-misconfiguration-breach"}, {"description": "Enumerate AWS Account ID from a Public S3 Bucket", "link": "https://hackingthe.cloud/aws/enumeration/account_id_from_s3_bucket/"}, {"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use ListAllMyBuckets to identify potential targets for data breaches or unauthorized access.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_enum_buckets.yml"}], "simulation": [{"type": "commandLine", "value": "aws s3api list-buckets --query \"Buckets[].Name\""}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance"}], "permissions": "N/A"}
{"eventName": "GetBucketVersioning", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Returns the versioning state of a bucket.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}], "researchLinks": [], "securityImplications": "Attackers might use GetBucketVersioning to identify unsecured S3 buckets with versioning disabled, making it easier to manipulate or delete data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws s3api get-bucket-versioning --bucket TrailDiscoverBucket"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-GetBucketVersioning"}
{"eventName": "PutBucketVersioning", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Sets the versioning state of an existing bucket.", "mitreAttackTactics": ["TA0040 - Impact", "TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1490 - Inhibit System Recovery", "T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}], "researchLinks": [{"description": "Exfiltrating S3 Data with Bucket Replication Policies", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "securityImplications": "Attackers might set the versioning to 'Suspended' before deleting data. Attackers might enable versioning to add bucket replication to exfiltrate data.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_disable_bucket_versioning.yml"}], "simulation": [{"type": "commandLine", "value": "aws s3api put-bucket-versioning --bucket TrailDiscoverBucket --versioning-configuration Status=Enabled"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-PutBucketVersioning"}
{"eventName": "GetBucketLogging", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Returns the logging status of a bucket and the permissions users have to view and modify that status.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetBucketLoggingStatus to identify if logging is enabled, potentially helping them avoid detection during unauthorized activities.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws s3api get-bucket-logging --bucket TrailDiscoverBucket"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-GetBucketLogging"}
{"eventName": "DeleteBucketPolicy", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Deletes the policy of a specified bucket.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS S3 Bucket Configuration Deletion", "link": "https://www.elastic.co/guide/en/security/7.17/aws-s3-bucket-configuration-deletion.html"}], "securityImplications": "Attackers might use DeleteBucketPolicy to remove security policies and gain unauthorized access to S3 buckets.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-8"}], "simulation": [{"type": "commandLine", "value": "aws s3api delete-bucket-policy --bucket TrailDiscoverBucketName"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-DeleteBucketPolicy"}
{"eventName": "PutBucketAcl", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Sets the permissions on an existing bucket using access control lists (ACL).", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1048 - Exfiltration Over Alternative Protocol"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS S3 Bucket ACL made public", "link": "https://docs.datadoghq.com/security/default_rules/aws-bucket-acl-made-public/"}], "securityImplications": "Attackers might use SetBucketAccessControlPolicy to modify access control lists, potentially granting unauthorized access to S3 buckets.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-8"}], "simulation": [{"type": "commandLine", "value": "aws s3api put-bucket-acl --bucket TrailDiscoverBucket --acl TrailDiscoverAcl"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-PutBucketAcl"}
{"eventName": "DeleteObject", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Removes an object from a bucket. The behavior depends on the bucket's versioning state.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "The attack on ONUS – A real-life case of the Log4Shell vulnerability", "link": "https://cystack.net/research/the-attack-on-onus-a-real-life-case-of-the-log4shell-vulnerability"}, {"description": "20/20 Eye Care Network and Hearing Care Network notify 3,253,822 health plan members of breach that deleted contents of AWS buckets", "link": "https://www.databreaches.net/20-20-eye-care-network-and-hearing-care-network-notify-3253822-health-plan-members-of-breach-that-deleted-contents-of-aws-buckets/"}, {"description": "Hacker Puts Hosting Service Code Spaces Out of Business", "link": "https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteObject to erase crucial data from S3 buckets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.impact.s3-ransomware-client-side-encryption"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.impact.s3-ransomware-batch-deletion"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.impact.s3-ransomware-individual-deletion"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-DeleteObject"}
{"eventName": "HeadObject", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "The HEAD operation retrieves metadata from an object without returning the object itself.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1619 - Cloud Storage Object Discovery"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [], "securityImplications": "Attackers might use HeadObject to gather metadata about sensitive files stored in S3.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "N/A"}
{"eventName": "ListObjects", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Returns some or all (up to 1,000) of the objects in a bucket.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1619 - Cloud Storage Object Discovery"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [], "securityImplications": "Attackers might use ListObjects to identify potentially sensitive objects stored in S3 buckets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "N/A"}
{"eventName": "JobCreated", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "When a Batch Operations job is created, it is recorded as a JobCreated event in CloudTrail.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Exfiltrating S3 Data with Bucket Replication Policies", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "securityImplications": "Attackers might use Batch Operations jobs to initiate unauthorized data transfer or manipulation tasks in S3.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "N/A"}
{"eventName": "GetBucketReplication", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Returns the replication configuration of a bucket.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetBucketReplication to identify replication configurations and target specific data for theft or corruption.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws s3api get-bucket-replication --bucket TrailDiscoverBucket"}], "permissions": "N/A"}
{"eventName": "PutBucketReplication", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Creates a replication configuration or replaces an existing one.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Exfiltrating S3 Data with Bucket Replication Policies", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "securityImplications": "Attackers might use PutBucketReplication to replicate sensitive data to unauthorized S3 buckets controlled by the attacker.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-8"}], "simulation": [{"type": "commandLine", "value": "aws s3api put-bucket-replication --bucket AWSDOC-EXAMPLE-BUCKET1 --replication-configuration '{\"Role\":\"\",\"Rules\":[]}'"}], "permissions": "N/A"}
{"eventName": "GetBucketAcl", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "This implementation of the GET action uses the acl subresource to return the access control list (ACL) of a bucket.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Public S3 bucket through bucket ACL", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/vulnerabilities/s3-bucket-public-acl/"}], "securityImplications": "Attackers might use GetBucketAccessControlPolicy to gain unauthorized access to sensitive data stored in S3 buckets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws s3api get-bucket-acl --bucket TrailDiscoverBucket"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-GetBucketAcl"}
{"eventName": "PutBucketLifecycle", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Creates a new lifecycle configuration for the bucket or replaces an existing lifecycle configuration.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": true, "incidents": [{"description": "USA VS Nickolas Sharp", "link": "https://www.justice.gov/usao-sdny/press-release/file/1452706/dl"}], "researchLinks": [], "securityImplications": "Attackers might use PutBucketLifecycle to add a lifecycle that deletes data after one day.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-8"}], "simulation": [{"type": "commandLine", "value": "aws s3api put-bucket-lifecycle --bucket my-bucket --lifecycle-configuration '{\"Rules\":[{\"ID\":\"\",\"Status\": \"Enabled\", \"Prefix\": \"TrailDiscover/\"}]}'"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.cloudtrail-lifecycle-rule"}], "permissions": "N/A"}
{"eventName": "PutObject", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Adds an object to a bucket.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1565 - Data Manipulation"], "usedInWild": true, "incidents": [{"description": "Incident Report: TaskRouter JS SDK Security Incident - July 19, 2020", "link": "https://www.twilio.com/en-us/blog/incident-report-taskrouter-js-sdk-july-2020"}, {"description": "LA Times homicide website throttles cryptojacking attack", "link": "https://www.tripwire.com/state-of-security/la-times-website-cryptojacking-attack"}], "researchLinks": [], "securityImplications": "Attackers might use PutObject to upload malicious content or overwrite existing files in S3 buckets.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-PutObject"}
{"eventName": "PutBucketPolicy", "eventSource": "s3.amazonaws.com", "awsService": "S3", "description": "Applies an Amazon S3 bucket policy to an Amazon S3 bucket.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1048 - Exfiltration Over Alternative Protocol"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Detecting and removing risky actions out of your IAM security policies", "link": "https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/"}], "securityImplications": "Attackers might use PutBucketPolicy to modify bucket permissions, potentially allowing unauthorized access to sensitive data.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-8"}], "simulation": [{"type": "commandLine", "value": "aws s3api put-bucket-policy --bucket TrailDiscover --policy {}"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.s3-backdoor-bucket-policy"}], "permissions": "https://aws.permissions.cloud/iam/s3#s3-PutBucketPolicy"}
{"eventName": "GetSMSSandboxAccountStatus", "eventSource": "sns.amazonaws.com", "awsService": "SNS", "description": "Retrieves the SMS sandbox status for the calling AWS account in the target AWS Region.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/"}], "researchLinks": [{"description": "NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS", "link": "https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/"}], "securityImplications": "Attackers might use GetSMSSandboxAccountStatus to monitor the status of a target's AWS SNS sandbox account for potential usage for smishing.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sns get-sms-sandbox-account-status"}], "permissions": "https://aws.permissions.cloud/iam/sns#sns-GetSMSSandboxAccountStatus"}
{"eventName": "GetSMSAttributes", "eventSource": "sns.amazonaws.com", "awsService": "SNS", "description": "Returns the settings for sending SMS messages from your AWS account.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS", "link": "https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/"}, {"description": "Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use GetSMSAttributes to retrieve sensitive SMS configuration details for potential usage for smishing.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sns get-sms-attributes --attributes TrailDiscoverAttributes"}], "permissions": "https://aws.permissions.cloud/iam/sns#sns-GetSMSAttributes"}
{"eventName": "ListOriginationNumbers", "eventSource": "sns.amazonaws.com", "awsService": "SNS", "description": "Lists the calling AWS account's dedicated origination numbers and their metadata.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS", "link": "https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/"}], "securityImplications": "Attackers might use ListOriginationNumbers to identify origination numbers for potential smishing campaings.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sns list-origination-numbers"}], "permissions": "https://aws.permissions.cloud/iam/sns#sns-ListOriginationNumbers"}
{"eventName": "Publish", "eventSource": "sns.amazonaws.com", "awsService": "SNS", "description": "Sends a message to an Amazon SNS topic, a text message (SMS message) directly to a phone number, or a message to a mobile platform endpoint (when you specify the TargetArn).", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/"}], "researchLinks": [], "securityImplications": "Attackers might use Publish for smishing campaigns.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/sns#sns-Publish"}
{"eventName": "ListTopics", "eventSource": "sns.amazonaws.com", "awsService": "SNS", "description": "Returns a list of the requester's topics.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS", "link": "https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/"}], "securityImplications": "Attackers might use ListTopics to identify potential SNS topics for unauthorized access or disruption.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sns list-topics"}], "permissions": "https://aws.permissions.cloud/iam/sns#sns-ListTopics"}
{"eventName": "ListSubscriptions", "eventSource": "sns.amazonaws.com", "awsService": "SNS", "description": "Lists the calling AWS account's dedicated origination numbers and their metadata.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS", "link": "https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/"}], "securityImplications": "Attackers might use ListSubscriptions to identify origination numbers for potential smishing campaings.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sns list-subscriptions"}], "permissions": "https://aws.permissions.cloud/iam/sns#sns-ListSubscriptions"}
{"eventName": "DeleteDeliveryChannel", "eventSource": "config.amazonaws.com", "awsService": "Config", "description": "Deletes the delivery channel.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Config Resource Deletion", "link": "https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-7-16-4-aws-config-resource-deletion.html#prebuilt-rule-7-16-4-aws-config-resource-deletion"}, {"description": "AWS Config modified", "link": "https://docs.datadoghq.com/security/default_rules/cloudtrail-aws-config-disabled/"}, {"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use DeleteDeliveryChannel to disrupt the flow of configuration history and compliance data in AWS.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-9"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_config_disable_recording.yml"}], "simulation": [{"type": "commandLine", "value": "aws configservice delete-delivery-channel --delivery-channel-name TrailDiscoverDeliveryChannel"}], "permissions": "https://aws.permissions.cloud/iam/config#config-DeleteDeliveryChannel"}
{"eventName": "DeleteConfigRule", "eventSource": "config.amazonaws.com", "awsService": "Config", "description": "Deletes the specified AWS Config rule and all of its evaluation results.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Config Resource Deletion", "link": "https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-7-16-4-aws-config-resource-deletion.html#prebuilt-rule-7-16-4-aws-config-resource-deletion"}], "securityImplications": "Attackers might use DeleteConfigRule to remove compliance rules, potentially affecting the response plan.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws configservice delete-config-rule --config-rule-name TrailDiscoverConfigRule"}], "permissions": "https://aws.permissions.cloud/iam/config#config-DeleteConfigRule"}
{"eventName": "StopConfigurationRecorder", "eventSource": "config.amazonaws.com", "awsService": "Config", "description": "Stops recording configurations of the AWS resources you have selected to record in your AWS account.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Configuration Recorder Stopped", "link": "https://www.elastic.co/guide/en/security/current/prebuilt-rule-8-2-1-aws-configuration-recorder-stopped.html#prebuilt-rule-8-2-1-aws-configuration-recorder-stopped"}, {"description": "AWS Config modified", "link": "https://docs.datadoghq.com/security/default_rules/cloudtrail-aws-config-disabled/"}, {"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use StopConfigurationRecorder to halt the recording of AWS resource configurations, hindering audit trails.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-9"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_config_disable_recording.yml"}], "simulation": [{"type": "commandLine", "value": "aws configservice stop-configuration-recorder --configuration-recorder-name TrailDiscoverRecorder"}], "permissions": "https://aws.permissions.cloud/iam/config#config-StopConfigurationRecorder"}
{"eventName": "DeleteConfigurationRecorder", "eventSource": "config.amazonaws.com", "awsService": "Config", "description": "Deletes the configuration recorder.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Config Resource Deletion", "link": "https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-7-16-4-aws-config-resource-deletion.html#prebuilt-rule-7-16-4-aws-config-resource-deletion"}], "securityImplications": "Attackers might use DeleteConfigurationRecorder to disrupt AWS configuration auditing.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws configservice delete-configuration-recorder --configuration-recorder-name TrailDiscoverRecorder"}], "permissions": "https://aws.permissions.cloud/iam/config#config-DeleteConfigurationRecorder"}
{"eventName": "GetId", "eventSource": "cognito-identity.amazonaws.com", "awsService": "CognitoIdentity", "description": "Generates (or retrieves) IdentityID. Supplying multiple logins will create an implicit linked account.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1078 - Valid Accounts"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Overpermissioned AWS Cognito Identity Pools", "link": "https://hackingthe.cloud/aws/exploitation/cognito_identity_pool_excessive_privileges/#exploitation"}], "securityImplications": "Attackers might use GetId to get an IdentityID that might be then used to get AWS credentials.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/cognito-identity#cognito-identity-GetId"}
{"eventName": "GetCredentialsForIdentity", "eventSource": "cognito-identity.amazonaws.com", "awsService": "CognitoIdentity", "description": "Returns credentials for the provided identity ID. Any provided logins will be validated against supported login providers.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1078 - Valid Accounts"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Overpermissioned AWS Cognito Identity Pools", "link": "https://hackingthe.cloud/aws/exploitation/cognito_identity_pool_excessive_privileges/#exploitation"}], "securityImplications": "Attackers might use GetCredentialsForIdentity to obtain temporary AWS credentials, potentially accessing resources or executing actions unauthorizedly within the AWS environment.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/cognito-identity#cognito-identity-GetCredentialsForIdentity"}
{"eventName": "GetCostAndUsage", "eventSource": "ce.amazonaws.com", "awsService": "CostExplorer", "description": "Retrieves cost and usage metrics for your account.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [], "securityImplications": "Attackers might use GetCostAndUsage to determine how active an account is by understanding the cost within a cloud account.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ce get-cost-and-usage --time-period Start=2017-09-01,End=2017-10-01 --granularity MONTHLY --metrics 'BlendedCost' 'UnblendedCost' 'UsageQuantity' --group-by Type=DIMENSION,Key=SERVICE Type=TAG,Key=Environment"}], "permissions": "https://aws.permissions.cloud/iam/ce#ce-GetCostAndUsage"}
{"eventName": "AssumeRoleWithSAML", "eventSource": "sts.amazonaws.com", "awsService": "STS", "description": "Returns a set of temporary security credentials for users who have been authenticated via a SAML authentication response.", "mitreAttackTactics": ["TA0001 - Initial Access"], "mitreAttackTechniques": ["T1199 - Trusted Relationship"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS - STS Privesc", "link": "https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sts-privesc"}], "securityImplications": "Attackers might use AssumeRoleWithSAML to impersonate legitimate users and gain unauthorized access to an AWS role.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_susp_saml_activity.yml"}], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/sts#sts-AssumeRoleWithSAML"}
{"eventName": "GetCallerIdentity", "eventSource": "sts.amazonaws.com", "awsService": "STS", "description": "Returns details about the IAM user or role whose credentials are used to call the operation.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}, {"description": "GotRoot! AWS root Account Takeover", "link": "https://medium.com/@gchib/naturesbasket-aws-root-account-takeover-e4aa5c5e95e1"}, {"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}, {"description": "Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}, {"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}, {"description": "Enumerate AWS Account ID from an EC2 Instance", "link": "https://hackingthe.cloud/aws/enumeration/account_id_from_ec2/"}], "securityImplications": "Attackers might use GetCallerIdentity to know what user or role are they using. This request does not need any permission.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sts get-caller-identity"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.ec2-steal-instance-credentials"}], "permissions": "https://aws.permissions.cloud/iam/sts#sts-GetCallerIdentity"}
{"eventName": "GetFederationToken", "eventSource": "sts.amazonaws.com", "awsService": "STS", "description": "Returns a set of temporary security credentials (consisting of an access key ID, a secret access key, and a security token) for a user.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1078 - Valid Accounts"], "usedInWild": false, "incidents": [{"description": "How Adversaries Can Persist with AWS User Federation", "link": "https://www.crowdstrike.com/blog/how-adversaries-persist-with-aws-user-federation/"}], "researchLinks": [{"description": "Create a Console Session from IAM Credentials", "link": "https://hackingthe.cloud/aws/post_exploitation/create_a_console_session_from_iam_credentials/"}, {"description": "Survive Access Key Deletion with sts:GetFederationToken", "link": "https://hackingthe.cloud/aws/post_exploitation/survive_access_key_deletion_with_sts_getfederationtoken/"}], "securityImplications": "Attackers might use GetFederationToken to gain temporary access credentials.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sts get-federation-token --name TrailDiscover --policy TrailDiscoverPolicy"}], "permissions": "https://aws.permissions.cloud/iam/sts#sts-GetFederationToken"}
{"eventName": "GetSessionToken", "eventSource": "sts.amazonaws.com", "awsService": "STS", "description": "Returns a set of temporary credentials for an AWS account or IAM user.", "mitreAttackTactics": ["TA0001 - Initial Access"], "mitreAttackTechniques": ["T1199 - Trusted Relationship"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS STS GetSessionToken Abuse", "link": "https://www.elastic.co/guide/en/security/7.17/aws-sts-getsessiontoken-abuse.html"}], "securityImplications": "Attackers might use GetSessionToken to obtain temporary access credentials.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_sts_getsessiontoken_misuse.yml"}], "simulation": [{"type": "commandLine", "value": "aws sts get-session-token --duration-seconds 900 --serial-number 'YourMFADeviceSerialNumber' --token-code 123456"}], "permissions": "https://aws.permissions.cloud/iam/sts#sts-GetSessionToken"}
{"eventName": "AssumeRole", "eventSource": "sts.amazonaws.com", "awsService": "STS", "description": "Returns a set of temporary security credentials that you can use to access AWS resources.", "mitreAttackTactics": ["TA0001 - Initial Access", "TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1199 - Trusted Relationship", "T1078 - Valid Accounts"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Trouble in Paradise", "link": "https://blog.darklab.hk/2021/07/06/trouble-in-paradise/"}], "researchLinks": [{"description": "Role Chain Juggling", "link": "https://hackingthe.cloud/aws/post_exploitation/role-chain-juggling/"}, {"description": "Detecting and removing risky actions out of your IAM security policies", "link": "https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/"}], "securityImplications": "Attackers might use AssumeRole to gain unauthorized access to an AWS role. This might allow them to gain initial access, escalate privileges or in specific scenarios gain persistence.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sts assume-role --role-arn arn:aws:iam::123456789012:role/TrailDiscover --role-session-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/sts#sts-AssumeRole"}
{"eventName": "AssumeRoleWithWebIdentity", "eventSource": "sts.amazonaws.com", "awsService": "STS", "description": "Returns a set of temporary security credentials for users who have been authenticated in a mobile or web application with a web identity provider.", "mitreAttackTactics": ["TA0001 - Initial Access", "TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1199 - Trusted Relationship", "T1550 - Use Alternate Authentication Material"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "From GitHub To Account Takeover: Misconfigured Actions Place GCP & AWS Accounts At Risk", "link": "https://www.rezonate.io/blog/github-misconfigurations-put-gcp-aws-in-account-takeover-risk/"}], "securityImplications": "Attackers might use AssumeRoleWithWebIdentity to impersonate legitimate users and gain unauthorized access to an AWS role.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/sts#sts-AssumeRoleWithWebIdentity"}
{"eventName": "PublishFunction2020_05_31", "eventSource": "cloudfront.amazonaws.com", "awsService": "CloudFront", "description": "Publishes a CloudFront function by copying the function code from the DEVELOPMENT stage to LIVE.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1119 - Automated Collection"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "How Attackers Can Misuse AWS CloudFront Access to Make It ‘Rain’ Cookies", "link": "https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c"}], "securityImplications": "Attackers might use PublishFunction to publish a malicious function that might be used to exfiltrate data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws cloudfront publish-function --name trail-discover-function --if-match trail-discover-function"}], "permissions": "https://aws.permissions.cloud/iam/cloudfront#cloudfront-PublishFunction"}
{"eventName": "CreateFunction2020_05_31", "eventSource": "cloudfront.amazonaws.com", "awsService": "CloudFront", "description": "Creates a CloudFront function.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1119 - Automated Collection"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "How Attackers Can Misuse AWS CloudFront Access to Make It ‘Rain’ Cookies", "link": "https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c"}], "securityImplications": "Attackers might use CreateFunction to add a new function that can be use to exfiltrate date.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws cloudfront create-function --name trail-discover-function --function-config Comment='TrailDiscover',Runtime=cloudfront-js-1.0 --function-code VHJhaWxEaXNjb3Zlcgo="}], "permissions": "https://aws.permissions.cloud/iam/cloudfront#cloudfront-CreateFunction"}
{"eventName": "UpdateDistribution2020_05_31", "eventSource": "cloudfront.amazonaws.com", "awsService": "CloudFront", "description": "Updates the configuration for a CloudFront distribution.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1119 - Automated Collection"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "How Attackers Can Misuse AWS CloudFront Access to Make It ‘Rain’ Cookies", "link": "https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c"}], "securityImplications": "Attackers might use UpdateDistribution to add a malicious configuration such as a function to exfiltrate data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws cloudfront update-distribution --id EDFDVBD6EXAMPLE --distribution-config '{\"CallerReference\":\"\", \"Origins\":{\"Quantity\":1,\"Items\":[{\"Id\":\"\", \"DomainName\":\"\"}]}, \"DefaultCacheBehavior\":{\"TargetOriginId\":\"\", \"ViewerProtocolPolicy\":\"\"}, \"Comment\":\"\", \"Enabled\":false }'"}], "permissions": "https://aws.permissions.cloud/iam/cloudfront#cloudfront-UpdateDistribution"}
{"eventName": "UpdateIPSet", "eventSource": "wafv2.amazonaws.com", "awsService": "WAFV2", "description": "Updates the specified IPSet.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Incident Response", "link": "https://easttimor.github.io/aws-incident-response/"}], "securityImplications": "Attackers might use UpdateIPSet to modify IP address rules, potentially allowing unauthorized access from IPs they control.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws wafv2 update-ip-set --name testip --scope REGIONAL --id a1b2c3d4-5678-90ab-cdef-EXAMPLE11111 --addresses 198.51.100.0/16 --lock-token 447e55ac-2396-4c6d-b9f9-86b67c17f8b5"}], "permissions": "https://aws.permissions.cloud/iam/wafv2#wafv2-UpdateIPSet"}
{"eventName": "DeleteRuleGroup", "eventSource": "wafv2.amazonaws.com", "awsService": "WAFV2", "description": "Deletes the specified RuleGroup.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS WAF Rule or Rule Group Deletion", "link": "https://www.elastic.co/guide/en/security/current/aws-waf-rule-or-rule-group-deletion.html"}, {"description": "AWS Incident Response", "link": "https://easttimor.github.io/aws-incident-response/"}], "securityImplications": "Attackers might use DeleteRuleGroup to disable security rules, making the system vulnerable to cyber attacks.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws wafv2 delete-rule-group --name TestRuleGroup --scope REGIONAL --id a1b2c3d4-5678-90ab-cdef-EXAMPLE11111 --lock-token 7b3bcec2-0000-0000-0000-563bf47249f0"}], "permissions": "https://aws.permissions.cloud/iam/wafv2#wafv2-DeleteRuleGroup"}
{"eventName": "DeleteWebACL", "eventSource": "wafv2.amazonaws.com", "awsService": "WAFV2", "description": "Deletes the specified WebACL.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Incident Response", "link": "https://easttimor.github.io/aws-incident-response/"}], "securityImplications": "Attackers might use DeleteWebACL to remove web access control lists, thereby disrupting web application firewall protections.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws wafv2 delete-web-acl --name TrailDiscoverWebACL --scope REGIONAL --id TrailDiscoverId --lock-token TrailDiscoverLockToken"}], "permissions": "https://aws.permissions.cloud/iam/wafv2#wafv2-DeleteWebACL"}
{"eventName": "GetRegions", "eventSource": "lightsail.amazonaws.com", "awsService": "LightSail", "description": "Returns a list of all valid regions for Amazon Lightsail.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use GetRegions to identify potential targets in different geographical locations on AWS LightSail.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lightsail get-regions"}], "permissions": "https://aws.permissions.cloud/iam/lightsail#lightsail-GetRegions"}
{"eventName": "CreateInstances", "eventSource": "lightsail.amazonaws.com", "awsService": "Lightsail", "description": "Creates one or more Amazon Lightsail instances.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0040 - Impact"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use CreateInstances to rapidly deploy malicious instances, causing financial loss and resource exhaustion. The use of lightsail might not be monitored.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lightsail create-instances --instance-names Instance-1 --availability-zone us-west-2a --blueprint-id wordpress_5_1_1_2 --bundle-id nano_2_0"}], "permissions": "https://aws.permissions.cloud/iam/lightsail#lightsail-CreateInstances"}
{"eventName": "GetInstances", "eventSource": "lightsail.amazonaws.com", "awsService": "LightSail", "description": "Returns information about all Amazon Lightsail virtual private servers, or instances.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use GetInstances to gather information about running instances for potential exploitation.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lightsail get-instances"}], "permissions": "https://aws.permissions.cloud/iam/lightsail#lightsail-GetInstances"}
{"eventName": "CreateService", "eventSource": "ecs.amazonaws.com", "awsService": "ECS", "description": "Runs and maintains your desired number of tasks from a specified task definition.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [], "securityImplications": "Attackers might use CreateService in AWS ECS to orchestrate and deploy unauthorized services, potentially for malicious activities such as resource hijacking.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ecs create-service --service-name TrailDiscoverService --task-definition TrailDiscoverTaskDefinition"}], "permissions": "https://aws.permissions.cloud/iam/ecs#ecs-CreateService"}
{"eventName": "RegisterTaskDefinition", "eventSource": "ecs.amazonaws.com", "awsService": "ECS", "description": "Registers a new task definition from the supplied family and containerDefinitions.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [], "securityImplications": "Attackers might use RegisterTaskDefinition to deploy containers with malicious tasks in AWS ECS.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_ecs_task_definition_cred_endpoint_query.yml"}], "simulation": [{"type": "commandLine", "value": "aws ecs register-task-definition --family 'xtdb-bench-dev' --network-mode 'awsvpc' --container-definitions '[{\"name\":\"bench-container\", \"cpu\":2048, \"memory\":4092 }]'"}], "permissions": "https://aws.permissions.cloud/iam/ecs#ecs-RegisterTaskDefinition"}
{"eventName": "CreateCluster", "eventSource": "ecs.amazonaws.com", "awsService": "ECS", "description": "Creates a new Amazon ECS cluster.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [], "securityImplications": "Attackers might use CreateCluster to provision unauthorized cluster resources, aiming to deploy malicious workloads or use compute resources for cryptojacking", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_eks_cluster_created_or_deleted.yml"}], "simulation": [{"type": "commandLine", "value": "aws ecs create-cluster --cluster-name TrailDiscoverCluster"}], "permissions": "https://aws.permissions.cloud/iam/ecs#ecs-CreateCluster"}
{"eventName": "Search", "eventSource": "resource-explorer-2.amazonaws.com", "awsService": "ResourceExplorer", "description": "Searches for resources and displays details about all resources that match the specified criteria.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [], "securityImplications": "Attackers might use Search to list resorces.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws resource-explorer-2 search --query-string 'service:iam'"}], "permissions": "https://aws.permissions.cloud/iam/resource-explorer-2#resource-explorer-2-Search"}
{"eventName": "CreateRule", "eventSource": "elasticloadbalancing.amazonaws.com", "awsService": "ELBv2", "description": "Creates a rule for the specified listener.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Rigging the Rules: Manipulating AWS ALB to Mine Sensitive Data", "link": "https://medium.com/@adan.alvarez/rigging-the-rules-manipulating-aws-alb-to-mine-sensitive-data-20e33dbc4994"}], "securityImplications": "Attackers might use CreateRule to add rules that allow them access bypassing potential restrictions such as authentication.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws elbv2 create-rule --listener-arn arn:aws:elasticloadbalancing:us-west-2:123456789012:listener/app/my-load-balancer/50dc6c495c0c9188/f2f7dc8efc522ab2 --priority 5 --actions Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/my-targets/73e2d6bc24d8a067 --conditions '[{}]'"}], "permissions": "https://aws.permissions.cloud/iam/elasticloadbalancing#elasticloadbalancing-CreateRule"}
{"eventName": "DescribeListeners", "eventSource": "elasticloadbalancing.amazonaws.com", "awsService": "ELBv2", "description": "Describes the specified listeners or the listeners for the specified Application Load Balancer, Network Load Balancer, or Gateway Load Balancer.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Rigging the Rules: Manipulating AWS ALB to Mine Sensitive Data", "link": "https://medium.com/@adan.alvarez/rigging-the-rules-manipulating-aws-alb-to-mine-sensitive-data-20e33dbc4994"}], "securityImplications": "Attackers might use DescribeListeners to get information about the load balancers listeners for potential future modifications.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws elbv2 describe-listeners"}], "permissions": "https://aws.permissions.cloud/iam/elasticloadbalancing#elasticloadbalancing-DescribeListeners"}
{"eventName": "DescribeLoadBalancers", "eventSource": "elasticloadbalancing.amazonaws.com", "awsService": "ELBv2", "description": "Describes the specified load balancers or all of your load balancers.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Rigging the Rules: Manipulating AWS ALB to Mine Sensitive Data", "link": "https://medium.com/@adan.alvarez/rigging-the-rules-manipulating-aws-alb-to-mine-sensitive-data-20e33dbc4994"}], "securityImplications": "Attackers might use DescribeLoadBalancers to get information about the load balancers for potential future attacks.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws elbv2 describe-load-balancers --names TrailDiscoverLoadBalancer"}], "permissions": "https://aws.permissions.cloud/iam/elasticloadbalancing#elasticloadbalancing-DescribeLoadBalancers"}
{"eventName": "PutEventSelectors", "eventSource": "cloudtrail.amazonaws.com", "awsService": "CloudTrail", "description": "Configures an event selector or advanced event selectors for your trail.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "cloudtrail_guardduty_bypass", "link": "https://github.com/RhinoSecurityLabs/Cloud-Security-Research/tree/master/AWS/cloudtrail_guardduty_bypass"}, {"description": "Detecting and removing risky actions out of your IAM security policies", "link": "https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/"}], "securityImplications": "Attackers might use PutEventSelectors to disrupting AWS logging.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws cloudtrail put-event-selectors --trail-name TrailDiscover --event-selectors '[{\"ReadWriteType\": \"All\", \"IncludeManagementEvents\":true, \"DataResources\": [{\"Type\": \"AWS::S3::Object\", \"Values\": [\"arn:aws:s3\"]}] }]'"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.cloudtrail-event-selectors"}], "permissions": "https://aws.permissions.cloud/iam/cloudtrail#cloudtrail-PutEventSelectors"}
{"eventName": "StopLogging", "eventSource": "cloudtrail.amazonaws.com", "awsService": "CloudTrail", "description": "Suspends the recording of AWS API calls and log file delivery for the specified trail.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "Stopping a CloudTrail trail", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/stopping-cloudtrail-trail/"}, {"description": "AWS Defense Evasion Stop Logging Cloudtrail", "link": "https://research.splunk.com/cloud/8a2f3ca2-4eb5-4389-a549-14063882e537/"}, {"description": "AWS Defense Evasion and Centralized Multi-Account Logging", "link": "https://logrhythm.com/blog/aws-defense-evasion-and-centralized-multi-account-logging/"}, {"description": "Disrupting AWS logging", "link": "https://medium.com/daniel-grzelak/disrupting-aws-logging-a42e437d6594"}, {"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}], "securityImplications": "Attackers might use StopLogging to disrupting AWS logging.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-5"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_cloudtrail_disable_logging.yml"}], "simulation": [{"type": "commandLine", "value": "aws cloudtrail stop-logging --name TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.cloudtrail-stop"}], "permissions": "https://aws.permissions.cloud/iam/cloudtrail#cloudtrail-StopLogging"}
{"eventName": "UpdateTrail", "eventSource": "cloudtrail.amazonaws.com", "awsService": "CloudTrail", "description": "Updates trail settings that control what events you are logging, and how to handle log files.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Defense Evasion and Centralized Multi-Account Logging", "link": "https://logrhythm.com/blog/aws-defense-evasion-and-centralized-multi-account-logging/"}, {"description": "Disrupting AWS logging", "link": "https://medium.com/daniel-grzelak/disrupting-aws-logging-a42e437d6594"}], "securityImplications": "Attackers might use UpdateTrail to disrupting AWS logging.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-5"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_cloudtrail_disable_logging.yml"}], "simulation": [{"type": "commandLine", "value": "aws cloudtrail update-trail --name TrailDiscoverName --s3-bucket-name TrailDiscoverBucketName"}], "permissions": "https://aws.permissions.cloud/iam/cloudtrail#cloudtrail-UpdateTrail"}
{"eventName": "LookupEvents", "eventSource": "cloudtrail.amazonaws.com", "awsService": "CloudTrail", "description": "Looks up management events or CloudTrail Insights events that are captured by CloudTrail.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1654 - Log Enumeration"], "usedInWild": true, "incidents": [{"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [], "securityImplications": "Attackers might use LookupEvents to monitoring CloudTrail logs for changes that might affect the attack.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/cloudtrail#cloudtrail-LookupEvents"}
{"eventName": "DeleteTrail", "eventSource": "cloudtrail.amazonaws.com", "awsService": "CloudTrail", "description": "Deletes a trail.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "AWS Defense Evasion Delete Cloudtrail", "link": "https://research.splunk.com/cloud/82092925-9ca1-4e06-98b8-85a2d3889552/"}, {"description": "Generate Strong Security Signals with Sumo Logic & AWS Cloudtrail", "link": "https://expel.com/blog/following-cloudtrail-generating-aws-security-signals-sumo-logic/"}, {"description": "Disrupting AWS logging", "link": "https://medium.com/daniel-grzelak/disrupting-aws-logging-a42e437d6594"}], "securityImplications": "Attackers might use DeleteTrail to disrupting AWS logging.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-5"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_cloudtrail_disable_logging.yml"}], "simulation": [{"type": "commandLine", "value": "aws cloudtrail delete-trail --name TrailDiscoverTrailName"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.cloudtrail-delete"}], "permissions": "https://aws.permissions.cloud/iam/cloudtrail#cloudtrail-DeleteTrail"}
{"eventName": "AddUserToGroup", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds the specified user to the specified group.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use AddUserToGroup to add unauthorized users to privileged groups, gaining unauthorized access or escalating privileges.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam add-user-to-group --user-name TrailDiscover --group-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-AddUserToGroup"}
{"eventName": "SetDefaultPolicyVersion", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Sets the specified version of the specified policy as the policy's default (operative) version.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use SetDefaultPolicyVersion to revert IAM policies to less secure versions, potentially exposing sensitive resources.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam set-default-policy-version --policy-arn arn:aws:iam::123456789012:policy/TrailDiscover --version-id v2"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-SetDefaultPolicyVersion"}
{"eventName": "PutUserPermissionsBoundary", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds or updates the policy that is specified as the IAM user's permissions boundary.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use PutUserPermissionsBoundary to modify the permissions boundary for an IAM user, potentially escalating privileges or enabling unauthorized access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam put-user-permissions-boundary --permissions-boundary arn:aws:iam::123456789012:policy/intern-boundary --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-PutUserPermissionsBoundary"}
{"eventName": "ListAccessKeys", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Returns information about the access key IDs associated with the specified IAM user.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}], "researchLinks": [], "securityImplications": "Attackers might use ListAccessKeys to identify and exploit unused or unmonitored AWS IAM access keys.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-access-keys --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListAccessKeys"}
{"eventName": "UpdateAssumeRolePolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Updates the policy that grants an IAM entity permission to assume a role.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}, {"description": "AWS IAM Persistence Methods", "link": "https://hackingthe.cloud/aws/post_exploitation/iam_persistence/"}], "securityImplications": "Attackers might use UpdateAssumeRolePolicy to modify the assume role policy allowing access from an attacker compromised account.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam update-assume-role-policy --role-name TrailDiscover-Role --policy-document {}"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-backdoor-role"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-UpdateAssumeRolePolicy"}
{"eventName": "ListSSHPublicKeys", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Returns information about the SSH public keys associated with the specified IAM user.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use ListSSHPublicKeys to get information about the user and the potential use of CodeCommit.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-ssh-public-keys --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListSSHPublicKeys"}
{"eventName": "ListUsers", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists the IAM users that have the specified path prefix. If no path prefix is specified, the operation returns all users in the AWS account.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use ListUsers to enumerate IAM users for further attacks, such as adding keys or creating a login profile for persistence.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-users"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListUsers"}
{"eventName": "DeleteRolePermissionsBoundary", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the permissions boundary for the specified IAM role.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use DeleteRolePermissionsBoundary to remove restrictions and gain unauthorized access to AWS resources.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam delete-role-permissions-boundary --role-name trail-discover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteRolePermissionsBoundary"}
{"eventName": "DeleteUserPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the specified inline policy that is embedded in the specified IAM user.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use DeleteUserPolicy to remove security policies and gain unauthorized access to AWS resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam delete-user-policy --user-name TrailDiscover --policy-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteUserPolicy"}
{"eventName": "ListGroupsForUser", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists the IAM groups that the specified IAM user belongs to.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use ListGroupsForUser to identify privileged groups and target specific users for access escalation.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-groups-for-user --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListGroupsForUser"}
{"eventName": "CreateRole", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Creates a new role for your AWS account.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1136 - Create Account"], "usedInWild": true, "incidents": [{"description": "Attack Scenario 2: From Misconfigured Firewall to Cryptojacking Botnet", "link": "https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/reports/unit42-cloud-threat-report-volume7.pdf"}, {"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers use CreateRole to create roles with trust policies that allow principals from an attacker-controlled AWS account, establishing persistent unauthorized access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam create-role --role-name TrailDiscover --assume-role-policy-document {}"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-backdoor-role"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-CreateRole"}
{"eventName": "DeleteAccessKey", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the access key pair associated with the specified IAM user.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1070 - Indicator Removal"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteAccessKey to revoke legitimate user access to AWS services. Also, it can be used to delete previously used keys to avoid detection.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam delete-access-key --access-key-id AKIDPMS9RO4H3FEXAMPLE --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteAccessKey"}
{"eventName": "CreateAccessKey", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Creates a new AWS secret access key and corresponding AWS access key ID for the specified user. The default status for new keys is Active.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1136 - Create Account", "T1078 - Valid Accounts"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto", "link": "https://sysdig.com/blog/scarleteel-2-0/"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability", "link": "https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/"}, {"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}, {"description": "AWS IAM Persistence Methods", "link": "https://hackingthe.cloud/aws/post_exploitation/iam_persistence/"}], "securityImplications": "Attackers might use CreateAccessKey to generate unauthorized access keys, enabling them to gain illicit access to AWS services and resources.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_iam_s3browser_user_or_accesskey_creation.yml"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_iam_backdoor_users_keys.yml"}], "simulation": [{"type": "commandLine", "value": "aws iam create-access-key --user-name TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-admin-user"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-backdoor-user"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-CreateAccessKey"}
{"eventName": "DeleteLoginProfile", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the password for the specified IAM user.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1070 - Indicator Removal"], "usedInWild": true, "incidents": [{"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteLoginProfile to remove user's login credentials, preventing legitimate access to AWS services. Also, it might be used to delete a previously added profile to avoid detection.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam delete-login-profile --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteLoginProfile"}
{"eventName": "AddRoleToInstanceProfile", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds the specified IAM role to the specified instance profile.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Cloudgoat AWS CTF solution- Scenerio 5 (iam_privesc_by_attachment)", "link": "https://pswalia2u.medium.com/cloudgoat-aws-ctf-solution-scenerio-5-iam-privesc-by-attachment-22145650f5f5"}], "securityImplications": "Attackers might use AddRoleToInstanceProfile to escalate privileges or gain unauthorized access to AWS resources.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam add-role-to-instance-profile --role-name TrailDiscover --instance-profile-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-AddRoleToInstanceProfile"}
{"eventName": "ListInstanceProfiles", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists the instance profiles that have the specified path prefix. If there are none, the operation returns an empty list.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use ListInstanceProfiles to identify potential targets for privilege escalation attacks in AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-instance-profiles"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListInstanceProfiles"}
{"eventName": "GetAccountAuthorizationDetails", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Retrieves information about all IAM users, groups, roles, and policies in your AWS account, including their relationships to one another.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS - IAM Enum", "link": "https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-services/aws-iam-enum"}], "securityImplications": "Attackers might use GetAccountAuthorizationDetails to gather information about IAM users, groups, roles, and policies in a targeted AWS account.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam get-account-authorization-details"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-GetAccountAuthorizationDetails"}
{"eventName": "DeleteRolePolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the specified inline policy that is embedded in the specified IAM role.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use DeleteRolePolicy to remove security policies, potentially escalating their privileges.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam delete-role-policy --role-name TrailDiscover-Role --policy-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteRolePolicy"}
{"eventName": "ListRoles", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists the IAM roles that have the specified path prefix. ", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS - IAM Enum", "link": "https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-services/aws-iam-enum"}], "securityImplications": "Attackers might use ListRoles to identify potential targets for privilege escalation attacks in AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-roles"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListRoles"}
{"eventName": "CreatePolicyVersion", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Creates a new version of the specified managed policy.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use CreatePolicyVersion to modify IAM policies, potentially granting themselves elevated permissions.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam create-policy-version --policy-arn arn:aws:iam::123456789012:policy/TrailDiscover --policy-document {}"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-CreatePolicyVersion"}
{"eventName": "ListRolePolicies", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists the names of the inline policies that are embedded in the specified IAM role.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use ListRolePolicies to identify permissions associated with various roles in AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-role-policies --role-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListRolePolicies"}
{"eventName": "SimulatePrincipalPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Simulate how a set of IAM policies attached to an IAM entity works with a list of API operations and AWS resources to determine the policies' effective permissions.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use SimulatePrincipalPolicy to understand the permissions of a principal, to later potentially exploiting any over-permissive policies. Using this technique might allow attackers to evade defenses while enumerating permissions.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam simulate-principal-policy --policy-source-arn arn:aws:iam::123456789012:user/TrailDiscover --action-names codecommit:ListRepositories"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-SimulatePrincipalPolicy"}
{"eventName": "ChangePassword", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Changes the password of the IAM user who is calling this operation.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1136 - Create Account", "T1078 - Valid Accounts"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS CloudTrail cheat sheet", "link": "https://www.invictus-ir.com/news/aws-cloudtrail-cheat-sheet"}, {"description": "IAM User Changes Alarm", "link": "https://asecure.cloud/a/cwalarm_iam_user_changes/"}], "securityImplications": "Attackers might use ChangePassword to alter user credentials.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam change-password --old-password TrailDiscover --new-password TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ChangePassword"}
{"eventName": "GetLoginProfile", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Retrieves the user name for the specified IAM user.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [], "securityImplications": "Attackers might use GetLoginProfile to know if the account has a login profile or to get its user name.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_iam_s3browser_loginprofile_creation.yml"}], "simulation": [{"type": "commandLine", "value": "aws iam get-login-profile --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-GetLoginProfile"}
{"eventName": "ListGroups", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists the IAM groups that have the specified path prefix.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS - IAM Enum", "link": "https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-services/aws-iam-enum"}], "securityImplications": "Attackers might use ListGroups to identify potential targets by gathering information about IAM groups and their permissions.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-groups"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListGroups"}
{"eventName": "CreateLoginProfile", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Creates a password for the specified IAM user. A password allows an IAM user to access AWS services through the AWS Management Console.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1078 - Valid Accounts"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}, {"description": "AWS IAM Persistence Methods", "link": "https://hackingthe.cloud/aws/post_exploitation/iam_persistence/"}], "securityImplications": "Attackers use CreateLoginProfile to create login credentials for IAM users, allowing them access to the user via the AWS console.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_iam_s3browser_loginprofile_creation.yml"}], "simulation": [{"type": "commandLine", "value": "aws iam create-login-profile --user-name TrailDiscover --password TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-user-login-profile"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-CreateLoginProfile"}
{"eventName": "CreateUser", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Creates a new IAM user for your AWS account.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1136 - Create Account"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "Responding to an attack in AWS", "link": "https://awstip.com/responding-to-an-attack-in-aws-9048a1a551ac"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}, {"description": "Trouble in Paradise", "link": "https://blog.darklab.hk/2021/07/06/trouble-in-paradise/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Exposed long-lived access key resulted in unauthorized access", "link": "https://twitter.com/jhencinski/status/1578371249792724992?t=6oYeGYgGZq1B-LXFZzIqhQ"}, {"description": "SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto", "link": "https://sysdig.com/blog/scarleteel-2-0/"}, {"description": "Insider Threat Risks to Flat Environments", "link": "https://www.mandiant.com/sites/default/files/2021-09/rpt-mtrends-2021-3.pdf"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "Sendtech Pte. Ltd", "link": "https://www.pdpc.gov.sg/-/media/Files/PDPC/PDF-Files/Commissions-Decisions/Decision---Sendtech-Pte-Ltd---220721.ashx?la=en"}, {"description": "BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability", "link": "https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/"}, {"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}, {"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "Creating a new IAM user", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/creating-new-iam-user/"}, {"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers use CreateUser to establish persistent footholds or in some cases, escalate privileges within AWS environments by creating new IAM users with strategic permissions.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_iam_s3browser_user_or_accesskey_creation.yml"}], "simulation": [{"type": "commandLine", "value": "aws iam create-user --user-name TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-admin-user"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-CreateUser"}
{"eventName": "PutRolePermissionsBoundary", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds or updates the policy that is specified as the IAM role's permissions boundary.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use PutRolePermissionsBoundary to modify permissions boundaries, potentially escalating privileges or enabling unauthorized access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam put-role-permissions-boundary --permissions-boundary arn:aws:iam::123456789012:policy/intern-boundary --role-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-PutRolePermissionsBoundary"}
{"eventName": "AttachUserPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Attaches the specified managed policy to the specified user.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers use AttachUserPolicy to grant malicious policies to IAM users, potentially escalating privileges or enabling unauthorized access to AWS resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam attach-user-policy --policy-arn arn:aws:iam::aws:policy/AdministratorAccess --user-name TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-admin-user"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-AttachUserPolicy"}
{"eventName": "ListAttachedRolePolicies", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Lists all managed policies that are attached to the specified IAM role.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use ListAttachedRolePolicies to identify and exploit permissions associated with various roles in AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam list-attached-role-policies --role-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-ListAttachedRolePolicies"}
{"eventName": "DeleteUser", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the specified IAM user.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1070 - Indicator Removal"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Insider Threat Risks to Flat Environments", "link": "https://www.mandiant.com/sites/default/files/2021-09/rpt-mtrends-2021-3.pdf"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteUser to remove users and their permissions, disrupting access control in AWS. Also, it can be used to delete previously used users to avoid detection.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam delete-user --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteUser"}
{"eventName": "UpdateAccessKey", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Changes the status of the specified access key from Active to Inactive, or vice versa.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS - IAM Privesc", "link": "https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-iam-privesc"}], "securityImplications": "Attackers might use UpdateAccessKey to modify existing IAM user access keys, potentially gaining unauthorized access to AWS services.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam update-access-key --access-key-id AKIAIOSFODNN7EXAMPLE --status Inactive --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-UpdateAccessKey"}
{"eventName": "PutUserPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds or updates an inline policy document that is embedded in the specified IAM user.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers use PutUserPolicy to grant an inline policy to IAM users, potentially escalating privileges or enabling unauthorized access to AWS resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}, {"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_iam_s3browser_templated_s3_bucket_policy_creation.yml"}], "simulation": [{"type": "commandLine", "value": "aws iam put-user-policy --user-name TrailDiscover --policy-name TrailDiscover --policy-document {}"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-PutUserPolicy"}
{"eventName": "DetachRolePolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Removes the specified managed policy from the specified role.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use DetachRolePolicy to remove crucial permissions from IAM roles, disrupting AWS services.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam detach-role-policy --role-name TrailDiscover --policy-arn arn:aws:iam::123456789012:policy/FederatedTesterAccessPolicy"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DetachRolePolicy"}
{"eventName": "DeleteUserPermissionsBoundary", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deletes the permissions boundary for the specified IAM user.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use DeleteUserPermissionsBoundary to remove restrictions and gain unauthorized access to AWS resources.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam delete-user-permissions-boundary --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeleteUserPermissionsBoundary"}
{"eventName": "DetachUserPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Removes the specified managed policy from the specified user.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use DetachUserPolicy to remove security policies and gain unauthorized access to AWS resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam detach-user-policy --user-name TrailDiscover --policy-arn arn:aws:iam::123456789012:policy/TesterPolicy"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DetachUserPolicy"}
{"eventName": "UpdateLoginProfile", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Changes the password for the specified IAM user. You can use the AWS CLI, the AWS API, or the Users page in the IAM console to change the password for any IAM user.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use UpdateLoginProfile to change the password of an IAM user, gaining unauthorized access to it.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_update_login_profile.yml"}], "simulation": [{"type": "commandLine", "value": "aws iam update-login-profile --user-name TrailDiscover --password TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-user-login-profile"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-UpdateLoginProfile"}
{"eventName": "PutGroupPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds or updates an inline policy document that is embedded in the specified IAM group.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use PutGroupPolicy to modify permissions of a group, potentially granting unauthorized access to sensitive resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam put-group-policy --group-name TrailDiscover --policy-document {} --policy-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-PutGroupPolicy"}
{"eventName": "AttachGroupPolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Attaches the specified managed policy to the specified IAM group.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use AttachGroupPolicy to assign malicious policies to a group, escalating privileges or enabling unauthorized access.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/TrailDiscover --group-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-AttachGroupPolicy"}
{"eventName": "GetUser", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Retrieves information about the specified IAM user, including the user's creation date, path, unique ID, and ARN.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "GotRoot! AWS root Account Takeover", "link": "https://medium.com/@gchib/naturesbasket-aws-root-account-takeover-e4aa5c5e95e1"}], "researchLinks": [], "securityImplications": "Attackers might use GetUser to obtain user information.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam get-user --user-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-GetUser"}
{"eventName": "PutRolePolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Adds or updates an inline policy document that is embedded in the specified IAM role.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use PutRolePolicy to modify permissions of IAM roles, potentially granting unauthorized access to AWS resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam put-role-policy --role-name TrailDiscover-Role --policy-name TrailDiscover --policy-document {}"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-PutRolePolicy"}
{"eventName": "DeactivateMFADevice", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Deactivates the specified MFA device and removes it from association with the user name for which it was originally enabled.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Deactivation of MFA Device", "link": "https://www.elastic.co/guide/en/security/current/aws-iam-deactivation-of-mfa-device.html"}], "securityImplications": "Attackers might use DeactivateMFADevice to disable multi-factor authentication, potentially weakening account security.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam deactivate-mfa-device --user-name TrailDiscover --serial-number arn:aws:iam::210987654321:mfa/BobsMFADevice"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-DeactivateMFADevice"}
{"eventName": "AttachRolePolicy", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Attaches the specified managed policy to the specified IAM role. When you attach a managed policy to a role, the managed policy becomes part of the role's permission (access) policy.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers use AttachRolePolicy to grant malicious policies to IAM roles, potentially escalating privileges or enabling unauthorized access to AWS resources.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-4"}], "simulation": [{"type": "commandLine", "value": "aws iam attach-role-policy --policy-arn arn:aws:iam::aws:policy/TrailDiscover --role-name TrailDiscover"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.iam-create-backdoor-role"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-AttachRolePolicy"}
{"eventName": "CreateGroup", "eventSource": "iam.amazonaws.com", "awsService": "IAM", "description": "Creates a new group.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Group Creation", "link": "https://www.elastic.co/guide/en/security/current/aws-iam-group-creation.html"}], "securityImplications": "Attackers use CreateGroup to create a group that they can use to escalate privileges.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws iam create-group --group-name TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/iam#iam-CreateGroup"}
{"eventName": "SwitchRole", "eventSource": "signin.amazonaws.com", "awsService": "SignIn", "description": "This event is recorded when a user manually switches to a different IAM role within the AWS Management Console.", "mitreAttackTactics": ["TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1021 - Remote Services"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS CloudTrail cheat sheet", "link": "https://www.invictus-ir.com/news/aws-cloudtrail-cheat-sheet"}], "securityImplications": "Attackers might use SwitchRole when using the console to escalate privileges and gain unauthorized access to AWS resources.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "N/A"}
{"eventName": "PasswordRecoveryRequested ", "eventSource": "signin.amazonaws.com", "awsService": "SignIn", "description": "This is the CloudTrail event generated when you request a password recovery.", "mitreAttackTactics": ["TA0001 - Initial Access"], "mitreAttackTechniques": ["T1078 - Valid Accounts"], "usedInWild": true, "incidents": [{"description": "An Ongoing AWS Phishing Campaign", "link": "https://www.cadosecurity.com/an-ongoing-aws-phishing-campaign/"}, {"description": "Disclosure of Security Incidents on imToken", "link": "https://support.token.im/hc/en-us/articles/360005681954-Disclosure-of-Security-Incidents-on-imToken"}], "researchLinks": [], "securityImplications": "Attackers might start a password recovery process to steal AWS access if they have compromised the email of the user.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "N/A"}
{"eventName": "ConsoleLogin", "eventSource": "signin.amazonaws.com", "awsService": "SignIn", "description": "This is the CloudTrail event generated when you sign-in.", "mitreAttackTactics": ["TA0001 - Initial Access"], "mitreAttackTechniques": ["T1078 - Valid Accounts"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Responding to an attack in AWS", "link": "https://awstip.com/responding-to-an-attack-in-aws-9048a1a551ac"}, {"description": "Credential Phishing", "link": "https://ramimac.me/aws-phishing#credential-phishing"}, {"description": "Incident report: From CLI to console, chasing an attacker in AWS", "link": "https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}, {"description": "Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies", "link": "https://www.crowdstrike.com/blog/analysis-of-intrusion-campaign-targeting-telecom-and-bpo-companies/"}], "researchLinks": [{"description": "Compromising AWS Console credentials", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/compromising-aws-console-credentials/"}, {"description": "Create a Console Session from IAM Credentials", "link": "https://hackingthe.cloud/aws/post_exploitation/create_a_console_session_from_iam_credentials/"}, {"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}], "securityImplications": "Attackers might access via AWS console (generating a ConsoleLogin event).", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-6"}, {"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-3"}], "simulation": [{"type": "commandLine", "value": "N/A"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.initial-access.console-login-without-mfa"}], "permissions": "N/A"}
{"eventName": "AssociateAccessPolicy", "eventSource": "eks.amazonaws.com", "awsService": "EKS", "description": "Associates an access policy and its scope to an access entry.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}], "securityImplications": "Attackers might use AssociateAccessPolicy to escalate privileges by linking access entries with highly privileged policies, allowing unauthorized control over clusters.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws eks associate-access-policy --cluster-name beta-fish --principal-arn arn:aws:iam::111122223333:role/TrailDiscover --policy-arn arn:aws:eks::aws:cluster-access-policy/AmazonEKSViewPolicy --access-scope type=cluster"}], "permissions": "https://aws.permissions.cloud/iam/eks#eks-AssociateAccessPolicy"}
{"eventName": "DescribeCluster", "eventSource": "eks.amazonaws.com", "awsService": "EKS", "description": "Describes an Amazon EKS cluster.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}], "securityImplications": "Attackers might use DescribeCluster to gain insights into the configuration and status of AWS EKS clusters.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws eks describe-cluster --name TrailDiscoverCluster"}], "permissions": "https://aws.permissions.cloud/iam/eks#eks-DescribeCluster"}
{"eventName": "ListAssociatedAccessPolicies", "eventSource": "eks.amazonaws.com", "awsService": "EKS", "description": "Lists the access policies associated with an access entry.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}], "securityImplications": "Attackers might use ListAssociatedAccessPolicies to enumerate policies associated with resources in AWS services, identifying overly permissive access that can be exploited to escalate privileges.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws eks list-associated-access-policies --cluster-name beta-fish --principal-arn arn:aws:iam::111122223333:role/TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/eks#eks-ListAssociatedAccessPolicies"}
{"eventName": "CreateAccessEntry", "eventSource": "eks.amazonaws.com", "awsService": "EKS", "description": "Creates an access entry.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}], "securityImplications": "Attackers might use CreateAccessEntry to craft access entries that link to high-privileged policies, effectively granting themselves unauthorized admin-level access to clusters.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws eks create-access-entry --cluster-name beta-fish --principal-arn arn:aws:iam::111122223333:role/TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/eks#eks-CreateAccessEntry"}
{"eventName": "DescribeAccessEntry", "eventSource": "eks.amazonaws.com", "awsService": "EKS", "description": "Describes an access entry.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}], "securityImplications": "Attackers might use DescribeAccessEntry for reconnaissance, gathering detailed information about access configurations within AWS EKS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws eks describe-access-entry --cluster-name beta-fish --principal-arn arn:aws:iam::111122223333:role/TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/eks#eks-DescribeAccessEntry"}
{"eventName": "ListClusters", "eventSource": "eks.amazonaws.com", "awsService": "EKS", "description": "Lists the Amazon EKS clusters in your AWS account in the specified AWS Region.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "New attack vectors in EKS", "link": "https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features"}], "securityImplications": "Attackers might use ListClusters to inventory AWS EKS clusters, identifying active clusters for further exploration or to pinpoint potential targets for subsequent attacks.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws eks list-clusters"}], "permissions": "https://aws.permissions.cloud/iam/eks#eks-ListClusters"}
{"eventName": "GetIntrospectionSchema", "eventSource": "appsync.amazonaws.com", "awsService": "AppSync", "description": "Retrieves the introspection schema for a GraphQL API.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker’s Backdoor", "link": "https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8"}], "securityImplications": "Attackers might use GetIntrospectionSchema to understand the API for future attacks or use the configuration for future modifications.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws appsync get-introspection-schema --api-id TrailDiscover --format json output"}], "permissions": "https://aws.permissions.cloud/iam/appsync#appsync-GetIntrospectionSchema"}
{"eventName": "CreateApiKey", "eventSource": "appsync.amazonaws.com", "awsService": "AppSync", "description": "Creates a unique key that you can distribute to clients who invoke your API.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0003 - Persistence"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1556 - Modify Authentication Process"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker’s Backdoor", "link": "https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8"}], "securityImplications": "Attackers might use CreateApiKey to add a key they control for authentication. Bypassing current authentication and potentially allowing persistent access to data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws appsync create-api-key --api-id TrailDiscoverApiId"}], "permissions": "https://aws.permissions.cloud/iam/appsync#appsync-CreateApiKey"}
{"eventName": "UpdateResolver", "eventSource": "appsync.amazonaws.com", "awsService": "AppSync", "description": "Updates a Resolver object.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0003 - Persistence"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1556 - Modify Authentication Process"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker’s Backdoor", "link": "https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8"}], "securityImplications": "Attackers might use UpdateResolver to execute custom code that could allow potential access to data and bypass protections.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws appsync update-resolver --api-id TrailDiscoverApiId --type-name TrailDiscoverTypeName --field-name TrailDiscoverFieldName --pipeline-config functions=TrailDiscoverFunctions --request-mapping-template TrailDiscoverRequestMappingTemplate --response-mapping-template TrailDiscoverResponseMappingTemplate"}], "permissions": "https://aws.permissions.cloud/iam/appsync#appsync-UpdateResolver"}
{"eventName": "UpdateGraphqlApi", "eventSource": "appsync.amazonaws.com", "awsService": "AppSync", "description": "Updates a GraphqlApi object.", "mitreAttackTactics": ["TA0005 - Defense Evasion", "TA0003 - Persistence"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1556 - Modify Authentication Process"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker’s Backdoor", "link": "https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8"}], "securityImplications": "Attackers might use UpdateGraphqlApi to add additional authentications options. Bypassing current authentication and potentially allowing persistent access to data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws appsync update-graphql-api --api-id TrailDiscoverApiId --name TrailDiscoverName --log-config cloudWatchLogsRoleArn=TrailDiscoverRoleArn,fieldLogLevel=TrailDiscoverLogLevel"}], "permissions": "https://aws.permissions.cloud/iam/appsync#appsync-UpdateGraphqlApi"}
{"eventName": "UpdateFunctionCode20150331v2", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Updates a Lambda function's code. If code signing is enabled for the function, the code package must be signed by a trusted publisher.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0040 - Impact", "TA0009 - Collection"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1496 - Resource Hijacking", "T1119 - Automated Collection"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}, {"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}, {"description": "How Attackers Can Misuse AWS CloudFront Access to Make It ‘Rain’ Cookies", "link": "https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c"}], "securityImplications": "Attackers might use UpdateFunctionCode to modify the code of a Lambda function, potentially injecting malicious code.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lambda update-function-code --function-name  my-function"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.lambda-overwrite-code"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-UpdateFunctionCode"}
{"eventName": "CreateFunction20150331", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Creates a Lambda function.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0004 - Privilege Escalation", "TA0040 - Impact"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Mining Crypto", "link": "https://twitter.com/jonnyplatt/status/1471453527390277638"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use CreateFunction to deploy malicious code or functions, depending on the scenario this might allow the attacker to gain persistence, escalate privileges, or hijack resources.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lambda create-function --function-name my-function --runtime nodejs18.x --code S3Bucket=string --role arn:aws:iam::123456789012:role/service-role/MyTestFunction-role-tges6bf4"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-CreateFunction"}
{"eventName": "AddPermission20150331v2", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Grants an AWS service, AWS account, or AWS organization permission to use a function.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use AddPermission to grant unauthorized access to sensitive Lambda functions and then perform Privilege Escalation.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lambda add-permission --function-name my-function --action lambda:InvokeFunction --statement-id sns --principal sns.amazonaws.com"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.lambda-backdoor-function"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-AddPermission"}
{"eventName": "UpdateFunctionConfiguration20150331v2", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Modify the version-specific settings of a Lambda function.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}, {"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}, {"description": "LambdaSpy - Implanting the Lambda execution environment (Part two)", "link": "https://www.clearvector.com/blog/lambda-spy/"}], "securityImplications": "Attackers might use UpdateFunctionConfiguration to modify the behavior of Lambda functions, adding a layer that can allow persistence and/or data exfiltration.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lambda update-function-configuration  --function-name  my-function --memory-size 256"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.persistence.lambda-layer-extension"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-UpdateFunctionConfiguration"}
{"eventName": "UpdateEventSourceMapping20150331", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Updates an event source mapping. You can change the function that AWS Lambda invokes, or pause invocation and resume later from the same location.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}], "securityImplications": "Attackers might use UpdateEventSourceMapping to pull data from a different source, leading to incorrect function results.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lambda update-event-source-mapping --uuid 'a1b2c3d4-5678-90ab-cdef-11111EXAMPLE' --batch-size 8"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-UpdateEventSourceMapping"}
{"eventName": "Invoke", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Invokes a Lambda function.", "mitreAttackTactics": ["TA0040 - Impact", "TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Mining Crypto", "link": "https://twitter.com/jonnyplatt/status/1471453527390277638"}], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use Invoke to execute previously modified functions in AWS Lambda.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-InvokeFunction"}
{"eventName": "CreateEventSourceMapping20150331", "eventSource": "lambda.amazonaws.com", "awsService": "Lambda", "description": "Creates a mapping between an event source and an AWS Lambda function.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}], "securityImplications": "Attackers might use CreateEventSourceMapping to trigger unauthorized Lambda functions with malicious code.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws lambda create-event-source-mapping --function-name my-function --batch-size 5 --event-source-arn arn:aws:sqs:us-west-2:123456789012:mySQSqueue"}], "permissions": "https://aws.permissions.cloud/iam/lambda#lambda-CreateEventSourceMapping"}
{"eventName": "DeleteMembers", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Deletes GuardDuty member accounts (to the current GuardDuty administrator account) specified by the account IDs.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use DeleteMembers to remove members from a GuardDuty detector, disrupting threat detection and security analysis.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty delete-members --account-ids TrailDiscoverAccountIds --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-DeleteMembers"}
{"eventName": "CreateFilter", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Creates a filter using the specified finding criteria.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use CreateFilter to manipulate GuardDuty settings, potentially allowing malicious activity to go undetected.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty create-filter --detector-id TrailDiscoverDetectorId --name TrailDiscoverFilterName --finding-criteria '{\"Criterion\": {\"service.action.actionType\": {\"Eq\": [\"TrailDiscover\"]}}}' --action NOOP"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-CreateFilter"}
{"eventName": "DisassociateFromMasterAccount", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Disassociates the current GuardDuty member account from its administrator account.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use DisassociateFromMasterAccount to remove the link to the master GuardDuty account, disrupting centralized security monitoring and analysis.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty disassociate-from-master-account --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-DisassociateFromMasterAccount"}
{"eventName": "GetFindings", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Returns a list of findings that match the specified criteria.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use GetFindings to identify if previous actions generated alerts.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty get-findings --detector-id TrailDiscoverDetectorId --finding-ids TrailDiscoverFindingIds"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-GetFindings"}
{"eventName": "CreateIPSet", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Creates a new IPSet, which is called a trusted IP list in the console user interface.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use CreateIPSet to add malicious IP addresses to the GuardDuty whitelist, bypassing security measures.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_guardduty_disruption.yml"}], "simulation": [{"type": "commandLine", "value": "aws guardduty create-ip-set --detector-id 12abc34d567e8fa901bc2d34eexample --name new-ip-set --format TXT --location s3://traildiscover/traildiscover.csv --activate"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-CreateIPSet"}
{"eventName": "DeleteDetector", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Deletes an Amazon GuardDuty detector that is specified by the detector ID.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "AWS GuardDuty detector deleted", "link": "https://docs.datadoghq.com/security/default_rules/cloudtrail-aws-guardduty-detector-deleted/"}, {"description": "AWS GuardDuty Evasion", "link": "https://medium.com/@cloud_tips/aws-guardduty-evasion-c181e55f3af1"}, {"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use DeleteDetector to disable GuardDuty, thereby evading detection of malicious activity.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty delete-detector --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-DeleteDetector"}
{"eventName": "StopMonitoringMembers", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Stops GuardDuty monitoring for the specified member accounts.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use StopMonitoringMembers to halt the surveillance of specific AWS accounts, reducing security visibility.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty stop-monitoring-members --account-ids TrailDiscoverAccountIds --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-StopMonitoringMembers"}
{"eventName": "GetDetector", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Retrieves an Amazon GuardDuty detector specified by the detectorId.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use GetDetector to identify active threat detection systems in AWS GuardDuty.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty get-detector --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-GetDetector"}
{"eventName": "DeletePublishingDestination", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Deletes the publishing definition with the specified destinationId.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use DeletePublishingDestination to disrupt the security monitoring and incident response process in AWS GuardDuty.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty delete-publishing-destination --detector-id TrailDiscoverDetectorId --destination-id TrailDiscoverDestinationId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-DeletePublishingDestination"}
{"eventName": "DisassociateMembers", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Disassociates GuardDuty member accounts (from the current administrator account) specified by the account IDs.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Threat Hunting with CloudTrail and GuardDuty in Splunk", "link": "https://www.chrisfarris.com/post/reinforce-threat-hunting/"}], "securityImplications": "Attackers might use DisassociateMembers to remove members from a GuardDuty detector, disrupting threat detection and security analysis.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty disassociate-members --detector-id TrailDiscoverDetectorId --account-ids TrailDiscoverAccountIds"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-DisassociateMembers"}
{"eventName": "DeleteInvitations", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Deletes invitations sent to the current member account by AWS accounts specified by their account IDs.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteInvitations to avoid the use of GuardDuty, thereby evading detection of malicious activity.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty delete-invitations --account-ids 111222333444"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-DeleteInvitations"}
{"eventName": "UpdateDetector", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Updates the GuardDuty detector specified by the detectorId.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use UpdateDetector to modify the settings of GuardDuty, potentially disabling or weakening security monitoring.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty update-detector --detector-id TrailDiscoverDetectorId --enable --finding-publishing-frequency TrailDiscoverFrequency"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-UpdateDetector"}
{"eventName": "ListIPSets", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Lists the IPSets of the GuardDuty service specified by the detector ID.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use ListIPSets to identify what IPs won't generate an alert.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty list-ip-sets --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-ListIPSets"}
{"eventName": "ListDetectors", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Lists detectorIds of all the existing Amazon GuardDuty detector resources.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [{"description": "Modify GuardDuty Configuration", "link": "https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/"}], "securityImplications": "Attackers might use ListDetectors to identify active threat detection systems in AWS GuardDuty.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty list-detectors"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-ListDetectors"}
{"eventName": "ListFindings", "eventSource": "guardduty.amazonaws.com", "awsService": "GuardDuty", "description": "Lists GuardDuty findings for the specified detector ID.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use ListFindings to identify if previous actions generated alerts.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws guardduty list-findings --detector-id TrailDiscoverDetectorId"}], "permissions": "https://aws.permissions.cloud/iam/guardduty#guardduty-ListFindings"}
{"eventName": "IssueCertificate", "eventSource": "acm-pca.amazonaws.com", "awsService": "ACMPCA", "description": "Uses your private certificate authority (CA), or one that has been shared with you, to issue a client certificate.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1040- Network Sniffing"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS API Call Hijacking via ACM-PCA", "link": "https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/"}], "securityImplications": "Attackers might use IssueCertificate combined with Route 53 control to intercept and read data from AWS API calls.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/acm-pca#acm-pca-IssueCertificate"}
{"eventName": "GetCertificate", "eventSource": "acm-pca.amazonaws.com", "awsService": "ACMPCA", "description": "Retrieves a certificate from your private CA or one that has been shared with you.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1040- Network Sniffing"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS API Call Hijacking via ACM-PCA", "link": "https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/"}], "securityImplications": "Attackers might use GetCertificate combined with Route 53 control to intercept and read data from AWS API calls.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws acm-pca get-certificate --certificate-authority-arn arn:aws:acm-pca:us-west-2:123456789012:certificate-authority/12345678-1234-1234-1234-123456789012 --certificate-arn arn:aws:acm-pca:us-west-2:123456789012:certificate-authority/12345678-1234-1234-1234-123456789012/certificate/6707447683a9b7f4055627ffd55cebcc"}], "permissions": "https://aws.permissions.cloud/iam/acm-pca#acm-pca-GetCertificate"}
{"eventName": "GetAccountSendingEnabled", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Returns the email sending status of the Amazon SES account for the current Region.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "securityImplications": "Attackers might use GetAccountSendingEnabled to identify if an AWS account's email sending capabilities are enabled, potentially exploiting it for spamming or phishing activities.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ses get-account-sending-enabled"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-GetAccountSendingEnabled"}
{"eventName": "VerifyEmailIdentity", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Adds an email address to the list of identities for your Amazon SES account in the current AWS Region and attempts to verify it.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use VerifyEmailIdentity to send phishing emails or spam from a verified email address.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ses verify-email-identity --email-address TrailDiscoverEmail"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-VerifyEmailIdentity"}
{"eventName": "GetAccount", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Lists the applied quota values for the specified AWS service.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}, {"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use GetAccount to gather sensitive information about the AWS SES account for malicious purposes.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sesv2 get-account"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-GetAccount"}
{"eventName": "CreateEmailIdentity", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Starts the process of verifying an email identity. An identity is an email address or domain that you use when you send email.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers use CreateEmailIdentity to create its own identity for sending spam or phishing emails later.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws sesv2 create-email-identity --email-identity cloudtrail.cloud"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-CreateEmailIdentity"}
{"eventName": "DeleteIdentity", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Deletes the specified identity (an email address or a domain) from the list of verified identities.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure", "T1070 - Indicator Removal"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteIdentity to disrupt email sending capabilities or delete an identity previously used attackers.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_delete_identity.yml"}], "simulation": [{"type": "commandLine", "value": "aws ses delete-identity --identity TrailDiscoverIdentity"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-DeleteIdentity"}
{"eventName": "GetSendQuota", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Provides the sending limits for the Amazon SES account.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers use GetSendQuota to assess the email sending capacity of an AWS account, potentially planning persistent spam or phishing campaigns by identifying limits they can exploit or escalate.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ses get-send-quota"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-GetSendQuota"}
{"eventName": "GetIdentityVerificationAttributes", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Given a list of identities (email addresses and/or domains), returns the verification status and (for domain identities) the verification token for each identity.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1526 - Cloud Service Discovery"], "usedInWild": true, "incidents": [{"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "researchLinks": [], "securityImplications": "Attackers might use GetIdentityVerificationAttributes to gather sensitive information about the verification status of email addresses and domains.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ses get-identity-verification-attributes --identities TrailDiscoverIdentity"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-GetIdentityVerificationAttributes"}
{"eventName": "ListIdentities", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Returns a list containing all of the identities (email addresses and domains) for your AWS account in the current AWS Region, regardless of verification status.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1087 - Account Discovery"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Ransomware in the cloud", "link": "https://www.invictus-ir.com/news/ransomware-in-the-cloud"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}, {"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers use ListIdentities from SES to enumerate email addresses or domains verified under the AWS account.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ses list-identities --identity-type \"EmailAddress\""}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-ListIdentities"}
{"eventName": "UpdateAccountSendingEnabled", "eventSource": "ses.amazonaws.com", "awsService": "SES", "description": "Enables or disables email sending across your entire Amazon SES account in the current AWS Region.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}, {"description": "SES-PIONAGE", "link": "https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/"}], "researchLinks": [], "securityImplications": "Attackers might use UpdateAccountSendingEnabled to enable sending from compromised AWS accounts, facilitating spam or phishing campaigns.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ses update-account-sending-enabled"}], "permissions": "https://aws.permissions.cloud/iam/ses#ses-UpdateAccountSendingEnabled"}
{"eventName": "AuthorizeDBSecurityGroupIngress", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Enables ingress to a DBSecurityGroup using one of two forms of authorization.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}, {"description": "Hunting AWS RDS security events with Sysdig", "link": "https://sysdig.com/blog/aws-rds-security-events-sysdig/"}], "securityImplications": "Attackers might use AuthorizeDBSecurityGroupIngress to allow unauthorized access to the database by modifying security group rules.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds authorize-db-security-group-ingress --db-security-group-name TrailDiscoverDBSecurityGroupName --cidrip TrailDiscoverCIDRIP"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-AuthorizeDBSecurityGroupIngress"}
{"eventName": "DeleteDBCluster", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "The DeleteDBCluster action deletes a previously provisioned DB cluster.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Hunting AWS RDS security events with Sysdig", "link": "https://sysdig.com/blog/aws-rds-security-events-sysdig/"}, {"description": "AWS Deletion of RDS Instance or Cluster", "link": "https://www.elastic.co/guide/en/security/current/aws-deletion-of-rds-instance-or-cluster.html"}], "securityImplications": "Attackers might use DeleteDBCluster to delete crucial databases, causing data loss and service disruption.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds delete-db-cluster --db-cluster-identifier TrailDiscoverDBCluster"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-DeleteDBCluster"}
{"eventName": "CreateDBSecurityGroup", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Creates a new DB security group. DB security groups control access to a DB instance.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}, {"description": "Hunting AWS RDS security events with Sysdig", "link": "https://sysdig.com/blog/aws-rds-security-events-sysdig/"}], "securityImplications": "Attackers might use CreateDBSecurityGroup to create new security groups with lax rules, potentially allowing unauthorized access to the database.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds create-db-security-group --db-security-group-name TrailDiscoverSecurityGroupName --db-security-group-description TrailDiscoverDescription"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-CreateDBSecurityGroup"}
{"eventName": "DeleteGlobalCluster", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Deletes a global database cluster. The primary and secondary clusters must already be detached or destroyed first.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS Deletion of RDS Instance or Cluster", "link": "https://www.elastic.co/guide/en/security/current/aws-deletion-of-rds-instance-or-cluster.html"}], "securityImplications": "Attackers might use DeleteGlobalCluster to disrupt database services by deleting global clusters in AWS RDS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds delete-global-cluster --global-cluster-identifier TrailDiscoverGlobalClusterIdentifier"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-DeleteGlobalCluster"}
{"eventName": "ModifyDBSnapshotAttribute", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Adds an attribute and values to, or removes an attribute and values from, a manual DB snapshot.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "Imperva Security Update", "link": "https://www.imperva.com/blog/ceoblog/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [{"description": "Stealing an RDS database by creating a snapshot and sharing it", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-rds-snapshot/"}, {"description": "Hunting AWS RDS security events with Sysdig", "link": "https://sysdig.com/blog/aws-rds-security-events-sysdig/"}], "securityImplications": "Attackers might use ModifyDBSnapshotAttribute to alter database snapshot permissions, potentially gaining unauthorized access to sensitive data via sharing it.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds modify-db-snapshot-attribute --db-snapshot-identifier TrailDiscoverDBSnapshotIdentifier --attribute-name TrailDiscoverAttributeName --values-to-add TrailDiscoverValuesToAdd"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.rds-share-snapshot"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-ModifyDBSnapshotAttribute"}
{"eventName": "StartExportTask", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Starts an export of DB snapshot or DB cluster data to Amazon S3.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS - RDS Post Exploitation", "link": "https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-post-exploitation/aws-rds-post-exploitation"}], "securityImplications": "Attackers might use StartExportTask to export database snapshots to an S3 they control and gain access to the data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds start-export-task --export-task-identifier my-s3-export --source-arn arn:aws:rds:us-west-2:123456789012:snapshot:db5-snapshot-test --s3-bucket-name mybucket --iam-role-arn arn:aws:iam::123456789012:role/service-role/TrailDiscover --kms-key-id arn:aws:kms:us-west-2:123456789012:key/abcd0000-7fca-4128-82f2-aabbccddeeff"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-StartExportTask"}
{"eventName": "CreateDBSnapshot", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Creates a snapshot of a DB instance.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [{"description": "Stealing an RDS database by creating a snapshot and sharing it", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-rds-snapshot/"}], "securityImplications": "Attackers might use CreateDBSnapshot to create unauthorized backups of sensitive databases for data theft.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds create-db-snapshot --db-instance-identifier TrailDiscoverDBInstance --db-snapshot-identifier TrailDiscoverDBSnapshot"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-CreateDBSnapshot"}
{"eventName": "ModifyActivityStream", "eventSource": "rds.amazonaws.com", "awsService": "RDS", "description": "Changes the audit policy state of a database activity stream to either locked (default) or unlocked.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": true, "incidents": [{"description": "Uncovering Hybrid Cloud Attacks Through Intelligence-Driven Incident Response: Part 3 – The Response", "link": "https://www.gem.security/post/uncovering-hybrid-cloud-attacks-through-intelligence-driven-incident-response-part-3-the-response"}], "researchLinks": [], "securityImplications": "Attackers might use ModifyActivityStream to alter the configuration of the activity stream, potentially hiding malicious activities or causing disruptions in the database operations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws rds modify-activity-stream"}], "permissions": "https://aws.permissions.cloud/iam/rds#rds-ModifyActivityStream"}
{"eventName": "DeleteMountTarget", "eventSource": "elasticfilesystem.amazonaws.com", "awsService": "elasticfilesystem", "description": "Deletes the specified mount target.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS EFS File System or Mount Deleted", "link": "https://www.elastic.co/guide/en/security/7.17/aws-efs-file-system-or-mount-deleted.html"}], "securityImplications": "Attackers might use DeleteMountTarget in AWS EFS to remove mount targets, disrupting access to file system and as a preliminary phase before data deletion.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_efs_fileshare_mount_modified_or_deleted.yml"}], "simulation": [{"type": "commandLine", "value": "aws efs delete-mount-target --mount-target-id fsmt-f9a14450"}], "permissions": "https://aws.permissions.cloud/iam/elasticfilesystem#elasticfilesystem-DeleteMountTarget"}
{"eventName": "DeleteFileSystem", "eventSource": "elasticfilesystem.amazonaws.com", "awsService": "elasticfilesystem", "description": "Deletes a file system, permanently severing access to its contents.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS EFS File System or Mount Deleted", "link": "https://www.elastic.co/guide/en/security/7.17/aws-efs-file-system-or-mount-deleted.html"}], "securityImplications": "Attackers might use DeleteFileSystem in AWS EFS to deliberately erase file systems, leading to data loss.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_efs_fileshare_modified_or_deleted.yml"}], "simulation": [{"type": "commandLine", "value": "aws efs delete-file-system --file-system-id fs-c7a0456e"}], "permissions": "https://aws.permissions.cloud/iam/elasticfilesystem#elasticfilesystem-DeleteFileSystem"}
{"eventName": "GetQueryResults", "eventSource": "athena.amazonaws.com", "awsService": "Athena", "description": "Streams the results of a single query execution specified by QueryExecutionId from the Athena query results location in Amazon S3.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetQueryResults from Amazon Athena to illicitly access and read potential sensitive data.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/athena#athena-GetQueryResults"}
{"eventName": "GetHostedZoneCount", "eventSource": "route53.amazonaws.com", "awsService": "Route53", "description": "Retrieves the number of hosted zones that are associated with the current AWS account.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use GetHostedZoneCount to gather information about the number of hosted zones, potentially identifying targets for DNS attacks.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws route53 get-hosted-zone-count"}], "permissions": "https://aws.permissions.cloud/iam/route53#route53-GetHostedZoneCount"}
{"eventName": "ChangeResourceRecordSets", "eventSource": "route53.amazonaws.com", "awsService": "Route53", "description": "Creates, changes, or deletes a resource record set, which contains authoritative DNS information for a specified domain name or subdomain name.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [{"description": "AWS API Call Hijacking via ACM-PCA", "link": "https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/"}], "securityImplications": "Attackers might use ChangeResourceRecordSets to redirect traffic to malicious websites.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/route53#route53-ChangeResourceRecordSets"}
{"eventName": "CreateHostedZone", "eventSource": "route53.amazonaws.com", "awsService": "Route53", "description": "Creates a new public or private hosted zone. You create records in a public hosted zone to define how you want to route traffic on the internet for a domain, such as example.com, and its subdomains.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [{"description": "AWS API Call Hijacking via ACM-PCA", "link": "https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/"}], "securityImplications": "Attackers might use CreateHostedZone to create malicious DNS zones for phishing or redirecting traffic.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws route53 create-hosted-zone --name traildiscover.cloud --caller-reference 2014-04-01-18:47 --hosted-zone-config Comment='traildiscover'"}], "permissions": "https://aws.permissions.cloud/iam/route53#route53-CreateHostedZone"}
{"eventName": "ListDomains", "eventSource": "route53domains.amazonaws.com", "awsService": "route53domains", "description": "This operation returns all the domain names registered with Amazon Route 53 for the current AWS account if no filtering conditions are used.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use ListDomains to identify potential targets for DNS hijacking or DDoS attacks.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws route53domains list-domains --region us-east-1"}], "permissions": "https://aws.permissions.cloud/iam/route53domains#route53domains-ListDomains"}
{"eventName": "RegisterDomain", "eventSource": "route53domains.amazonaws.com", "awsService": "route53domains", "description": "This operation registers a domain. For some top-level domains (TLDs), this operation requires extra parameters.", "mitreAttackTactics": ["TA0040 - Impact"], "mitreAttackTechniques": ["T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use RegisterDomain to register malicious domains for phishing or malware distribution.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws route53domains register-domain --region us-east-1 --cli-input-json '{\"DomainName\": \"\", \"DurationInYears\": 1, \"AdminContact\": { \"FirstName\": \"\", \"LastName\": \"\"}, \"RegistrantContact\": {\"FirstName\": \"\", \"LastName\": \"\" }, \"TechContact\": {\"FirstName\": \"\", \"LastName\": \"\"}}'"}], "permissions": "https://aws.permissions.cloud/iam/route53domains#route53domains-RegisterDomain"}
{"eventName": "CreateTrafficMirrorTarget", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a target for your Traffic Mirror session.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1074 - Data Staged"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use CreateTrafficMirrorTarget to establish destinations for mirrored traffic, potentially facilitating the unauthorized observation or capture of sensitive information.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-traffic-mirror-target --description TrailDiscoverDescription --network-interface-id TrailDiscoverNetworkInterfaceId --network-load-balancer-arn TrailDiscoverNetworkLoadBalancerArn"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateTrafficMirrorTarget"}
{"eventName": "DeleteFlowLogs", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Deletes one or more flow logs.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1089 - Disabling Security Tools"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Removing VPC flow logs", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/removing-vpc-flow-logs/"}, {"description": "AWS Incident Response", "link": "https://github.com/easttimor/aws-incident-response"}, {"description": "Proactive Cloud Security w/ AWS Organizations", "link": "https://witoff.medium.com/proactive-cloud-security-w-aws-organizations-d58695bcae16"}], "securityImplications": "Attackers might use DeleteFlowLogs to remove records of network traffic within AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 delete-flow-logs --flow-log-ids TrailDiscoverFlowLogId"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.defense-evasion.vpc-remove-flow-logs"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DeleteFlowLogs"}
{"eventName": "GetLaunchTemplateData", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Retrieves the configuration data of the specified instance. You can use this data to create a launch template.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetLaunchTemplateData to obtain configurations of EC2 launch templates, identifying predefined instance settings or network configuration.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-launch-template-data --instance-id TrailDiscoverInstanceId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetLaunchTemplateData"}
{"eventName": "SendSSHPublicKey", "eventSource": "ec2-instance-connect.amazonaws.com", "awsService": "EC2InstanceConnect", "description": "Pushes an SSH public key to the specified EC2 instance for use by the specified user.", "mitreAttackTactics": ["TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [], "securityImplications": "Attackers might use SendSSHPublicKey to inject unauthorized SSH keys into EC2 instances, granting them access for remote control.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.lateral-movement.ec2-instance-connect"}], "permissions": "https://aws.permissions.cloud/iam/ec2-instance-connect#ec2-instance-connect-SendSSHPublicKey"}
{"eventName": "DescribeRegions", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the Regions that are enabled for your account, or all Regions.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use DescribeRegions to identify all available AWS regions, possibly to explore regional deployment patterns and target specific regions where defenses might be weaker.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-regions"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeRegions"}
{"eventName": "DescribeSecurityGroups", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified security groups or all of your security groups.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Case Study: Responding to an Attack in AWS", "link": "https://www.cadosecurity.com/case-study-responding-to-an-attack-in-aws/"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeSecurityGroups to review AWS VPC security group configurations, seeking misconfigurations that could be exploited for unauthorized access or to bypass network security controls.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-security-groups --group-names TrailDiscoverSecurityGroup"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeSecurityGroups"}
{"eventName": "CreateVolume", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates an EBS volume that can be attached to an instance in the same Availability Zone.", "mitreAttackTactics": ["TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [], "securityImplications": "Attackers might use CreateVolume to create a volume from a snapshot and mount it to an EC2 instance under their control.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-volume --size 80 --availability-zone us-east-1a"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateVolume"}
{"eventName": "DeleteVolume", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Deletes the specified EBS volume. The volume must be in the available state (not attached to an instance).", "mitreAttackTactics": ["T1485 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": true, "incidents": [{"description": "Hacker Puts Hosting Service Code Spaces Out of Business", "link": "https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteVolume to remove Elastic Block Store (EBS) volumes, leading to data loss and potentially disrupting operations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 delete-volume --volume-id TrailDiscoverVolumeId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DeleteVolume"}
{"eventName": "DescribeImages", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified images (AMIs, AKIs, and ARIs) available to you or all of the images available to you.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeImages to identify AMIs (Amazon Machine Images) within AWS.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-images --filters Name=name,Values=TrailDiscover"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeImages"}
{"eventName": "CreateTrafficMirrorFilter", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a Traffic Mirror filter.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1074 - Data Staged"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use CreateTrafficMirrorFilter to clandestinely mirror network traffic for analysis or exfiltration.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-traffic-mirror-filter --description 'TCP Filter'"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateTrafficMirrorFilter"}
{"eventName": "DescribeInstanceAttribute", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified attribute of the specified instance. You can specify only one attribute at a time.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeInstanceAttribute to inspect detailed configurations of EC2 instances.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-instance-attribute --instance-id TrailDiscoverInstanceId --attribute TrailDiscoverAttribute"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-download-user-data"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeInstanceAttribute"}
{"eventName": "CreateSnapshot", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a snapshot of an EBS volume and stores it in Amazon S3.", "mitreAttackTactics": ["TA0008 - Lateral Movement", "TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account", "T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "CrowdStrike’s work with the Democratic National Committee: Setting the record straight", "link": "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/"}, {"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [{"description": "Stealing an EBS snapshot by creating a snapshot and sharing it", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-ebs-snapshot/"}, {"description": "Exfiltrate EBS Snapshot by Sharing It", "link": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot/"}], "securityImplications": "Attackers might use ModifySnapshotAttribute to alter permissions on EBS snapshots, potentially exposing sensitive data to unauthorized parties.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 modify-snapshot-attribute --snapshot-id snap-1234567890abcdef0 --attribute createVolumePermission --operation-type remove --user-ids 123456789012"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-ModifySnapshotAttribute"}
{"eventName": "CreateKeyPair", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates an ED25519 or 2048-bit RSA key pair with the specified name and in the specified PEM or PPK format.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "securityImplications": "Attackers might use CreateKeyPair to generate keys that can latter be used to access EC2s.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-key-pair --key-name TrailDiscoverKeyPair"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateKeyPair"}
{"eventName": "ModifySnapshotAttribute", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Adds or removes permission settings for the specified snapshot.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "CrowdStrike’s work with the Democratic National Committee: Setting the record straight", "link": "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/"}], "researchLinks": [], "securityImplications": "Attackers might use ModifySnapshotAttribute to change permissions on Amazon EBS snapshots, potentially making them accessible to unauthorized users or public.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_snapshot_backup_exfiltration.yml"}], "simulation": [{"type": "commandLine", "value": "aws ec2 modify-snapshot-attribute --snapshot-id snap-046281ab24d756c50 --attribute createVolumePermission --operation-type remove --user-ids 123456789012"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-ModifySnapshotAttribute"}
{"eventName": "CreateTrafficMirrorFilterRule", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a Traffic Mirror filter rule.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1074 - Data Staged"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use CreateTrafficMirrorFilterRule to fine-tune traffic mirroring for selective interception.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-traffic-mirror-filter-rule --description 'TCP Rule' --destination-cidr-block 0.0.0.0/0 --protocol 6 --rule-action accept --rule-number 1  --source-cidr-block 0.0.0.0/0 --traffic-direction ingress --traffic-mirror-filter-id tmf-04812ff784b25ae67"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateTrafficMirrorFilterRule"}
{"eventName": "DeleteNetworkAcl", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Deletes the specified network ACL.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Ensure CloudWatch has an Alarm for Network ACL Changes", "link": "https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-network-acl-change"}], "securityImplications": "Attackers might use DeleteNetworkAcl to remove network access control lists, potentially opening up network segments for unauthorized access.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-11"}], "simulation": [{"type": "commandLine", "value": "aws ec2 delete-network-acl --network-acl-id TrailDiscoverNetworkAclId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DeleteNetworkAcl"}
{"eventName": "DescribeTransitGatewayMulticastDomains", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes one or more transit gateway multicast domains.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeTransitGatewayMulticastDomains to obtain details on multicast domains within AWS Transit Gateways, identifying network segments and multicast configurations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-transit-gateway-multicast-domains --transit-gateway-multicast-domain-ids TrailDiscoverTransitGatewayMulticastDomainId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeTransitGatewayMulticastDomains"}
{"eventName": "DescribeAvailabilityZones", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the Availability Zones, Local Zones, and Wavelength Zones that are available to you.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeAvailabilityZones to map the deployment regions of an AWS environment.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-availability-zones --filters Name=region-name,Values=TrailDiscoverRegion"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeAvailabilityZones"}
{"eventName": "DescribeCarrierGateways", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes one or more of your carrier gateways.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeCarrierGateways to uncover details about carrier gateways in an AWS environment, which could reveal network configurations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-carrier-gateways --carrier-gateway-ids TrailDiscoverCarrierGatewayId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeCarrierGateways"}
{"eventName": "DescribeVolumes", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified EBS volumes or all of your EBS volumes.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeVolumes to enumerate EBS volumes in an AWS environment, identifying valuable data storage.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-volumes --volume-ids TrailDiscoverVolumeId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeVolumes"}
{"eventName": "ModifyImageAttribute", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Modifies the specified attribute of the specified AMI.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS AMI Atttribute Modification for Exfiltration", "link": "https://research.splunk.com/cloud/f2132d74-cf81-4c5e-8799-ab069e67dc9f/"}], "securityImplications": "Attackers might use ModifyImageAttribute to alter permissions or settings of Amazon Machine Images (AMIs), potentially exposing them to unauthorized users or making them public.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 modify-image-attribute --image-id TrailDiscoverImageId --attribute TrailDiscoverAttribute --value TrailDiscoverValue"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ami"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-ModifyImageAttribute"}
{"eventName": "GetEbsEncryptionByDefault", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes whether EBS encryption by default is enabled for your account in the current Region.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetEbsEncryptionByDefault to determine if new Amazon EBS volumes are encrypted by default, seeking to exploit unencrypted volumes.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-ebs-encryption-by-default"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetEbsEncryptionByDefault"}
{"eventName": "AttachVolume", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Attaches an EBS volume to a running or stopped instance and exposes it to the instance with the specified device name.", "mitreAttackTactics": ["TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [], "securityImplications": "Attackers might use AttachVolume to mount a volume to an EC2 instance under their control.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 attach-volume --volume-id TrailDiscoverVolumeId --instance-id TrailDiscoverInstanceId --device TrailDiscoverDeviceName"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-AttachVolume"}
{"eventName": "DescribeBundleTasks", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified bundle tasks or all of your bundle tasks.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeBundleTasks to gain insights into the bundling tasks of EC2 instances.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-bundle-tasks --bundle-ids TrailDiscoverBundleId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeBundleTasks"}
{"eventName": "AuthorizeSecurityGroupEgress", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Adds the specified outbound (egress) rules to a security group.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1048 - Exfiltration Over Alternative Protocol"], "usedInWild": true, "incidents": [{"description": "Trouble in Paradise", "link": "https://blog.darklab.hk/2021/07/06/trouble-in-paradise/"}], "researchLinks": [], "securityImplications": "Attackers might use AuthorizeSecurityGroupEgress to allow exfiltration.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-10"}], "simulation": [{"type": "commandLine", "value": "aws ec2 authorize-security-group-egress --group-id sg-1a2b3c4d --ip-permissions IpProtocol=tcp,FromPort=80,ToPort=80,IpRanges='[{CidrIp=10.0.0.0/16}]'"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-AuthorizeSecurityGroupEgress"}
{"eventName": "DescribeKeyPairs", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified key pairs or all of your key pairs.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Behind the scenes in the Expel SOC: Alert-to-fix in AWS", "link": "https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeKeyPairs to audit the SSH key pairs associated with EC2 instances", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-key-pairs --key-names TrailDiscoverKeyPair"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeKeyPairs"}
{"eventName": "CreateInstanceExportTask", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Exports a running or stopped instance to an Amazon S3 bucket.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1005 - Data from Local System"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS EC2 VM Export Failure", "link": "https://www.elastic.co/guide/en/security/current/aws-ec2-vm-export-failure.html"}], "securityImplications": "Attackers might use CreateInstanceExportTask to extract or exfiltrate information", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_ec2_vm_export_failure.yml"}], "simulation": [{"type": "commandLine", "value": "aws ec2 create-instance-export-task --instance-id TrailDiscoverInstanceId --target-environment TrailDiscoverTargetEnvironment --export-to-s3-task DiskImageFormat=TrailDiscoverDiskImageFormat,ContainerFormat=TrailDiscoverContainerFormat,S3Bucket=TrailDiscoverS3Bucket,S3Prefix=TrailDiscoverS3Prefix"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateInstanceExportTask"}
{"eventName": "CreateDefaultVpc", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a default VPC with a size /16 IPv4 CIDR block and a default subnet in each Availability Zone.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0040 - Impact"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}], "researchLinks": [], "securityImplications": "Attackers might use CreateDefaultVpc to create a VPC and lauch EC2 instances.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-default-vpc"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateDefaultVpc"}
{"eventName": "GetTransitGatewayRouteTableAssociations", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Gets information about the associations for the specified transit gateway route table.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetTransitGatewayRouteTableAssociations to examine the associations between transit gateway route tables and attached resources, potentially to understand network routing policies.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-transit-gateway-route-table-associations --transit-gateway-route-table-id tgw-rtb-0a823edbdeEXAMPLE"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetTransitGatewayRouteTableAssociations"}
{"eventName": "CreateSecurityGroup", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a security group.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Behind the scenes in the Expel SOC: Alert-to-fix in AWS", "link": "https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}], "researchLinks": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}, {"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use CreateSecurityGroup to establish new security groups with lax rules, facilitating unauthorized access or resource exploitation within AWS environments.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-10"}], "simulation": [{"type": "commandLine", "value": "aws ec2 create-security-group --group-name TrailDiscoverGroupName --description \"TrailDiscoverDescription\""}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateSecurityGroup"}
{"eventName": "DescribeAccountAttributes", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes attributes of your AWS account.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeAccountAttributes to gather detailed information about AWS account configurations and limits.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-account-attributes --attribute-names TrailDiscoverAttribute"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeAccountAttributes"}
{"eventName": "TerminateInstances", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Shuts down the specified instances. This operation is idempotent; if you terminate an instance more than once, each call succeeds.", "mitreAttackTactics": ["TA0040 - Impact", "TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1485 - Data Destruction", "T1070 - Indicator Removal"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "Former Cisco engineer sentenced to prison for deleting 16k Webex accounts", "link": "https://www.zdnet.com/article/former-cisco-engineer-sentenced-to-prison-for-deleting-16k-webex-accounts/"}, {"description": "Hacker Puts Hosting Service Code Spaces Out of Business", "link": "https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/"}], "researchLinks": [], "securityImplications": "Attackers might use TerminateInstances to permanently delete EC2 instances, resulting in irreversible data loss and service disruption or for defense evasion.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 terminate-instances --instance-ids TrailDiscoverInstanceID"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-TerminateInstances"}
{"eventName": "CreateTrafficMirrorSession", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a Traffic Mirror session.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1074 - Data Staged"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use CreateTrafficMirrorSession to initiate a session for mirroring network traffic, potentially for malicious monitoring or data exfiltration.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-traffic-mirror-session --description TrailDiscoverDescription --traffic-mirror-target-id tmt-07f75d8feeEXAMPLE --network-interface-id eni-070203f901EXAMPLE --session-number 1 --packet-length 25 --traffic-mirror-filter-id tmf-04812ff784EXAMPLE"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateTrafficMirrorSession"}
{"eventName": "GetConsoleScreenshot", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Retrieve a JPG-format screenshot of a running instance to help with troubleshooting.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetConsoleScreenshot to capture the current state of an EC2 instance's console, potentially revealing sensitive information displayed on the screen or identifying misconfigurations.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-console-screenshot --instance-id TrailDiscoverInstanceId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetConsoleScreenshot"}
{"eventName": "DescribeSnapshotAttribute", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified attribute of the specified snapshot.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeSnapshotAttribute to inspect attributes of EBS snapshots, such as permissions, aiming to find snapshots shared publicly or with broad access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-snapshot-attribute --snapshot-id TrailDiscoverSnapshotId --attribute TrailDiscoverAttribute"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeSnapshotAttribute"}
{"eventName": "AuthorizeSecurityGroupIngress", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Adds the specified inbound (ingress) rules to a security group.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "Finding evil in AWS", "link": "https://expel.com/blog/finding-evil-in-aws/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Behind the scenes in the Expel SOC: Alert-to-fix in AWS", "link": "https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability", "link": "https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/"}, {"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [{"description": "Opening a security group to the Internet", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/opening-security-group-port/"}], "securityImplications": "Attackers might use AuthorizeSecurityGroupIngress to allow access to resources to gain persistence or move laterally.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-10"}], "simulation": [{"type": "commandLine", "value": "aws ec2 authorize-security-group-ingress --group-id sg-0683fcf7a41c82593 --protocol tcp --port 22 --cidr 203.0.113.0/24"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-security-group-open-port-22-ingress"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-AuthorizeSecurityGroupIngress"}
{"eventName": "ModifyInstanceAttribute", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Modifies the specified attribute of the specified instance.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Executing commands through EC2 user data", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/"}, {"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "EC2 Privilege Escalation Through User Data", "link": "https://hackingthe.cloud/aws/exploitation/local_ec2_priv_esc_through_user_data/"}, {"description": "User Data Script Persistence", "link": "https://hackingthe.cloud/aws/post_exploitation/user_data_script_persistence/"}], "securityImplications": "Attackers might use ModifyInstanceAttribute to change configurations of EC2 instances or overwrite the user data of an EC2 instance to have it execute malicious commands when the instance starts.", "alerting": [{"type": "sigma", "value": "https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/cloudtrail/aws_ec2_startup_script_change.yml"}], "simulation": [{"type": "commandLine", "value": "aws ec2 modify-instance-attribute --instance-id TrailDiscoverInstanceId --attribute TrailDiscoverAttribute --value TrailDiscoverValue"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.execution.ec2-user-data"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-ModifyInstanceAttribute"}
{"eventName": "DeleteNetworkAclEntry", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Deletes the specified ingress or egress entry (rule) from the specified network ACL.", "mitreAttackTactics": ["TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1562 - Impair Defenses"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Ensure CloudWatch has an Alarm for Network ACL Changes", "link": "https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-network-acl-change"}], "securityImplications": "Attackers might use DeleteNetworkAclEntry to remove specific rules from network access control lists, potentially opening network paths for unauthorized access.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-11"}], "simulation": [{"type": "commandLine", "value": "aws ec2 delete-network-acl-entry --network-acl-id acl-5fb85d36 --ingress --rule-number 100"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DeleteNetworkAclEntry"}
{"eventName": "StartInstances", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Starts an Amazon EBS-backed instance that you've previously stopped.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0040 - Impact"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1496 - Resource Hijacking"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [{"description": "Executing commands through EC2 user data", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/"}], "securityImplications": "Attackers might use StartInstances to reactivate dormant EC2 instances or after having modified the user data for execution of commands.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 start-instances --instance-ids TrailDiscoverInstanceID"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-StartInstances"}
{"eventName": "SharedSnapshotVolumeCreated", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Modifies the specified attribute of the specified instance.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "M-Trends Report - 2020", "link": "https://www.mandiant.com/sites/default/files/2021-09/mtrends-2020.pdf"}, {"description": "Democratic National Committee hack", "link": "https://www.politico.com/f/?id=00000168-6161-de11-af7d-ef7327ea0000"}], "researchLinks": [{"description": "Detecting exfiltration of EBS snapshots in AWS", "link": "https://twitter.com/christophetd/status/1574681313218506753"}], "securityImplications": "SharedSnapshotVolumeCreated might be a signal of an attacker copying a snapshot to their account.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot"}], "permissions": "N/A"}
{"eventName": "DescribeDhcpOptions", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes one or more of your DHCP options sets.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeDhcpOptions to inspect DHCP configurations in an AWS VPC.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-dhcp-options --dhcp-options-ids TrailDiscoverDhcpOptionsId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeDhcpOptions"}
{"eventName": "CreateRoute", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates a route in a route table within a VPC.", "mitreAttackTactics": ["TA0009 - Collection"], "mitreAttackTechniques": ["T1074 - Data Staged"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "Ensure CloudWatch has an Alarm for Route Table Changes", "link": "https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-route-table-change"}, {"description": "AWS Incident Response", "link": "https://easttimor.github.io/aws-incident-response/"}], "securityImplications": "Attackers might use CreateRoute to redirect network traffic within AWS VPCs to eavesdrop or exfiltrate data.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-13"}], "simulation": [{"type": "commandLine", "value": "aws ec2 create-route --route-table-id TrailDiscoverRouteTableId --destination-cidr-block TrailDiscoverDestinationCidrBlock --gateway-id TrailDiscoverGatewayId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateRoute"}
{"eventName": "DescribeInstanceTypes", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the details of the instance types that are offered in a location.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeInstanceTypes to assess the capabilities and resources of EC2 instance types.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-instance-types --instance-types TrailDiscoverInstanceType"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeInstanceTypes"}
{"eventName": "DescribeVpcs", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes one or more of your VPCs.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeVpcs to enumerate all Virtual Private Clouds (VPCs) within an AWS environment, aiming to map out network architectures.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-vpcs --vpc-ids TrailDiscoverVpcId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeVpcs"}
{"eventName": "RunInstances", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Launches the specified number of instances using an AMI for which you have permissions.", "mitreAttackTactics": ["TA0003 - Persistence", "TA0040 - Impact", "TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1098 - Account Manipulation", "T1496 - Resource Hijacking", "T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "The curious case of DangerDev@protonmail.me", "link": "https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me"}, {"description": "DXC spills AWS private keys on public GitHub", "link": "https://www.theregister.com/2017/11/14/dxc_github_aws_keys_leaked/"}, {"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Behind the scenes in the Expel SOC: Alert-to-fix in AWS", "link": "https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}, {"description": "SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto", "link": "https://sysdig.com/blog/scarleteel-2-0/"}, {"description": "ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING", "link": "https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/"}, {"description": "UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR", "link": "https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/"}, {"description": "Clear and Uncommon Story About Overcoming Issues With AWS", "link": "https://topdigital.agency/clear-and-uncommon-story-about-overcoming-issues-with-aws/"}, {"description": "onelogin 2017 Security Incident", "link": "https://web.archive.org/web/20210620180614/https://www.onelogin.com/blog/may-31-2017-security-incident"}, {"description": "BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability", "link": "https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/"}, {"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [{"description": "Launching EC2 instances", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/launching-ec2-instances/"}, {"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}, {"description": "AWS IAM Privilege Escalation Techniques", "link": "https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/"}, {"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use RunInstances to programmatically launch unauthorized EC2 instances for crypto mining or to create a foothold within the AWS environment for further exploitation.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 run-instances --image-id ami-0b98a32b1c5e0d105 --instance-type t2.micro --key-name MyKeyPair"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.execution.ec2-launch-unusual-instances"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-RunInstances"}
{"eventName": "EnableSerialConsoleAccess", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Enables access to the EC2 serial console of all instances for your account.", "mitreAttackTactics": ["TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [{"description": "How to detect EC2 Serial Console enabled", "link": "https://sysdig.com/blog/ec2-serial-console-enabled/"}], "securityImplications": "Attackers might use EnableSerialConsoleAccess to enable the serial console access and bypass security group rules and gain access to EC2 instances.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 enable-serial-console-access"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-EnableSerialConsoleAccess"}
{"eventName": "CreateNetworkAclEntry", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates an entry (a rule) in a network ACL with the specified rule number.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": false, "incidents": [], "researchLinks": [{"description": "AWS EC2 Network Access Control List Creation", "link": "https://www.elastic.co/guide/en/security/current/aws-ec2-network-access-control-list-creation.html"}, {"description": "Enhancing Your Security Visibility and DetectionResponse Operations in AWS", "link": "https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf"}], "securityImplications": "Attackers might use CreateNetworkAclEntry to allow traffic to the network from an IP they control.", "alerting": [{"type": "cloudwatchCISControls", "value": "https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-11"}], "simulation": [{"type": "commandLine", "value": "aws ec2 create-network-acl-entry --network-acl-id acl-5fb85d36 --ingress --rule-number 100 --protocol udp --port-range From=53,To=53 --cidr-block 0.0.0.0/0 --rule-action allow"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateNetworkAclEntry"}
{"eventName": "SharedSnapshotCopyInitiated", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Modifies the specified attribute of the specified instance.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "M-Trends Report - 2020", "link": "https://www.mandiant.com/sites/default/files/2021-09/mtrends-2020.pdf"}, {"description": "Democratic National Committee hack", "link": "https://www.politico.com/f/?id=00000168-6161-de11-af7d-ef7327ea0000"}], "researchLinks": [{"description": "Detecting exfiltration of EBS snapshots in AWS", "link": "https://twitter.com/christophetd/status/1574681313218506753"}], "securityImplications": "SharedSnapshotCopyInitiated might be a signal of an attacker copying a snapshot to their account.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot"}], "permissions": "N/A"}
{"eventName": "StopInstances", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Stops an Amazon EBS-backed instance.", "mitreAttackTactics": ["TA0040 - Impact", "TA0005 - Defense Evasion"], "mitreAttackTechniques": ["T1499 - Endpoint Denial of Service", "T1578 - Modify Cloud Compute Infrastructure"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [{"description": "Executing commands through EC2 user data", "link": "https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/"}], "securityImplications": "Attackers might use StopInstances to avoid being detected or to do changes that will be executed when the EC2 is started.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 stop-instances --instance-ids TrailDiscoverInstanceID"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.execution.ec2-user-data"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-StopInstances"}
{"eventName": "DescribeVolumesModifications", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the most recent volume modification request for the specified EBS volumes.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeVolumesModifications to track changes in EBS volumes.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-volumes-modifications --volume-ids TrailDiscoverVolumeId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeVolumesModifications"}
{"eventName": "DescribeFlowLogs", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes one or more flow logs.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeFlowLogs to review VPC flow log configurations, aiming to understand what network traffic is being logged.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-flow-logs --filter Name=resource-id,Values=TrailDiscoverResourceId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeFlowLogs"}
{"eventName": "DeleteSnapshot", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Deletes the specified snapshot.", "mitreAttackTactics": ["T1485 - Impact"], "mitreAttackTechniques": ["T1485 - Data Destruction"], "usedInWild": true, "incidents": [{"description": "Hacker Puts Hosting Service Code Spaces Out of Business", "link": "https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/"}], "researchLinks": [], "securityImplications": "Attackers might use DeleteSnapshot to erase Amazon EBS snapshots, potentially destroying backup data and hampering recovery efforts after an attack.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 delete-snapshot --snapshot-id TrailDiscoverSnapshotId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DeleteSnapshot"}
{"eventName": "DescribeVpcEndpointConnectionNotifications", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the connection notifications for VPC endpoints and VPC endpoint services.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeVpcEndpointConnectionNotifications to monitor notification configurations for VPC endpoints.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-vpc-endpoint-connection-notifications --connection-notification-id TrailDiscoverConnectionNotificationId"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeVpcEndpointConnectionNotifications"}
{"eventName": "GetFlowLogsIntegrationTemplate", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Generates a CloudFormation template that streamlines and automates the integration of VPC flow logs with Amazon Athena.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetFlowLogsIntegrationTemplate to create templates for integrating VPC flow logs with external monitoring solutions, potentially to configure exfiltration pathways for gathered data or to understand security monitoring setups.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-flow-logs-integration-template --flow-log-id fl-1234567890abcdef0 --config-delivery-s3-destination-arn arn:aws:s3:::DOC-EXAMPLE-BUCKET --integrate-services AthenaIntegrations='[{IntegrationResultS3DestinationArn=arn:aws:s3:::DOC-EXAMPLE-BUCKET,PartitionLoadFrequency=none,PartitionStartDate=2021-07-21T00:40:00,PartitionEndDate=2021-07-21T00:42:00},{IntegrationResultS3DestinationArn=arn:aws:s3:::DOC-EXAMPLE-BUCKET,PartitionLoadFrequency=none,PartitionStartDate=2021-07-21T00:40:00,PartitionEndDate=2021-07-21T00:42:00}]'"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetFlowLogsIntegrationTemplate"}
{"eventName": "GetPasswordData", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Retrieves the encrypted administrator password for a running Windows instance.", "mitreAttackTactics": ["TA0006 - Credential Access"], "mitreAttackTechniques": ["T1555 - Credentials from Password Stores"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Behind the scenes in the Expel SOC: Alert-to-fix in AWS", "link": "https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}, {"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetPasswordData to retrieve the password data for Windows instances, allowing unauthorized access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-password-data --instance-id TrailDiscoverInstanceId"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.ec2-get-password-data"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetPasswordData"}
{"eventName": "GetEbsDefaultKmsKeyId", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the default AWS KMS key for EBS encryption by default for your account in this Region.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use GetEbsDefaultKmsKeyId to identify the default AWS Key Management Service (KMS) key used for encrypting new Amazon EBS volumes.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 get-ebs-default-kms-key-id"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-GetEbsDefaultKmsKeyId"}
{"eventName": "ReplaceIamInstanceProfileAssociation", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Replaces an IAM instance profile for the specified running instance.", "mitreAttackTactics": ["TA0004 - Privilege Escalation"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}], "researchLinks": [], "securityImplications": "Attackers might use ReplaceIamInstanceProfileAssociation to replace the IAM instance profile on an instance they control with one that has higher privileges.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 replace-iam-instance-profile-association --iam-instance-profile Name=TrailDiscoverAdminRole --association-id iip-assoc-060bae234aac2e7fa"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-ReplaceIamInstanceProfileAssociation"}
{"eventName": "SendSerialConsoleSSHPublicKey", "eventSource": "ec2-instance-connect.amazonaws.com", "awsService": "EC2InstanceConnect", "description": "Pushes an SSH public key to the specified EC2 instance.", "mitreAttackTactics": ["TA0008 - Lateral Movement"], "mitreAttackTechniques": ["T1021 - Remote Services"], "usedInWild": true, "incidents": [{"description": "LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD", "link": "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud"}, {"description": "Navigating the Cloud: Exploring Lateral Movement Techniques", "link": "https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/"}], "researchLinks": [], "securityImplications": "Attackers might use SendSerialConsoleSSHPublicKey to inject unauthorized SSH keys into EC2 instances, granting them access for remote control.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/ec2-instance-connect#ec2-instance-connect-SendSerialConsoleSSHPublicKey"}
{"eventName": "DescribeSnapshotTierStatus", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the storage tier status of one or more Amazon EBS snapshots.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeSnapshotTierStatus to assess the tiering status and potential lifecycle transitions of EBS snapshots, seeking to identify snapshots that are less frequently accessed or potentially unmonitored.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-snapshot-tier-status"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeSnapshotTierStatus"}
{"eventName": "CreateImage", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Creates an Amazon EBS-backed AMI from an Amazon EBS-backed instance that is either running or stopped.", "mitreAttackTactics": ["TA0010 - Exfiltration"], "mitreAttackTechniques": ["T1537 - Transfer Data to Cloud Account"], "usedInWild": true, "incidents": [{"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [], "securityImplications": "Attackers might use CreateImage to create images from running EC2s and use them after adding their own keys", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 create-image --instance-id TrailDiscoverInstanceId --name \"TrailDiscoverImageName\" --description \"TrailDiscoverImageDescription\""}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-CreateImage"}
{"eventName": "DescribeInstances", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the specified instances or all instances.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Following attackers’ (Cloud)trail in AWS: Methodology and findings in the wild", "link": "https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/"}], "researchLinks": [{"description": "Abusing VPC Traffic Mirroring in AWS", "link": "https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/"}], "securityImplications": "Attackers might use DescribeInstances to inventory EC2 instances within an AWS environment.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-instances --instance-ids TrailDiscoverInstanceID"}, {"type": "stratusRedTeam", "value": "https://stratus-red-team.cloud/attack-techniques/AWS/aws.credential-access.ec2-steal-instance-credentials"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeInstances"}
{"eventName": "DescribeClientVpnRoutes", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Describes the routes for the specified Client VPN endpoint.", "mitreAttackTactics": ["TA0007 - Discovery"], "mitreAttackTechniques": ["T1580 - Cloud Infrastructure Discovery"], "usedInWild": true, "incidents": [{"description": "Compromised Cloud Compute Credentials: Case Studies From the Wild", "link": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab"}], "researchLinks": [], "securityImplications": "Attackers might use DescribeClientVpnRoutes to gather information about the routing configuration of an AWS Client VPN endpoint, potentially identifying routes that could be exploited for network access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "aws ec2 describe-client-vpn-routes --client-vpn-endpoint-id cvpn-endpoint-123456789123abcde"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-DescribeClientVpnRoutes"}
{"eventName": "ImportKeyPair", "eventSource": "ec2.amazonaws.com", "awsService": "EC2", "description": "Imports the public key from an RSA or ED25519 key pair that you created with a third-party tool.", "mitreAttackTactics": ["TA0003 - Persistence"], "mitreAttackTechniques": ["T1098 - Account Manipulation"], "usedInWild": true, "incidents": [{"description": "Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining", "link": "https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/"}, {"description": "Behind the scenes in the Expel SOC: Alert-to-fix in AWS", "link": "https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/"}, {"description": "When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability", "link": "https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/"}], "researchLinks": [{"description": "Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident", "link": "https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide"}], "securityImplications": "Attackers might use ImportKeyPair to upload malicious SSH keys to AWS EC2 instances, granting unauthorized access.", "alerting": [], "simulation": [{"type": "commandLine", "value": "N/A"}], "permissions": "https://aws.permissions.cloud/iam/ec2#ec2-ImportKeyPair"}
