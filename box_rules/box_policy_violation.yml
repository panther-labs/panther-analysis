AnalysisType: rule
Filename: box_policy_violation.py
RuleID: Box.Content.Workflow.Policy.Violation
DisplayName: Box Content Workflow Policy Violation
Enabled: true
LogTypes:
  - Box.Event
Tags:
  - Box
Severity: Low
Description: >
  A user violated the content workflow policy. 
Reference: https://developer.box.com/reference/resources/event/
Runbook: >
  Investigate whether the user continues to violate the policy and take measure to ensure they understand policy. 
SummaryAttributes:
  - event_type
Tests:
  -
    Name: Regular Event
    ExpectedResult: false
    Log:
      {
        "type": "event",
        "additional_details": '{"key": "value"}',
        "created_by": {
          "id": 12345678,
          "type": "user",
          "login": "cat@example",
          "name": "Bob Cat"
        },
        "event_type": "DELETE",
        "source": {
          "item_id": 123456789012,
          "item_name": "regular_file.pdf",
          "item_type": "file",
          "owned_by": {
            "id": 12345678,
            "type": "user",
            "login": "cat@example",
            "name": "Bob Cat"
          },
          "parent": {
            "id": 12345,
            "type": "folder",
            "etag": 1,
            "name": "Parent_Folder",
            "sequence_id": 2
          }
        }
      }
  -
    Name: Upload Policy Violation
    ExpectedResult: true
    Log:
      {
        "type": "event",
        "additional_details": '{"key": "value"}',
        "created_by": {
          "id": 12345678,
          "type": "user",
          "login": "cat@example",
          "name": "Bob Cat"
        },
        "event_type": "CONTENT_WORKFLOW_UPLOAD_POLICY_VIOLATION",
        "source": {
          "id": 12345678,
          "type": "user",
          "created_at": "2012-12-12T10:53:43-08:00",
          "language": "en",
          "login": "user@example",
          "max_upload_size": 88999900,
          "modified_at": "2012-12-12T10:53:43-08:00",
          "name": "Bob Cat",
          "notification_email": {
            "email": "notifications@example",
            "is_confirmed": true
          },
          "phone": 1234567890,
          "status": "active",
        }
      }
  -
    Name: Sharing Policy Violation
    ExpectedResult: true
    Log:
      {
        "type": "event",
        "additional_details": {
          "key": "value"
        },
        "created_by": {
          "id": 12345678,
          "type": "user",
          "login": "cat@example",
          "name": "Mountain Lion"
        },
        "event_type": "CONTENT_WORKFLOW_SHARING_POLICY_VIOLATION",
        "source": {
          "id": 12345678,
          "type": "user",
          "created_at": "2012-12-12T10:53:43-08:00",
          "language": "en",
          "login": "user@example",
          "max_upload_size": 88999900,
          "modified_at": "2012-12-12T10:53:43-08:00",
          "name": "Mountain Lion",
          "notification_email": {
            "email": "notifications@example",
            "is_confirmed": true
          },
          "phone": 1234567890,
          "status": "active",
        }
      }
