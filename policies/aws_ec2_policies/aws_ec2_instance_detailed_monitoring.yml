AnalysisType: policy
Description: >-
  This policy ensures that the AWS Instance has Detailed Monitoring Enabled
DisplayName: "AWS EC2 Instance Detailed Monitoring"
Enabled: true
Filename: aws_ec2_instance_detailed_monitoring.py
PolicyID: "AWS.EC2.Instance.DetailedMonitoring"
Reference: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html
Reports:
  MITRE ATT&CK:
    - TA0005:T1562
ResourceTypes:
  - AWS.EC2.Instance
Runbook: >-
  https://docs.runpanther.io/alert-runbooks/built-in-policies/aws-ec2-instance-has-detailed-monitoring-enabled
Severity: Low
Tags:
  - AWS
  - Security Control
  - Defense Evasion:Impair Defenses
  - Debug
Tests:
  - ExpectedResult: false
    Name: Detailed Monitoring Disabled
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 16
        "Name": "running"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: true
    Name: Detailed Monitoring Enabled
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "enabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 16
        "Name": "running"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: true
    Name: Instance Stopped
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 80
        "Name": "stopped"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: true
    Name: Instance Shutting Down
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 32
        "Name": "shutting-down"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: true
    Name: Instance Stopping Monitoring Disabled
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 64
        "Name": "stopping"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: true
    Name: Instance Terminated Monitoring Disabled
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 48
        "Name": "terminated"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: false
    Name: Instance Running Monitoring Disabled
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 16
        "Name": "running"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
  - ExpectedResult: false
    Name: Instance Pending Monitoring Disabled
    Resource:
      "AmiLaunchIndex": 0
      "Architecture": "x86_64"
      "BlockDeviceMappings":
        - "DeviceName": "/dev/xvda"
          "Ebs":
            "AttachTime": "2019-01-01T00:00:00Z"
            "DeleteOnTermination": true
            "Status": "attached"
            "VolumeId": "vol-0b111222333444"
      "CapacityReservationId":
      "CapacityReservationSpecification":
        "CapacityReservationPreference": "open"
        "CapacityReservationTarget":
      "ClientToken":
      "CpuOptions":
        "CoreCount": 1
        "ThreadsPerCore": 1
      "EbsOptimized": false
      "ElasticGpuAssociations":
      "ElasticInferenceAcceleratorAssociations":
      "EnaSupport": true
      "HibernationOptions":
        "Configured": false
      "Hypervisor": "xen"
      "IamInstanceProfile":
      "ImageId": "ami-11122233344555"
      "InstanceId": "i-111222333444555"
      "InstanceLifecycle":
      "InstanceType": "t2.micro"
      "KernelId":
      "KeyName": "key-1"
      "LaunchTime": "2019-01-01T00:00:00Z"
      "Licenses":
      "Monitoring":
        "State": "disabled"
      "NetworkInterfaces":
        - "Association":
            "IpOwnerId": "amazon"
            "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
            "PublicIp": "52.0.0.0"
          "Attachment":
            "AttachTime": "2019-01-01T00:00:00Z"
            "AttachmentId": "eni-attach-111222333444"
            "DeleteOnTermination": true
            "DeviceIndex": 0
            "Status": "attached"
          "Description": "Primary network interface"
          "Groups":
            - "GroupId": "sg-111222333444"
              "GroupName": "base"
          "InterfaceType": "interface"
          "Ipv6Addresses":
          "MacAddress": "de:ad:be:ef:00:00"
          "NetworkInterfaceId": "eni-111222333444"
          "OwnerId": "123456789012"
          "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
          "PrivateIpAddress": "10.0.0.0"
          "PrivateIpAddresses":
            - "Association":
                "IpOwnerId": "amazon"
                "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
                "PublicIp": "52.0.0.0"
              "Primary": true
              "PrivateDnsName": "ip-10-0-0-o.us-west-2.compute.internal"
              "PrivateIpAddress": "10.0.0.0"
          "SourceDestCheck": true
          "Status": "in-use"
          "SubnetId": "subnet-111222333444"
          "VpcId": "vpc-111222333444"
      "Placement":
        "Affinity":
        "AvailabilityZone": "us-west-2b"
        "GroupName":
        "HostId":
        "PartitionNumber":
        "SpreadDomain":
        "Tenancy": "default"
      "Platform":
      "PrivateDnsName": "ip-10-0-0-0.us-west-2.compute.internal"
      "PrivateIpAddress": "10.0.0.0"
      "ProductCodes":
      "PublicDnsName": "ec2-52-0-0-0.us-west-2.compute.amazonaws.com"
      "PublicIpAddress": "52.0.0.0"
      "RamdiskId":
      "RootDeviceName": "/dev/xvda"
      "RootDeviceType": "ebs"
      "SecurityGroups":
        - "GroupId": "sg-111222333444"
          "GroupName": "base"
      "SourceDestCheck": true
      "SpotInstanceRequestId":
      "SriovNetSupport":
      "State":
        "Code": 0
        "Name": "pending"
      "StateReason":
      "StateTransitionReason":
      "SubnetId": "subnet-111222333"
      "Tags":
        "TagOne": "True"
      "VirtualizationType": "hvm"
      "Volumes":
        - "Attachments":
            - "AttachTime": "2019-01-01T00:00:00Z"
              "DeleteOnTermination": true
              "Device": "/dev/xvda"
              "InstanceId": "i-111222333"
              "State": "attached"
              "VolumeId": "vol-111222333"
          "AvailabilityZone": "us-west-2b"
          "CreateTime": "2019-01-01T00:00:00Z"
          "Encrypted": false
          "Iops": 100
          "KmsKeyId":
          "Size": 8
          "SnapshotId": "snap-111222333444"
          "State": "in-use"
          "Tags":
            "TagOne": "True"
          "VolumeId": "vol-111222333444"
          "VolumeType": "gp2"
      "VpcId": "vpc-111222333444"
