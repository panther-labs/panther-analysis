AnalysisType: policy
Filename: aws_root_account_mfa.py
PolicyID: "AWS.RootAccount.MFA"
DisplayName: "AWS Root Account MFA"
Enabled: true
ResourceTypes:
  - AWS.IAM.RootUser
Tags:
  - AWS
  - Identity & Access Management
  - Privilege Escalation:Valid Accounts
Reports:
  CIS:
    - 1.13
  PCI:
    - 8.3
    - 8.4
  MITRE ATT&CK:
    - TA0004:T1078
Severity: Critical
Description: >
  This policy validates that Multi-Factor Authentication (MFA) is enabled for the root account. The root account has complete and unrestricted access to all AWS resources and services, making it the highest-value target for attackers. Without MFA, the root account is protected only by a password, which can be compromised through phishing, credential stuffing, keylogging, or database breaches. Enabling MFA adds a critical second layer of defense that requires physical possession of an authentication device in addition to the password. If an attacker gains access to the root account, they can create backdoor access, exfiltrate sensitive data, launch resources for cryptomining or other malicious purposes, modify security controls, and cause complete account takeover with potentially catastrophic financial and operational consequences. AWS strongly recommends enabling MFA on the root account as one of the most fundamental security controls, and it should never be used for day-to-day operations.
Runbook: |
  1. Sign in to the AWS Management Console using root account credentials at https://console.aws.amazon.com, click on your account name in the top-right corner and select "Security credentials"
  2. In the Multi-factor authentication (MFA) section, review the current status - if "Not assigned" is displayed, MFA is not enabled
  3. Click the "Assign MFA device" or "Activate MFA" button and choose your MFA device type: Virtual MFA device (authenticator app), Hardware TOTP token, or FIDO security key (hardware MFA is recommended for highest security per CIS 1.14)
  4. If using a virtual MFA device: Install an authenticator app on your mobile device, scan the QR code, and enter two consecutive MFA codes; if using hardware token: enter device serial number and two consecutive codes; if using FIDO security key: insert the key and follow browser prompts
  5. Click "Assign MFA" or "Add MFA" to complete the configuration and verify the MFA device is listed as "Assigned" in the Security credentials page
  6. Test the MFA setup by signing out and signing back in - you should be prompted for an MFA code after entering your password
  7. Store the root account password and MFA device in separate secure locations (e.g., password in a password manager, MFA device in a physical safe) to prevent simultaneous compromise
  8. Document the MFA device type, serial number (if applicable), and storage location in your security documentation
  9. Set up account recovery options in case MFA device is lost by storing recovery codes or contact information in a secure, separate location
  10. Consider implementing AWS Organizations Service Control Policies (SCPs) to monitor root account console logins and establish a process for regular verification that root account MFA remains enabled
Reference: https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
Tests:
  - Name: MFA Enabled
    ExpectedResult: true
    Resource:
      {
        "ARN": "arn:aws:iam::123456789012:root",
        "CreateDate": "2019-01-01T00:00:00Z",
        "CredentialReport":
          {
            "ARN": "arn:aws:iam::123456789012:root",
            "AccessKey1Active": false,
            "AccessKey1LastRotated": "0001-01-01T00:00:00Z",
            "AccessKey1LastUsedDate": "0001-01-01T00:00:00Z",
            "AccessKey1LastUsedRegion": "N/A",
            "AccessKey1LastUsedService": "N/A",
            "AccessKey2Active": false,
            "AccessKey2LastRotated": "0001-01-01T00:00:00Z",
            "AccessKey2LastUsedDate": "0001-01-01T00:00:00Z",
            "AccessKey2LastUsedRegion": "N/A",
            "AccessKey2LastUsedService": "N/A",
            "Cert1Active": false,
            "Cert1LastRotated": "0001-01-01T00:00:00Z",
            "Cert2Active": false,
            "Cert2LastRotated": "0001-01-01T00:00:00Z",
            "MfaActive": true,
            "PasswordEnabled": false,
            "PasswordLastChanged": "0001-01-01T00:00:00Z",
            "PasswordLastUsed": "2019-01-01T00:00:00Z",
            "PasswordNextRotation": "0001-01-01T00:00:00Z",
            "UserCreationTime": "2019-01-01T00:00:00Z",
            "UserName": "<root_account>",
          },
        "UserID": null,
        "UserName": "root",
        "VirtualMFA": null,
      }
  - Name: MFA Not Enabled
    ExpectedResult: false
    Resource:
      {
        "ARN": "arn:aws:iam::123456789012:root",
        "CreateDate": "2019-01-01T00:00:00Z",
        "CredentialReport":
          {
            "ARN": "arn:aws:iam::123456789012:root",
            "AccessKey1Active": false,
            "AccessKey1LastRotated": "0001-01-01T00:00:00Z",
            "AccessKey1LastUsedDate": "0001-01-01T00:00:00Z",
            "AccessKey1LastUsedRegion": "N/A",
            "AccessKey1LastUsedService": "N/A",
            "AccessKey2Active": false,
            "AccessKey2LastRotated": "0001-01-01T00:00:00Z",
            "AccessKey2LastUsedDate": "0001-01-01T00:00:00Z",
            "AccessKey2LastUsedRegion": "N/A",
            "AccessKey2LastUsedService": "N/A",
            "Cert1Active": false,
            "Cert1LastRotated": "0001-01-01T00:00:00Z",
            "Cert2Active": false,
            "Cert2LastRotated": "0001-01-01T00:00:00Z",
            "MfaActive": false,
            "PasswordEnabled": false,
            "PasswordLastChanged": "0001-01-01T00:00:00Z",
            "PasswordLastUsed": "2019-01-01T00:00:00Z",
            "PasswordNextRotation": "0001-01-01T00:00:00Z",
            "UserCreationTime": "2019-01-01T00:00:00Z",
            "UserName": "<root_account>",
          },
        "UserID": null,
        "UserName": "root",
        "VirtualMFA": null,
      }
