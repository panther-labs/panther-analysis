AnalysisType: policy
Description: >-
  This Policy ensures that all IAM groups have at least one IAM user. If they are
  vacant, they should be deleted.
DisplayName: "AWS IAM Group Users"
Enabled: true
Filename: aws_iam_group_users.py
PolicyID: "AWS.IAM.Group.Users"
Reference: https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
Reports:
  MITRE ATT&CK:
    - TA0004:T1078
ResourceTypes:
  - AWS.IAM.Group
Runbook: >-
  https://docs.runpanther.io/alert-runbooks/built-in-policies/aws-iam-group-has-users
Severity: Low
Tags:
  - AWS
  - Identity & Access Management
  - Privilege Escalation:Valid Accounts
Tests:
  - ExpectedResult: false
    Name: Group Has No Users
    Resource:
      "Arn": "arn:aws:iam::123456789012:group/ExampleGroup"
      "CreateDate": "2019-01-01T00:00:00Z"
      "GroupId": "ABCDEFGHIJKLMNOP"
      "GroupName": "ExampleGroup"
      "Path": "/"
      "Users":
  - ExpectedResult: true
    Name: Group Has Users
    Resource:
      "Arn": "arn:aws:iam::123456789012:group/ExampleGroup"
      "CreateDate": "2019-01-01T00:00:00Z"
      "GroupId": "ABCDEFGHIJKLMNOP"
      "GroupName": "ExampleGroup"
      "Path": "/"
      "Users":
        - "Arn": "arn:aws:iam::123456789012:user/Bobert"
          "CreateDate": "2019-01-1T00:00:00Z"
          "PasswordLastUsed":
          "Path": "/"
          "PermissionsBoundary":
          "Tags":
          "UserId": "ABCDEFGHIJKLMNOP"
          "UserName": "Bobert"
