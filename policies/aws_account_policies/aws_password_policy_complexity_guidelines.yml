AnalysisType: policy
Description: >-
  This policy validates that the account password policy enforces the recommended
  password complexity requirements.
DisplayName: "AWS Password Policy Complexity Guidelines"
Enabled: true
Filename: aws_password_policy_complexity_guidelines.py
PolicyID: "AWS.PasswordPolicy.ComplexityGuidelines"
Reference: https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
Reports:
  CIS:
    - 1.5
    - 1.6
    - 1.7
    - 1.8
    - 1.9
  MITRE ATT&CK:
    - TA0006:T1110
  PCI:
    - 8.2.3
ResourceTypes:
  - AWS.PasswordPolicy
Runbook: >-
  https://docs.runpanther.io/alert-runbooks/built-in-policies/aws-account-password-policy-enforces-complexity-guidelines
Severity: High
Tags:
  - AWS
  - Identity & Access Management
  - Credential Access:Brute Force
  - Configuration Required
Tests:
  - ExpectedResult: false
    Name: Password Policy Does Not Require Lowercase Characters
    Resource:
      "AllowUsersToChangePassword": false
      "AnyExist": true
      "ExpirePasswords": true
      "HardExpiry": false
      "MaxPasswordAge": 90
      "MinimumPasswordLength": 14
      "PasswordReusePrevention": 24
      "RequireLowercaseCharacters": false
      "RequireNumbers": true
      "RequireSymbols": true
      "RequireUppercaseCharacters": true
  - ExpectedResult: false
    Name: Password Policy Does Not Require Numbers
    Resource:
      "AllowUsersToChangePassword": false
      "AnyExist": true
      "ExpirePasswords": true
      "HardExpiry": false
      "MaxPasswordAge": 90
      "MinimumPasswordLength": 14
      "PasswordReusePrevention": 24
      "RequireLowercaseCharacters": true
      "RequireNumbers": false
      "RequireSymbols": true
      "RequireUppercaseCharacters": true
  - ExpectedResult: false
    Name: Password Policy Does Not Require Symbols
    Resource:
      "AllowUsersToChangePassword": false
      "AnyExist": true
      "ExpirePasswords": true
      "HardExpiry": false
      "MaxPasswordAge": 90
      "MinimumPasswordLength": 14
      "PasswordReusePrevention": 24
      "RequireLowercaseCharacters": true
      "RequireNumbers": true
      "RequireSymbols": false
      "RequireUppercaseCharacters": true
  - ExpectedResult: false
    Name: Password Policy Does Not Require Uppercase Characters
    Resource:
      "AllowUsersToChangePassword": false
      "AnyExist": true
      "ExpirePasswords": true
      "HardExpiry": false
      "MaxPasswordAge": 90
      "MinimumPasswordLength": 14
      "PasswordReusePrevention": 24
      "RequireLowercaseCharacters": true
      "RequireNumbers": true
      "RequireSymbols": true
      "RequireUppercaseCharacters": false
  - ExpectedResult: false
    Name: Password Policy Enforces Insufficient Password Length
    Resource:
      "AllowUsersToChangePassword": false
      "AnyExist": true
      "ExpirePasswords": true
      "HardExpiry": false
      "MaxPasswordAge": 90
      "MinimumPasswordLength": 8
      "PasswordReusePrevention": 24
      "RequireLowercaseCharacters": true
      "RequireNumbers": true
      "RequireSymbols": true
      "RequireUppercaseCharacters": true
  - ExpectedResult: true
    Name: Password Policy Meets All Complexity Requirements
    Resource:
      "AllowUsersToChangePassword": false
      "AnyExist": true
      "ExpirePasswords": true
      "HardExpiry": false
      "MaxPasswordAge": 90
      "MinimumPasswordLength": 14
      "PasswordReusePrevention": 24
      "RequireLowercaseCharacters": true
      "RequireNumbers": true
      "RequireSymbols": true
      "RequireUppercaseCharacters": true
