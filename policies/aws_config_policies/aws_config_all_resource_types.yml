AnalysisType: policy
Description: >-
  This policy ensurers that you have a comprehensive configuration audit in place
  for all resource types in AWS.
DisplayName: "AWS Config Records All Resource Types"
Enabled: true
Filename: aws_config_all_resource_types.py
PolicyID: "AWS.Config.RecordAllResourceTypes"
Reference: https://aws.amazon.com/blogs/mt/aws-config-best-practices/
ResourceTypes:
  - AWS.Config.Recorder
Runbook: >-
  Update AWS Config to record changes to all supported resource types.
Severity: Low
Tags:
  - AWS
  - Panther
Tests:
  - ExpectedResult: true
    Name: All Resources Supported
    Resource:
      "Name": "default"
      "RecordingGroup":
        "AllSupported": true
        "IncludeGlobalResourceTypes": true
        "ResourceTypes": []
      "Region": "us-west-2"
      "RoleARN": "arn:aws:iam::112233445566:role/role-name"
      "Status":
        "LastErrorCode":
        "LastErrorMessage":
        "LastStartTime": "2019-01-01T00:00:00Z"
        "LastStatus": "SUCCESS"
        "LastStatusChangeTime": "2019-01-01T00:00:00Z"
        "LastStopTime":
        "Name": "default"
        "Recording": true
  - ExpectedResult: false
    Name: All Resources Not Supported
    Resource:
      "Name": "default"
      "RecordingGroup":
        "AllSupported": false
        "IncludeGlobalResourceTypes": true
        "ResourceTypes": []
      "Region": "us-west-2"
      "RoleARN": "arn:aws:iam::112233445566:role/role-name"
      "Status":
        "LastErrorCode":
        "LastErrorMessage":
        "LastStartTime": "2019-01-01T00:00:00Z"
        "LastStatus": "SUCCESS"
        "LastStatusChangeTime": "2019-01-01T00:00:00Z"
        "LastStopTime":
        "Name": "default"
        "Recording": true
