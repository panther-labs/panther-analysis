AnalysisType: policy
Description: >-
  GuardDuty is a threat detection service that continuously monitors for malicious
  activity and unauthorized behavior.
DisplayName: "AWS GuardDuty Enabled"
Enabled: true
Filename: aws_guardduty_enabled.py
PolicyID: "AWS.GuardDuty.Enabled"
Reference: https://aws.amazon.com/guardduty/
Reports:
  MITRE ATT&CK:
    - TA0005:T1562
ResourceTypes:
  - AWS.GuardDuty.Detector.Meta
Runbook: >-
  https://docs.runpanther.io/alert-runbooks/built-in-policies/aws-guardduty-is-enabled
Severity: High
Tags:
  - AWS
  - Security Control
  - Defense Evasion:Impair Defenses
  - Configuration Required
Tests:
  - ExpectedResult: false
    Name: Detectors Do Not Exist
    Resource:
      "AccountId": "123456789012"
      "Detectors": []
      "Region": "global"
      "ResourceId": "123456789012::AWS.GuardDuty.Detector.Meta"
      "ResourceType": "AWS.GuardDuty.Detector.Meta"
      "Tags":
      "TimeCreated":
  - ExpectedResult: true
    Name: Detectors Exist
    Resource:
      "AccountId": "123456789012"
      "Detectors":
        - "123456789012:ap-southeast-2:AWS.GuardDuty.Detector"
        - "123456789012:eu-central-1:AWS.GuardDuty.Detector"
        - "123456789012:us-west-2:AWS.GuardDuty.Detector"
      "Region": "global"
      "ResourceId": "123456789012::AWS.GuardDuty.Detector.Meta"
      "ResourceType": "AWS.GuardDuty.Detector.Meta"
      "Tags":
      "TimeCreated":
  - ExpectedResult: false
    Name: Detectors Exist But Not in Required Regions
    Resource:
      "AccountId": "123456789012"
      "Detectors":
        - "123456789012:ap-southeast-2:AWS.GuardDuty.Detector"
        - "123456789012:eu-central-1:AWS.GuardDuty.Detector"
      "Region": "global"
      "ResourceId": "123456789012::AWS.GuardDuty.Detector.Meta"
      "ResourceType": "AWS.GuardDuty.Detector.Meta"
      "Tags":
      "TimeCreated":
