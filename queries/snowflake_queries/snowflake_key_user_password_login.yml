AnalysisType: scheduled_rule
Description: >-
  Detect when a user that has key-based authentication configured logs in with a password
DisplayName: "Snowflake user with key-based auth logged in with password auth"
Enabled: false
Filename: snowflake_key_user_password_login.py
Reports:
  MITRE ATT&CK:
    - TA0003:T1098
RuleID: "Snowflake.KeyUserPasswordLogin"
ScheduledQueries:
  - Query.Snowflake.KeyUserPasswordLogin
Severity: Medium
Tags:
  - Snowflake
  - Persistence:Account Manipulation
Tests:
  - ExpectedResult: true
    Log:
      "first_authentication_factor": "RSA_KEYPAIR"
      "name": "testuser"
    Name: Key user logged in with Password
