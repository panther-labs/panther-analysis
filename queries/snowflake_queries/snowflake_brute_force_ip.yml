AnalysisType: scheduled_rule
Description: >-
  Detect brute force attacks by monitoring for failed logins from the same IP address
DisplayName: "Snowflake Brute Force Attacks by IP"
Enabled: false
Filename: snowflake_brute_force_ip.py
Reports:
  MITRE ATT&CK:
    - TA0006:T1110
RuleID: "Snowflake.BruteForceByIp"
ScheduledQueries:
  - Query.Snowflake.FailedLogins
Severity: Medium
SummaryAttributes:
  - error_message
  - error_code
  - reported_client_type
  - user_name
Tags:
  - Snowflake
  - Credential Access:Brute Force
Tests:
  - ExpectedResult: true
    Log:
      "client_ip": "1.2.3.4"
      "count_by_ip": 100
    Name: Value Returned By Query
  - ExpectedResult: true
    Log:
      "client_ip": "1.2.3.4"
      "count_by_ip": 100
      "error_message": "JWT_TOKEN_INVALID_PUBLIC_KEY_FINGERPRINT_MISMATCH"
    Name: Common Error
Threshold: 5
