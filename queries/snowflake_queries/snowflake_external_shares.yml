AnalysisType: scheduled_rule
Description: >-
  Detect when an external share has been initiated from one source cloud to another
  target cloud.
DisplayName: "Snowflake External Share"
Enabled: false
Filename: snowflake_external_shares.py
RuleID: "Snowflake.External.Shares"
Runbook: >-
  Determine if this occurred as a result of a valid business request.
ScheduledQueries:
  - Query.Snowflake.External.Shares
Severity: Medium
Tests:
  - ExpectedResult: true
    Log:
      "bytes_transferred": 555
      "end_time": "2023-04-12 18:13:35Z"
      "source_cloud": "Amazon Web Services (AWS)"
      "source_region": "us-west-2"
      "start_time": "2023-04-12 18:12:49Z"
      "target_cloud": "Microsoft Azure"
      "target_region": "East US 2"
      "transfer_type": "COPY"
    Name: External Share Started
