AnalysisType: scheduled_rule
Description: >-
  Detect users being re-enabled in your environment
DisplayName: "Snowflake User Enabled"
Enabled: false
Filename: snowflake_user_enabled.py
Reports:
  MITRE ATT&CK:
    - TA0003:T1136
RuleID: "Snowflake.UserEnabled"
ScheduledQueries:
  - Query.Snowflake.UserEnabled
Severity: Info
Tags:
  - Snowflake
  - Persistence:Create Account
Tests:
  - ExpectedResult: true
    Log:
      "query_text": "alter user TESTUSER set disabled=false;"
    Name: Return True
  - ExpectedResult: true
    Log:
      "query_text": "alter"
      "user_name": "admin"
    Name: Unknown User
