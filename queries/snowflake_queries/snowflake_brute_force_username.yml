AnalysisType: scheduled_rule
Description: >-
  Detect brute force attacks by monitoring for failed logins by the same username
DisplayName: "Snowflake Brute Force Attacks by Username"
Enabled: false
Filename: snowflake_brute_force_username.py
Reports:
  MITRE ATT&CK:
    - TA0006:T1110
RuleID: "Snowflake.BruteForceByUsername"
ScheduledQueries:
  - Query.Snowflake.FailedLogins
Severity: Medium
SummaryAttributes:
  - client_ip
  - error_message
  - error_code
  - reported_client_type
Tags:
  - Snowflake
  - Credential Access:Brute Force
Tests:
  - ExpectedResult: true
    Log:
      "count_by_username": 100
      "error_message": "JWT_TOKEN_INVALID_PUBLIC_KEY_FINGERPRINT_MISMATCH"
      "user_name": "testuser"
    Name: Value Returned By Query
  - ExpectedResult: true
    Log:
      "count_by_username": 100
      "user_name": "testuser"
    Name: Common Error Message
Threshold: 5
