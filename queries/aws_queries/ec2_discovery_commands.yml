AnalysisType: scheduled_rule
DedupPeriodMinutes: 90
Description: >-
  Multiple different discovery commands were executed by the same EC2 instance. This
  could indicate a compromised instance.
DisplayName: "AWS EC2 Discovery Commands Executed"
Enabled: true
Filename: ec2_discovery_commands.py
Reference: 
  https://stratus-red-team.cloud/attack-techniques/AWS/aws.discovery.ec2-enumerate-from-instance/
Reports:
  MITRE ATT&CK:
    - TA0007:T1526
RuleID: "AWS.EC2.DiscoveryCommandsExecuted"
Runbook: >-
  Investigate other activity from the instance. Revoke permissions from the instance
  until the credentials have been rotated. Determine who was accessing the instance
  and monitor the account for other activity.
ScheduledQueries:
  - AWS EC2 Discovery Commands Executed
Severity: Info
Tags:
  - AWS
  - CloudTrail
  - EC2
  - Discovery
  - Cloud Service Discovery
  - Beta
