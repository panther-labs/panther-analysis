AnalysisType: scheduled_rule
Description: >-
  Detect password spraying account using a scheduled query
DisplayName: "CloudTrail Password Spraying"
Enabled: false
Filename: cloudtrail_password_spraying.py
Reports:
  MITRE ATT&CK:
    - TA0001:T1078
RuleID: "CloudTrail.Password.Spraying"
Runbook: >-
  Analyze the IP they came from, and other actions taken before/after. Check if a
  user from this ip eventually authenticated successfully.
ScheduledQueries:
  - Query.CloudTrail.Password.Spraying
Severity: Medium
Tags:
  - Initial Access:Valid Accounts
Tests:
  - ExpectedResult: true
    Log:
      "Anything": "any value"
    Name: Value Returned By Query
