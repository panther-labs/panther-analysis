AnalysisType: rule
Filename: aws_vpc_sunburst_iocs.py
RuleID: AWS.VPC.SunburstIOCs
DisplayName: VPC Flow Logs Sunburst IOCs
Enabled: true
LogTypes:
  - AWS.VPCFlow
Tags:
  - AWS
  - Security Control
Severity: Critical
Description: >
  Alerts if any-directional traffic is detected with known indicators of compromise (IOC). These IOCs indicate a potenial breach and have been associated with a sophisticated nation-state actor.
Runbook: >
  Investigate the resources communicating with the matched IP/FQDN for signs of compromise or other malicious activity. 
SummaryAttributes:
  - p_any_domain_names
  - p_any_ip_addresses
Tests:
  -
    Name: Non-matching traffic 
    ExpectedResult: false
    Log:
      {
        "dstport": 53,
        "dstaddr": "1.1.1.1",
        "srcaddr": "10.0.0.1"
      }
  -
    Name: Matching IP Indicator of Compromise
    ExpectedResult: true
    Log:
      {
        "srcaddr": "13.59.205.66",
        "dstaddr": "10.0.0.1",
      }
