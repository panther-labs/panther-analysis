import re

from panther_iocs import LOG4J_EXPLOIT_IOCS

# defining at as a constant to save on compiliation time
IOC_SEARCH = re.compile(".*" + "|".join(map(lambda x: re.escape(x), LOG4J_EXPLOIT_IOCS)), re.I)


def rule(event):
    return IOC_SEARCH.match(str(event))


def title(event):
    return f"Log4J exploit attempt detected in log source {event.get('p_log_type')}"
