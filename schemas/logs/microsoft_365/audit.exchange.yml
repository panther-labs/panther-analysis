schema: Microsoft365.Audit.Exchange
parser:
  native:
    name: Microsoft365.Audit.Exchange
description: Microsoft Exchange audit events.
referenceURL: https://docs.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema
version: 0
fields:
  - name: Id
    required: true
    description: Unique identifier of an audit record.
    type: string
  - name: RecordType
    required: true
    description: The type of operation indicated by the record. See https://docs.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema#auditlogrecordtype for details on the types of audit log records.
    type: int
  - name: CreationTime
    required: true
    description: The date and time in Coordinated Universal Time (UTC) when the user performed the activity.
    type: timestamp
    timeFormat: '%Y-%m-%dT%H:%M:%S'
    isEventTime: true
  - name: Operation
    required: true
    description: The name of the user or admin activity.
    type: string
  - name: OrganizationId
    required: true
    description: The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.
    type: string
  - name: UserType
    required: true
    description: The type of user that performed the operation. See https://docs.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema#user-type for details on the types of users.
    type: int
  - name: UserKey
    required: true
    description: An alternative ID for the user identified in the UserId property. For example, this property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange. This property may also specify the same value as the UserID property for events occurring in other services and events performed by system accounts.
    type: string
    indicators:
      - username
  - name: Workload
    description: The Office 365 service where the activity occurred.
    type: string
  - name: ResultStatus
    description: Indicates whether the action (specified in the Operation property) was successful or not. Possible values are Succeeded, PartiallySucceeded, or Failed. For Exchange admin activity, the value is either True or False.
    type: string
  - name: ObjectId
    description: For SharePoint and OneDrive for Business activity, the full path name of the file or folder accessed by the user. For Exchange admin audit logging, the name of the object that was modified by the cmdlet.
    type: string
  - name: UserId
    required: true
    description: The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. Note that records for activity performed by system accounts (such as SHAREPOINT\system or NT AUTHORITY\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the "user" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service.
    type: string
    indicators:
      - username
  - name: ClientIP
    description: The IP address of the device that was used when the activity was logged. The IP address is displayed in either an IPv4 or IPv6 address format. For some services, the value displayed in this property might be the IP address for a trusted application (for example, Office on the web apps) calling into the service on behalf of a user and not the IP address of the device used by person who performed the activity. Also, for Azure Active Directory-related events, the IP address isn't logged and the value for the ClientIP property is null.
    type: string
    indicators:
      - ip
  - name: Scope
    description: Was this event created by a hosted M365 service or an on-premises server? Possible values are online and onprem. Note that SharePoint is the only workload currently sending events from on-premises to M365.
    type: string
  - name: ModifiedObjectResolvedName
    description: This is the user friendly name of the object that was modified by the cmdlet. This is logged only if the cmdlet modifies the object.
    type: string
  - name: Parameters
    description: The name and value for all parameters that were used with the cmdlet that is identified in the Operations property.
    type: array
    element:
      type: object
      fields:
        - name: Name
          description: Name field
          type: string
        - name: Value
          description: Value field
          type: string
  - name: ModifiedProperties
    description: The property is included for admin events. The property includes the name of the property that was modified, the new value of the modified property, and the previous value of the modified object.
    type: array
    element:
      type: string
  - name: ExternalAccess
    required: true
    description: Specifies whether the cmdlet was run by a user in your organization, by Microsoft datacenter personnel or a datacenter service account, or by a delegated administrator. The value False indicates that the cmdlet was run by someone in your organization. The value True indicates that the cmdlet was run by datacenter personnel, a datacenter service account, or a delegated administrator.
    type: boolean
  - name: OriginatingServer
    description: The name of the server from which the cmdlet was executed.
    type: string
  - name: OrganizationName
    description: The name of the tenant.
    type: string
    indicators:
      - username
  - name: LogonType
    description: Indicates the type of user who accessed the mailbox and performed the operation that was logged.
    type: int
  - name: InternalLogonType
    description: Reserved for internal use.
    type: int
  - name: MailboxGuid
    description: The Exchange GUID of the mailbox that was accessed.
    type: string
  - name: MailboxOwnerUPN
    description: The email address of the person who owns the mailbox that was accessed.
    type: string
    indicators:
      - username
  - name: MailboxOwnerSid
    description: The SID of the mailbox owner.
    type: string
    indicators:
      - username
  - name: MailboxOwnerMasterAccountSid
    description: Mailbox owner account's master account SID.
    type: string
    indicators:
      - username
  - name: LogonUserSid
    description: The SID of the user who performed the operation.
    type: string
    indicators:
      - username
  - name: LogonUserDisplayName
    description: The user-friendly name of the user who performed the operation.
    type: string
  - name: ClientInfoString
    description: Information about the email client that was used to perform the operation, such as a browser version, Outlook version, and mobile device information.
    type: string
  - name: ClientIPAddress
    description: The IP address of the device that was used when the operation was logged. The IP address is displayed in either an IPv4 or IPv6 address format.
    type: string
    indicators:
      - ip
  - name: ClientMachineName
    description: The machine name that hosts the Outlook client.
    type: string
    indicators:
      - hostname
  - name: ClientProcessName
    description: The email client that was used to access the mailbox.
    type: string
  - name: ClientVersion
    description: The version of the email client.
    type: string
  - name: Folder
    description: The folder where a group of items is located.
    type: object
    fields:
      - name: Id
        description: The store ID of the folder object.
        type: string
      - name: Path
        description: The name of the mailbox folder where the message that was accessed is located.
        type: string
      - name: FolderItems
        description: FolderItems field
        type: json
  - name: CrossMailboxOperations
    description: Indicates if the operation involved more than one mailbox.
    type: boolean
  - name: DestMailboxId
    description: Set only if the CrossMailboxOperations parameter is True. Specifies the target mailbox GUID.
    type: string
  - name: DestMailboxOwnerUPN
    description: Set only if the CrossMailboxOperations parameter is True. Specifies the UPN of the owner of the target mailbox.
    type: string
  - name: DestMailboxOwnerSid
    description: Set only if the CrossMailboxOperations parameter is True. Specifies the SID of the target mailbox.
    type: string
  - name: DestMailboxOwnerMasterAccountSid
    description: Set only if the CrossMailboxOperations parameter is True. Specifies the SID for the master account SID of the target mailbox owner.
    type: string
    indicators:
      - username
  - name: DestFolder
    description: The destination folder, for operations such as Move.
    type: object
    fields:
      - name: Id
        description: The store ID of the folder object.
        type: string
      - name: Path
        description: The name of the mailbox folder where the message that was accessed is located.
        type: string
      - name: FolderItems
        description: FolderItems field
        type: json
  - name: Folders
    description: Information about the source folders involved in an operation; for example, if folders are selected and then deleted.
    type: array
    element:
      type: object
      fields:
        - name: Id
          description: The store ID of the folder object.
          type: string
        - name: Path
          description: The name of the mailbox folder where the message that was accessed is located.
          type: string
        - name: FolderItems
          description: FolderItems field
          type: json
  - name: AffectedItems
    description: Information about each item in the group.
    type: array
    element:
      type: object
      fields:
        - name: Id
          description: The store ID.
          type: string
        - name: Subject
          description: The subject line of the message that was accessed.
          type: string
        - name: ParentFolder
          description: The name of the folder where the item is located.
          type: object
          fields:
            - name: Id
              description: The store ID of the folder object.
              type: string
            - name: Path
              description: The name of the mailbox folder where the message that was accessed is located.
              type: string
            - name: FolderItems
              description: FolderItems field
              type: json
        - name: Attachments
          description: A list of the names and file size of all items that are attached to the message.
          type: string
  - name: SendAsUserSmtp
    description: SMTP address of the user who is being impersonated.
    type: string
    indicators:
      - hostname
  - name: SendAsUserMailboxGuid
    description: The Exchange GUID of the mailbox that was accessed to send email as.
    type: string
  - name: SendOnBehalfOfUserSmtp
    description: SMTP address of the user on whose behalf the email is sent.
    type: string
    indicators:
      - hostname
  - name: SendOnBehalfOfUserMailboxGuid
    description: The Exchange GUID of the mailbox that was accessed to send mail on behalf of.
    type: string
