# Copyright (C) 2020 Panther Labs Inc
#
# Panther Enterprise is licensed under the terms of a commercial license available from
# Panther Labs Inc ("Panther Commercial License") by contacting contact@runpanther.com.
# All use, distribution, and/or modification of this software, whether commercial or non-commercial,
# falls under the Panther Commercial License to the extent it is permitted.

---
name: OktaSystemLogs
logType: Okta.SystemLog
input: |
  {
      "version": "0",
      "severity": "INFO",
      "client": {
          "zone": "OFF_NETWORK",
          "device": "Unknown",
          "userAgent": {
          "os": "Unknown",
          "browser": "UNKNOWN",
          "rawUserAgent": "UNKNOWN-DOWNLOAD"
          },
          "ipAddress": "1.1.1.1"
      },
      "actor": {
          "id": "00u1qw1mqitPHM8AJ0g7",
          "type": "User",
          "alternateId": "admin@tc1-trexcloud.com",
          "displayName": "John Fung"
      },
      "outcome": {
          "result": "SUCCESS"
      },
      "uuid": "f790999f-fe87-467a-9880-6982a583986c",
      "published": "2017-09-30T22:23:07.777Z",
      "eventType": "user.session.start",
      "displayMessage": "User login to Okta",
      "transaction": {
          "type": "WEB",
          "id": "V04Oy4ubUOc5UuG6s9DyNQAABtc"
      },
      "debugContext": {
          "debugData": {
          "requestUri": "/login/do-login"
          }
      },
      "legacyEventType": "core.user_auth.login_success",
      "authenticationContext": {
          "authenticationStep": 0,
          "externalSessionId": "1013FfF-DKQSvCI4RVXChzX-w"
      }
  }
result: |
  {
      "version": "0",
      "severity": "INFO",
      "client": {
          "zone": "OFF_NETWORK",
          "device": "Unknown",
          "userAgent": {
          "os": "Unknown",
          "browser": "UNKNOWN",
          "rawUserAgent": "UNKNOWN-DOWNLOAD"
          },
          "ipAddress": "1.1.1.1"
      },
      "actor": {
          "id": "00u1qw1mqitPHM8AJ0g7",
          "type": "User",
          "alternateId": "admin@tc1-trexcloud.com",
          "displayName": "John Fung"
      },
      "outcome": {
          "result": "SUCCESS"
      },
      "uuid": "f790999f-fe87-467a-9880-6982a583986c",
      "published": "2017-09-30T22:23:07.777Z",
      "eventType": "user.session.start",
      "displayMessage": "User login to Okta",
      "transaction": {
          "type": "WEB",
          "id": "V04Oy4ubUOc5UuG6s9DyNQAABtc"
      },
      "debugContext": {
          "debugData": {
          "requestUri": "/login/do-login"
          }
      },
      "legacyEventType": "core.user_auth.login_success",
      "authenticationContext": {
          "authenticationStep": 0,
          "externalSessionId": "1013FfF-DKQSvCI4RVXChzX-w"
      },
      "p_any_ip_addresses": ["1.1.1.1"],
      "p_any_emails": ["admin@tc1-trexcloud.com"],
      "p_log_type": "Okta.SystemLog",
      "p_event_time": "2017-09-30T22:23:07.777Z"
  }
