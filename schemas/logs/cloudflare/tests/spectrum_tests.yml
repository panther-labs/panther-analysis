---
name: spectrum
logType: Cloudflare.Spectrum
input: |
  {
      "Application": "app-123",
      "ClientASN": 123,
      "ClientBytes": 1024,
      "ClientCountry": "Greece",
      "ClientIP": "127.127.127.127",
      "ClientMatchedIpFirewall": "ALLOW",
      "ClientPort": 1040,
      "ClientProto": "tcp",
      "ClientTcpRtt": 200000,
      "ClientTlsCipher": "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
      "ClientTlsClientHelloServerName": "hello-server-name",
      "ClientTlsProtocol": "TLS 1.3",
      "ClientTlsStatus": "OK",
      "ColoCode": "IATA-123",
      "ConnectTimestamp": "2020-08-07T07:52:09Z",
      "DisconnectTimestamp": "2020-08-07T07:52:09Z",
      "Event": "connect",
      "IpFirewall": true,
      "OriginBytes": 512,
      "OriginIP": "128.128.128.128",
      "OriginPort": 443,
      "OriginProto": "tcp",
      "OriginTcpRtt": 100000,
      "OriginTlsCipher": "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
      "OriginTlsFingerprint": "tls-fingerprint",
      "OriginTlsMode": "unknown",
      "OriginTlsProtocol": "SSLv3",
      "OriginTlsStatus": "KEYLESS_RPC",
      "ProxyProtocol": "simple",
      "Status": 123,
      "Timestamp": 1600368586194526741
  }
result: |
  {
      "Application": "app-123",
      "ClientASN": 123,
      "ClientBytes": 1024,
      "ClientCountry": "Greece",
      "ClientIP": "127.127.127.127",
      "ClientMatchedIpFirewall": "ALLOW",
      "ClientPort": 1040,
      "ClientProto": "tcp",
      "ClientTcpRtt": 200000,
      "ClientTlsCipher": "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
      "ClientTlsClientHelloServerName": "hello-server-name",
      "ClientTlsProtocol": "TLS 1.3",
      "ClientTlsStatus": "OK",
      "ColoCode": "IATA-123",
      "ConnectTimestamp": "2020-08-07T07:52:09Z",
      "DisconnectTimestamp": "2020-08-07T07:52:09Z",
      "Event": "connect",
      "IpFirewall": true,
      "OriginBytes": 512,
      "OriginIP": "128.128.128.128",
      "OriginPort": 443,
      "OriginProto": "tcp",
      "OriginTcpRtt": 100000,
      "OriginTlsCipher": "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
      "OriginTlsFingerprint": "tls-fingerprint",
      "OriginTlsMode": "unknown",
      "OriginTlsProtocol": "SSLv3",
      "OriginTlsStatus": "KEYLESS_RPC",
      "ProxyProtocol": "simple",
      "Status": 123,
      "Timestamp": "2020-09-17T18:49:46Z",

  	"p_log_type": "Cloudflare.Spectrum",
  	"p_event_time":"2020-09-17T18:49:46.194526741Z",
  	"p_any_ip_addresses": ["127.127.127.127", "128.128.128.128"]
  }
---
name: spectrum required fields only
logType: Cloudflare.Spectrum
input: |
  {
    "Timestamp": "2020-09-17T18:00:00Z"
  }
result: |
  {
    "Timestamp": "2020-09-17T18:00:00Z",
    "p_log_type": "Cloudflare.Spectrum",
    "p_event_time":"2020-09-17T18:00:00Z"
  }
