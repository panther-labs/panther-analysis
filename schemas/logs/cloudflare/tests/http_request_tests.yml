---
name: http_request
logType: Cloudflare.HttpRequest
input: |
  {
    "BotScore":10,
  	"BotScoreSrc":"Heuristics",
  	"CacheCacheStatus":"hit",
  	"CacheResponseBytes": 1024,
  	"CacheResponseStatus": 200,
  	"CacheTieredFill":true,
  	"ClientASN": 123,
  	"ClientCountry":"Greece",
  	"ClientDeviceType":"mobile",
  	"ClientIP": "127.0.0.1",
  	"ClientIPClass": "clean",
  	"ClientRequestBytes": 2048,
  	"ClientRequestHost": "example.com",
  	"ClientRequestMethod": "POST",
  	"ClientRequestPath": "/path",
  	"ClientRequestProtocol": "HTTP 1.1",
  	"ClientRequestReferer": "example.com",
  	"ClientRequestURI": "/",
  	"ClientRequestUserAgent": "firefox",
  	"ClientSSLProtocol": "TLS 1.3",
  	"ClientSrcPort": 12800,
  	"ClientXRequestedWith": "XMLHttpRequest",
  	"EdgeColoCode": "9F",
  	"EdgeColoID": 123,
  	"EdgeEndTimestamp": "2020-08-07T07:52:09Z",
  	"EdgePathingOp": "unknown",
  	"EdgePathingSrc": "unknown",
  	"EdgePathingStatus": "unknown",
  	"EdgeRateLimitAction":"",
  	"EdgeRateLimitID": "rule-id",
  	"EdgeRequestHost": "example-edge.com",
  	"EdgeResponseBytes":1024,
  	"EdgeResponseCompressionRatio": 0.3,
  	"EdgeResponseContentType": "application/json",
  	"EdgeResponseStatus":200,
  	"EdgeServerIP": "127.127.127.127",
  	"EdgeStartTimestamp": 1600365600,
  	"FirewallMatchesActions": ["jschallengeFailed", "jschallengeBypassed"],
  	"FirewallMatchesRuleIDs": ["rule1", "rule2"],
  	"FirewallMatchesSources": ["sanitycheck","protect"],
  	"OriginIP": "128.128.128.128",
  	"OriginResponseBytes":512,
  	"OriginResponseHTTPExpires": "Fri, 21 Oct 2016 07:28:00 GMT",
  	"OriginResponseHTTPLastModified": "Fri, 21 Oct 2016 07:28:00 GMT",
  	"OriginResponseStatus": 200,
  	"OriginResponseTime": 1000000,
  	"OriginSSLProtocol": "TLS 1.3",
  	"ParentRayID": "parent-ray-id",
  	"RayID": "ray-id",
  	"SecurityLevel": "high",
  	"WAFAction": "none",
  	"WAFFlags": "simulate (0x1) | null",
  	"WAFMatchedVar": "some-variable",
  	"WAFProfile": "low",
  	"WAFRuleID": "waf-rule-id",
  	"WAFRuleMessage": "waf-rule-message",
  	"WorkerCPUTime": 1000000,
  	"WorkerStatus": "OK",
  	"WorkerSubrequest": true,
  	"WorkerSubrequestCount": 10,
  	"ZoneID": 123
  }
result: |
  {
  	"BotScore":10,
  	"BotScoreSrc":"Heuristics",
  	"CacheCacheStatus":"hit",
  	"CacheResponseBytes": 1024,
  	"CacheResponseStatus": 200,
  	"CacheTieredFill":true,
  	"ClientASN": 123,
  	"ClientCountry":"Greece",
  	"ClientDeviceType":"mobile",
  	"ClientIP": "127.0.0.1",
  	"ClientIPClass": "clean",
  	"ClientRequestBytes": 2048,
  	"ClientRequestHost": "example.com",
  	"ClientRequestMethod": "POST",
  	"ClientRequestPath": "/path",
  	"ClientRequestProtocol": "HTTP 1.1",
  	"ClientRequestReferer": "example.com",
  	"ClientRequestURI": "/",
  	"ClientRequestUserAgent": "firefox",
  	"ClientSSLProtocol": "TLS 1.3",
  	"ClientSrcPort": 12800,
  	"ClientXRequestedWith": "XMLHttpRequest",
  	"EdgeColoCode": "9F",
  	"EdgeColoID": 123,
  	"EdgeEndTimestamp": "2020-08-07T07:52:09Z",
  	"EdgePathingOp": "unknown",
  	"EdgePathingSrc": "unknown",
  	"EdgePathingStatus": "unknown",
  	"EdgeRateLimitAction":"",
  	"EdgeRateLimitID": "rule-id",
  	"EdgeRequestHost": "example-edge.com",
  	"EdgeResponseBytes":1024,
  	"EdgeResponseCompressionRatio": 0.3,
  	"EdgeResponseContentType": "application/json",
  	"EdgeResponseStatus":200,
  	"EdgeServerIP": "127.127.127.127",
  	"EdgeStartTimestamp": "2020-09-17T18:00:00Z",
  	"FirewallMatchesActions": ["jschallengeFailed", "jschallengeBypassed"],
  	"FirewallMatchesRuleIDs": ["rule1", "rule2"],
  	"FirewallMatchesSources": ["sanitycheck","protect"],
  	"OriginIP": "128.128.128.128",
  	"OriginResponseBytes":512,
  	"OriginResponseHTTPExpires": "Fri, 21 Oct 2016 07:28:00 GMT",
  	"OriginResponseHTTPLastModified": "Fri, 21 Oct 2016 07:28:00 GMT",
  	"OriginResponseStatus": 200,
  	"OriginResponseTime": 1000000,
  	"OriginSSLProtocol": "TLS 1.3",
  	"ParentRayID": "parent-ray-id",
  	"RayID": "ray-id",
  	"SecurityLevel": "high",
  	"WAFAction": "none",
  	"WAFFlags": "simulate (0x1) | null",
  	"WAFMatchedVar": "some-variable",
  	"WAFProfile": "low",
  	"WAFRuleID": "waf-rule-id",
  	"WAFRuleMessage": "waf-rule-message",
  	"WorkerCPUTime": 1000000,
  	"WorkerStatus": "OK",
  	"WorkerSubrequest": true,
  	"WorkerSubrequestCount": 10,
  	"ZoneID": 123,

  	"p_log_type": "Cloudflare.HttpRequest",
  	"p_event_time":"2020-09-17T18:00:00Z",
  	"p_any_domain_names": ["example-edge.com", "example.com"],
  	"p_any_ip_addresses": ["127.0.0.1", "127.127.127.127", "128.128.128.128"],
  	"p_any_trace_ids": ["parent-ray-id", "ray-id"]
  }
---
name: httprequest required fields only
logType: Cloudflare.HttpRequest
input: |
  {
    "EdgeStartTimestamp": "2020-09-17T18:00:00Z"
  }
result: |
  {
    "EdgeStartTimestamp": "2020-09-17T18:00:00Z",
    "p_log_type": "Cloudflare.HttpRequest",
    "p_event_time":"2020-09-17T18:00:00Z"
  }
