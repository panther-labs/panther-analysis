name: alertdetails
logType: Lacework.AlertDetails
input: |
  {
    "END_TIME":"Thu, 22 Apr 2021 07:00:00 -0700",
    "START_TIME":"Thu, 22 Apr 2021 06:00:00 -0700",
    "EVENT_ACTOR":"Compliance",
    "EVENT_ID":12462,
    "EVENT_MODEL":"AwsCompliance",
    "EVENT_TYPE":"NewViolations",
    "ENTITY_MAP":{
      "NewViolation":[
        {
          "KEY":{
            "reason":"LBShouldHaveAccessLogsEnabled",
            "reason_id":"LW_AWS_NETWORKING_49_LBShouldHaveAccessLogsEnabled",
            "rec_id":"LW_AWS_NETWORKING_49",
            "resource":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s"
          },
          "PROPS":{
            "provider":"AWS"
          }
        },
        {
          "KEY":{
            "reason":"LBShouldHaveAccessLogsEnabled",
            "reason_id":"LW_AWS_NETWORKING_49_LBShouldHaveAccessLogsEnabled",
            "rec_id":"LW_AWS_NETWORKING_49",
            "resource":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s-2"
          },
          "PROPS":{
            "provider":"AWS"
          }
        }],
    "RecId":[
      {
        "KEY":{
          "eval_guid":"9f9de06d4ad244c489f8fffe0f0db05d",
          "rec_id":"LW_AWS_NETWORKING_49"
        },
        "PROPS":{
          "account_alias":"guild-staging",
          "account_id":"221203628080",
          "eval_type":"LW_SA",
          "title":"Load Balancers should have Access Logs enabled"
        }
      }],
    "Resource":[
      {
        "KEY":{
          "name":"loadBalancer",
          "value":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/077dac4e"
        }
      },{
        "KEY":{
          "name":"loadBalancer",
          "value":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s"
        }
      }],
    "ViolationReason":[
      {
        "KEY":{
          "reason":"LBShouldHaveAccessLogsEnabled",
          "reason_id":"LW_AWS_NETWORKING_49_LBShouldHaveAccessLogsEnabled",
          "rec_id":"LW_AWS_NETWORKING_49"
        },
        "PROPS":{
          "provider":"AWS"
        }
      }]
    }
  }
result: |
  {
    "END_TIME":"Thu, 22 Apr 2021 07:00:00 -0700",
    "START_TIME":"Thu, 22 Apr 2021 06:00:00 -0700",
    "EVENT_ACTOR":"Compliance",
    "EVENT_ID":12462,
    "EVENT_MODEL":"AwsCompliance",
    "EVENT_TYPE":"NewViolations",
    "ENTITY_MAP":{
      "NewViolation":[
        {
          "KEY":{
            "reason":"LBShouldHaveAccessLogsEnabled",
            "reason_id":"LW_AWS_NETWORKING_49_LBShouldHaveAccessLogsEnabled",
            "rec_id":"LW_AWS_NETWORKING_49",
            "resource":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s"
          },
          "PROPS":{
            "provider":"AWS"
          }
        },
        {
          "KEY":{
            "reason":"LBShouldHaveAccessLogsEnabled",
            "reason_id":"LW_AWS_NETWORKING_49_LBShouldHaveAccessLogsEnabled",
            "rec_id":"LW_AWS_NETWORKING_49",
            "resource":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s-2"
          },
          "PROPS":{
            "provider":"AWS"
          }
        }],
    "RecId":[
      {
        "KEY":{
          "eval_guid":"9f9de06d4ad244c489f8fffe0f0db05d",
          "rec_id":"LW_AWS_NETWORKING_49"
        },
        "PROPS":{
          "account_alias":"guild-staging",
          "account_id":"221203628080",
          "eval_type":"LW_SA",
          "title":"Load Balancers should have Access Logs enabled"
        }
      }],
    "Resource":[
      {
        "KEY":{
          "name":"loadBalancer",
          "value":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/077dac4e"
        }
      },{
        "KEY":{
          "name":"loadBalancer",
          "value":"arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s"
        }
      }],
    "ViolationReason":[
      {
        "KEY":{
          "reason":"LBShouldHaveAccessLogsEnabled",
          "reason_id":"LW_AWS_NETWORKING_49_LBShouldHaveAccessLogsEnabled",
          "rec_id":"LW_AWS_NETWORKING_49"
        },
        "PROPS":{
          "provider":"AWS"
        }
      }]
    },
  "p_log_type": "Lacework.AlertDetails",
  "p_event_time": "2021-04-22T14:00:00Z",
  "p_any_aws_account_ids":["123456789012"],
  "p_any_aws_arns": [
    "arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/077dac4e",
    "arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s",
    "arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/k8s-2"]
  }
