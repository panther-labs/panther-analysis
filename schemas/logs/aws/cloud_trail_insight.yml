schema: AWS.CloudTrailInsight
parser:
  native:
    name: AWS.CloudTrailInsight
description: AWSCloudTrailInsight represents the content of a CloudTrail Insight event record S3 object.
referenceURL: https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference.html
version: 0
fields:
  - name: eventVersion
    required: true
    description: The version of the log event format.
    type: string
  - name: eventTime
    required: true
    description: The date and time the request was made, in coordinated universal time (UTC).
    type: timestamp
    timeFormat: rfc3339
    isEventTime: true
  - name: awsRegion
    required: true
    description: The AWS region that the request was made to, such as us-east-2.
    type: string
  - name: eventId
    required: true
    description: GUID generated by CloudTrail to uniquely identify each event. You can use this value to identify a single event. For example, you can use the ID as a primary key to retrieve log data from a searchable database.
    type: string
  - name: eventType
    required: true
    description: "Identifies the type of event that generated the event record. This can be the one of the following values: AwsApiCall, AwsServiceEvent, AwsConsoleSignIn"
    type: string
  - name: recipientAccountId
    description: Represents the account ID that received this event. The recipientAccountID may be different from the CloudTrail userIdentity Element accountId. This can occur in cross-account resource access.
    type: string
    indicators:
      - aws_account_id
  - name: sharedEventId
    required: true
    description: A GUID that is generated by CloudTrail Insights to uniquely identify an Insights event. sharedEventID is common between the start and the end Insights events.
    type: string
    indicators:
      - trace_id
  - name: insightDetails
    required: true
    description: Shows information about the underlying triggers of an Insights event, such as event source, statistics, API name, and whether the event is the start or end of the Insights event.
    type: object
    fields:
      - name: state
        required: true
        description: Shows whether the event represents the start or end of the insight (the start or end of unusual activity). Values are Start or End.
        type: string
      - name: eventSource
        required: true
        description: The AWS API for which unusual activity was detected.
        type: string
      - name: eventName
        required: true
        description: The AWS API for which unusual activity was detected.
        type: string
      - name: insightType
        required: true
        description: The type of Insights event. Value is ApiCallRateInsight.
        type: string
      - name: insightContext
        description: Data about the rate of calls that triggered the Insights event compared to the normal rate of calls to the subject API per minute.
        type: object
        fields:
          - name: statistics
            description: A container for data about the typical average rate of calls to the subject API by an account, the rate of calls that triggered the Insights event, and the duration, in minutes, of the Insights event.
            type: object
            fields:
              - name: baseline
                description: Shows the typical average rate of calls to the subject API by an account within a specific AWS Region.
                type: object
                fields:
                  - name: average
                    description: Average value for the insight metric
                    type: float
              - name: insight
                description: Shows the unusual rate of calls to the subject API that triggers the logging of an Insights event.
                type: object
                fields:
                  - name: average
                    description: Average value for the insight metric
                    type: float
              - name: insightDuration
                description: The duration, in minutes, of an Insights event (the time period from the start to the end of unusual activity on the subject API). insightDuration only occurs in end Insights events.
                type: float
  - name: eventCategory
    required: true
    description: Shows the event category that is used in LookupEvents calls. In Insights events, the value is insight.
    type: string
