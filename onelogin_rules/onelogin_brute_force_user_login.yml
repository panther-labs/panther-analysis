AnalysisType: rule
Filename: onelogin_brute_force_user_login.py
RuleID: OneLogin.BruteForceUserLogin
DisplayName: OneLogin Brute Force User Login
Enabled: true
LogTypes:
  - OneLogin.Events
Tags:
  - OneLogin
Severity: Medium
Reports:
  MITRE ATT&CK:
    - Brute Force:Password Guessing
    - Brute Force:Password Spraying
Description: A OneLogin user was denied access more times than the configured threshold.
Threshold: 10
DedupPeriodMinutes: 10
Reference: https://developers.onelogin.com/api-docs/1/events/event-resource
Runbook: Analyze the IP they came from, and other actions taken before/after.
Tests:
  -
    Name: Normal Login Event
    LogType: OneLogin.Events
    ExpectedResult: false
    Log:
      {
        'event_type_id': 8,
        'actor_user_id': 123456,
        'actor_user_name': 'Bob Cat',
        'user_id': 123456,
        'user_name': 'Bob Cat'
      }
