AnalysisType: rule
Filename: onelogin_admin_role_assigned.py 
RuleID: OneLogin.AdminRoleAssigned
DisplayName: OneLogin Admin Role Assigned
Enabled: true
LogTypes:
  - OneLogin.Events
Tags:
  - Identity & Access Management
Severity: Low
SummaryAttributes:
  - user_name
  - privilege_name
Tests:
  -
    Name: Non permissions assigned event
    ExpectedResult: false
    Log:
      {
        "event_type_id": 8
      }
  -
    Name: Non super user permissions assigned
    ExpectedResult: false
    Log:
      {
        "event_type_id": 72,
        "privilege_name": "Manage users"
      }
  -
    Name: Super user permissions assigned
    ExpectedResult: true
    Log:
      {
        "event_type_id": 72,
        "privilege_name": "Super user",
        "user_name": "Evil Bob",
        "actor_user_name": "Bobert O'Bobly"
      }
