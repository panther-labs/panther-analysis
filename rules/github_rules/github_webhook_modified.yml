AnalysisType: rule
Description: >-
  Detects when a webhook is added, modified, or deleted
DisplayName: "GitHub Web Hook Modified"
Enabled: true
Filename: github_webhook_modified.py
LogTypes:
  - GitHub.Audit
Reference: https://docs.github.com/en/webhooks/about-webhooks
Reports:
  MITRE ATT&CK:
    - TA0010:T1020
RuleID: "GitHub.Webhook.Modified"
Severity: Info
Tags:
  - GitHub
  - Exfiltration:Automated Exfiltration
Tests:
  - ExpectedResult: true
    Log:
      "action": "hook.create"
      "actor": "cat"
      "config":
        "url": "https://fake.url"
      "data":
        "events":
          - "fork"
          - "public"
          - "pull_request"
          - "push"
          - "repository"
        "hook_id": 111222333444555
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "public_repo": false
      "repo": "my-org/my-repo"
    Name: GitHub - Webhook Created
  - ExpectedResult: true
    Log:
      "action": "hook.destroy"
      "actor": "cat"
      "data":
        "events":
          - "fork"
          - "public"
          - "pull_request"
          - "push"
          - "repository"
        "hook_id": 111222333444555
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "public_repo": false
      "repo": "my-org/my-repo"
    Name: GitHub - Webhook Deleted
  - ExpectedResult: false
    Log:
      "action": "org.invite_member"
      "actor": "cat"
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Non Webhook Event
  - ExpectedResult: true
    Log:
      "action": "hook.create"
      "actor": "dog"
      "actor_id": "11112222"
      "actor_location":
        "country_code": "US"
      "business": "my-biz"
      "business_id": "9999999"
      "config":
        "content_type": "json"
        "insecure_ssl": "0"
        "url": "https://fake.url/"
      "hook_id": "111222333444555"
      "integration": "My Cool Github Integration"
      "name": "webhook"
      "operation_type": "create"
      "org": "my-org"
      "org_id": 9999999
      "p_log_type": "GitHub.Audit"
    Name: Github - App Webhook Created
