AnalysisType: rule
Description: >-
  Detects when a team is modified in some way, such as adding a new team, deleting
  a team, modifying members, or a change in repository control.
DisplayName: "GitHub Team Modified"
Enabled: true
Filename: github_team_modified.py
LogTypes:
  - GitHub.Audit
Reference: https://docs.github.com/en/organizations/organizing-members-into-teams
Reports:
  MITRE ATT&CK:
    - TA0001:T1195
RuleID: "GitHub.Team.Modified"
Severity: Info
Tags:
  - GitHub
  - Initial Access:Supply Chain Compromise
Tests:
  - ExpectedResult: true
    Log:
      "action": "team.destroy"
      "actor": "cat"
      "created_at": 1621305118553
      "data":
        "team": "my-org/my-team"
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Team Deleted
  - ExpectedResult: true
    Log:
      "action": "team.create"
      "actor": "cat"
      "created_at": 1621305118553
      "data":
        "team": "my-org/my-team"
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Team Created
  - ExpectedResult: true
    Log:
      "action": "team.add_repository"
      "actor": "cat"
      "created_at": 1621305118553
      "data":
        "team": "my-org/my-team"
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Team Add repository
