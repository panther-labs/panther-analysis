AnalysisType: rule
Description: >-
  Detects when an organization repository visibility changes.
DisplayName: "GitHub Repository Visibility Change"
Enabled: true
Filename: github_repo_visibility_change.py
LogTypes:
  - GitHub.Audit
Reference: 
  https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/setting-repository-visibility
Reports:
  MITRE ATT&CK:
    - TA0010:T1567
RuleID: "Github.Repo.VisibilityChange"
Severity: High
Tags:
  - GitHub
  - Exfiltration:Exfiltration Over Web Service
Tests:
  - ExpectedResult: true
    Log:
      "action": "repo.access"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Repo Visibility Change
  - ExpectedResult: false
    Log:
      "action": "repo.disable"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Repo disabled
