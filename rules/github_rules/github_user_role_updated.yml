AnalysisType: rule
Description: >-
  Detects when a GitHub user role is upgraded to an admin or downgraded to a member
DisplayName: "GitHub User Role Updated"
Enabled: true
Filename: github_user_role_updated.py
LogTypes:
  - GitHub.Audit
Reference: 
  https://docs.github.com/en/organizations/managing-peoples-access-to-your-organization-with-roles/roles-in-an-organization
Reports:
  MITRE ATT&CK:
    - TA0003:T1098
RuleID: "GitHub.User.RoleUpdated"
Severity: High
Tags:
  - GitHub
  - Persistence:Account Manipulation
Tests:
  - ExpectedResult: true
    Log:
      "action": "org.update_member"
      "actor": "cat"
      "created_at": 1621305118553
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
      "user": "bob"
    Name: GitHub - Member Updated
  - ExpectedResult: false
    Log:
      "action": "org.invite_member"
      "actor": "cat"
      "created_at": 1621305118553
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
      "user": "bob"
    Name: GitHub - Member Invited
