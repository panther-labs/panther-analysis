AnalysisType: rule
Description: >-
  Detects changes to GitHub org authentication changes.
DisplayName: "GitHub Org Authentication Method Changed"
Enabled: true
Filename: github_org_auth_modified.py
LogTypes:
  - GitHub.Audit
Reference: 
  https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-authentication-to-github
Reports:
  MITRE ATT&CK:
    - TA0003:T1098
RuleID: "GitHub.Org.AuthChange"
Runbook: >-
  Verify that the GitHub admin performed this activity and validate its use.
Severity: Critical
SummaryAttributes:
  - actor
  - action
Tags:
  - GitHub
  - Persistence:Account Manipulation
Tests:
  - ExpectedResult: true
    Log:
      "action": "org.saml_disabled"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Authentication Method Changed
  - ExpectedResult: false
    Log:
      "action": "invite_member"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - Non Auth Related Org Change
