AnalysisType: rule
Description: >-
  Detects when a GitHub user access key is created.
DisplayName: "GitHub User Access Key Created"
Enabled: true
Filename: github_user_access_key_created.py
LogTypes:
  - GitHub.Audit
Reference: 
  https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent
Reports:
  MITRE ATT&CK:
    - TA0003:T1078
RuleID: "GitHub.User.AccessKeyCreated"
Severity: Info
Tags:
  - GitHub
  - Persistence:Valid Accounts
Tests:
  - ExpectedResult: true
    Log:
      "action": "public_key.create"
      "actor": "cat"
      "created_at": 1621305118553
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - User Access Key Created
  - ExpectedResult: false
    Log:
      "action": "public_key.delete"
      "actor": "cat"
      "created_at": 1621305118553
      "p_log_type": "GitHub.Audit"
      "repo": "my-org/my-repo"
    Name: GitHub - User Access Key Deleted
