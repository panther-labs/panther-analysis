AnalysisType: rule
Description: >-
  Detects changes to a GitHub Org IP Allow List
DisplayName: "GitHub Org IP Allow List modified"
Enabled: true
Filename: github_org_ip_allowlist.py
LogTypes:
  - GitHub.Audit
Reference: 
  https://docs.github.com/en/apps/maintaining-github-apps/managing-allowed-ip-addresses-for-a-github-app
Reports:
  MITRE ATT&CK:
    - TA0003:T1098
RuleID: "GitHub.Org.IpAllowlist"
Runbook: >-
  Verify that the change was authorized and appropriate.
Severity: Medium
SummaryAttributes:
  - actor
  - action
Tags:
  - GitHub
  - Persistence:Account Manipulation
Tests:
  - ExpectedResult: true
    Log:
      "action": "ip_allow_list_entry.create"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
    Name: GitHub - IP Allow list modified
  - ExpectedResult: true
    Log:
      "action": "ip_allow_list.disable"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
    Name: GitHub - IP Allow list disabled
  - ExpectedResult: false
    Log:
      "action": "org.invite_user"
      "actor": "cat"
      "created_at": 1621305118553
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
    Name: GitHub - Non IP Allow list action
