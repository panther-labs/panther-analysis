AnalysisType: rule
Description: >-
  Deprecated. See GitHub.Webhook.Modified instead.
DisplayName: "DEPRECATED - GitHub Web Hook Modified"
Enabled: false
Filename: github_repo_hook_modified.py
LogTypes:
  - GitHub.Audit
Reference: https://docs.github.com/en/webhooks/about-webhooks
Reports:
  MITRE ATT&CK:
    - TA0010:T1020
RuleID: "GitHub.Repo.HookModified"
Severity: Info
Tags:
  - GitHub
  - Exfiltration:Automated Exfiltration
  - Deprecated
Tests:
  - ExpectedResult: true
    Log:
      "action": "hook.create"
      "actor": "cat"
      "data":
        "events":
          - "fork"
          - "public"
          - "pull_request"
          - "push"
          - "repository"
        "hook_id": 111222333444555
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repository": "my-org/my-repo"
    Name: GitHub - Webhook Created
  - ExpectedResult: true
    Log:
      "action": "hook.destroy"
      "actor": "cat"
      "data":
        "events":
          - "fork"
          - "public"
          - "pull_request"
          - "push"
          - "repository"
        "hook_id": 111222333444555
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repository": "my-org/my-repo"
    Name: GitHub - Webhook Deleted
  - ExpectedResult: false
    Log:
      "action": "org.invite_member"
      "actor": "cat"
      "org": "my-org"
      "p_log_type": "GitHub.Audit"
      "repository": "my-org/my-repo"
    Name: GitHub - Non Webhook Event
