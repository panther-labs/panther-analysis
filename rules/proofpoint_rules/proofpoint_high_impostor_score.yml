AnalysisType: rule
Filename: proofpoint_high_impostor_score.py
RuleID: "Proofpoint.HighImpostorScore"
DisplayName: "Proofpoint High Impostor Score Detected"
Enabled: true
LogTypes:
  - Proofpoint.Event
Tags:
  - Proofpoint
  - Email Security
  - Business Email Compromise
  - BEC
  - Impersonation
Severity: Medium
Description: >
  This rule alerts when Proofpoint detects a high impostor score (50+),
  indicating potential Business Email Compromise (BEC) or impersonation
  attacks. The impostor score measures the likelihood that the sender is
  impersonating a trusted entity. Severity is dynamic based on the score:
  CRITICAL (80+), HIGH (65+), MEDIUM (50+).
Runbook: |
  1. Immediately review the sender details and compare to legitimate senders
  2. Check if the email address is a lookalike domain (e.g., company.co vs company.com)
  3. Verify if any recipients responded or took action based on the email
  4. Check for financial transaction requests or credential harvesting attempts
  5. If BEC is confirmed, notify finance/accounting teams immediately
  6. Block the impersonating sender domain
  7. Alert executives if they are being impersonated
  8. Report to law enforcement if financial fraud was attempted
Reference: https://help.proofpoint.com/Threat_Insight_Dashboard/API_Documentation/SIEM_API
Tests:
  - Name: Critical Impostor Score
    ExpectedResult: true
    Log:
      messageTime: "2026-01-08T14:00:00Z"
      sender: "ceo@comp4ny.com"
      senderIP: "192.0.2.150"
      fromAddress:
        - "ceo@comp4ny.com"
      toAddresses:
        - "finance@company.com"
      recipient:
        - "finance@company.com"
      subject: "Urgent Wire Transfer Request"
      malwareScore: 0
      phishScore: 60
      spamScore: 10
      impostorScore: 95
      headerFrom: "CEO <ceo@comp4ny.com>"
      messageID: "<bec-urgent@comp4ny.com>"
  - Name: High Impostor Score
    ExpectedResult: true
    Log:
      messageTime: "2026-01-08T15:30:00Z"
      sender: "it-support@company-support.net"
      senderIP: "198.51.100.175"
      fromAddress:
        - "it-support@company-support.net"
      toAddresses:
        - "employee@company.com"
      recipient:
        - "employee@company.com"
      subject: "Password Reset Required"
      malwareScore: 0
      phishScore: 45
      spamScore: 15
      impostorScore: 70
      headerFrom: "IT Support <it-support@company-support.net>"
      messageID: "<fake-it@company-support.net>"
  - Name: Medium Impostor Score at Threshold
    ExpectedResult: true
    Log:
      messageTime: "2026-01-08T16:00:00Z"
      sender: "hr@c0mpany.com"
      senderIP: "203.0.113.88"
      fromAddress:
        - "hr@c0mpany.com"
      toAddresses:
        - "employee@company.com"
      recipient:
        - "employee@company.com"
      subject: "Update Your Benefits"
      malwareScore: 0
      phishScore: 30
      spamScore: 20
      impostorScore: 50
      headerFrom: "Human Resources <hr@c0mpany.com>"
      messageID: "<fake-hr@c0mpany.com>"
  - Name: Low Impostor Score - No Alert
    ExpectedResult: false
    Log:
      messageTime: "2026-01-08T17:00:00Z"
      sender: "marketing@partner.com"
      senderIP: "203.0.113.20"
      fromAddress:
        - "marketing@partner.com"
      toAddresses:
        - "employee@company.com"
      recipient:
        - "employee@company.com"
      subject: "New Product Launch"
      malwareScore: 0
      phishScore: 0
      spamScore: 30
      impostorScore: 15
      headerFrom: "Marketing Team <marketing@partner.com>"
      messageID: "<newsletter@partner.com>"
  - Name: Zero Impostor Score - No Alert
    ExpectedResult: false
    Log:
      messageTime: "2026-01-08T18:00:00Z"
      sender: "colleague@company.com"
      senderIP: "203.0.113.5"
      fromAddress:
        - "colleague@company.com"
      toAddresses:
        - "employee@company.com"
      recipient:
        - "employee@company.com"
      subject: "Project Update"
      malwareScore: 0
      phishScore: 0
      spamScore: 0
      impostorScore: 0
      headerFrom: "Jane Doe <colleague@company.com>"
      messageID: "<project-update@company.com>"
