AnalysisType: rule
DedupPeriodMinutes: 15
Description: >-
  A user has been granted administrative privileges in Okta
DisplayName: "Okta Admin Role Assigned"
Enabled: true
Filename: okta_admin_role_assigned.py
LogTypes:
  - Okta.SystemLog
Reference: 
  https://help.okta.com/en/prod/Content/Topics/Security/administrators-admin-comparison.htm
Reports:
  MITRE ATT&CK:
    - TA0004:T1078
RuleID: "Okta.AdminRoleAssigned"
Runbook: >-
  Reach out to the user if needed to validate the activity
Severity: Info
SummaryAttributes:
  - eventType
  - severity
  - displayMessage
  - p_any_ip_addresses
Tags:
  - Identity & Access Management
  - Okta
  - Privilege Escalation:Valid Accounts
Tests:
  - ExpectedResult: true
    Log:
      "actor":
        "alternateId": "jack@acme.io"
        "displayName": "Jack Naglieri"
        "id": "00uu1uuuuIlllaaaa356"
        "type": "User"
      "authenticationContext": {}
      "client":
        "device": "Computer"
        "geographicalContext":
          "city": "San Francisco"
          "country": "United States"
          "geolocation":
            "lat": 37.7852
            "lon": -122.3874
          "postalCode": "94105"
          "state": "California"
        "ipAddress": "136.24.229.58"
        "userAgent":
          "browser": "CHROME"
          "os": "Mac OS X"
          "rawUserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
            (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36"
        "zone": "null"
      "debugContext":
        "debugData":
          "privilegeGranted": "Organization administrator, Application administrator
            (all)"
          "requestId": "X777JJ9sssQQHHrrrQTyYQAABBE"
          "requestUri": "/api/internal/administrators/00u6eu8c68bb72a21b57"
          "threatSuspected": "false"
          "url": "/api/internal/administrators/00u6eu8c68bb72a21b57"
      "displayMessage": "Grant user privilege"
      "eventType": "user.account.privilege.grant"
      "legacyEventType": "core.user.admin_privilege.granted"
      "outcome":
        "result": "SUCCESS"
      "published": "2020-11-25 21:27:03.496000000"
      "request": {}
      "securityContext": {}
      "severity": "INFO"
      "target":
        - "alternateId": "alice@acme.io"
          "displayName": "Alice Green"
          "id": "00u6eup97mAJZWYmP357"
          "type": "User"
      "transaction": {}
      "uuid": "2a992f80-d1ad-4f62-900e-8c68bb72a21b"
      "version": "0"
    Name: Admin Access Assigned
  - ExpectedResult: true
    Log:
      "actor":
        "alternateId": "jack@acme.io"
        "displayName": "Jack Naglieri"
        "id": "00uu1uuuuIlllaaaa356"
        "type": "User"
      "authenticationContext": {}
      "client":
        "device": "Computer"
        "geographicalContext":
          "city": "San Francisco"
          "country": "United States"
          "geolocation":
            "lat": 37.7852
            "lon": -122.3874
          "postalCode": "94105"
          "state": "California"
        "ipAddress": "136.24.229.58"
        "userAgent":
          "browser": "CHROME"
          "os": "Mac OS X"
          "rawUserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
            (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36"
        "zone": "null"
      "debugContext":
        "debugData":
          "privilegeGranted": "Super administrator, Read only admin"
          "requestId": "X777JJ9sssQQHHrrrQTyYQAABBE"
          "requestUri": "/api/internal/administrators/00u6eu8c68bb72a21b57"
          "threatSuspected": "false"
          "url": "/api/internal/administrators/00u6eu8c68bb72a21b57"
      "displayMessage": "Grant user privilege"
      "eventType": "user.account.privilege.grant"
      "legacyEventType": "core.user.admin_privilege.granted"
      "outcome":
        "result": "SUCCESS"
      "published": "2020-11-25 21:27:03.496000000"
      "request": {}
      "securityContext": {}
      "severity": "INFO"
      "target":
        - "alternateId": "alice@acme.io"
          "displayName": "Alice Green"
          "id": "00u6eup97mAJZWYmP357"
          "type": "User"
      "transaction": {}
      "uuid": "2a992f80-d1ad-4f62-900e-8c68bb72a21b"
      "version": "0"
    Name: Super Admin Access Assigned (High sev)
