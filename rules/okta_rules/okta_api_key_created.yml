AnalysisType: rule
Description: >-
  A user created an API Key in Okta
DisplayName: "Okta API Key Created"
Enabled: true
Filename: okta_api_key_created.py
LogTypes:
  - Okta.SystemLog
Reference: https://help.okta.com/en/prod/Content/Topics/Security/API.htm
Reports:
  MITRE ATT&CK:
    - TA0006:T1528
RuleID: "Okta.APIKeyCreated"
Runbook: >-
  Reach out to the user if needed to validate the activity.
Severity: Info
SummaryAttributes:
  - eventType
  - severity
  - displayMessage
  - p_any_ip_addresses
Tags:
  - Identity & Access Management
  - Okta
  - Credential Access:Steal Application Access Token
Tests:
  - ExpectedResult: true
    Log:
      "actor":
        "alternateId": "user@example.com"
        "displayName": "Test User"
        "id": "00u3q14ei6KUOm4Xi2p4"
        "type": "User"
      "debugContext": {}
      "displayMessage": "Create API token"
      "eventType": "system.api_token.create"
      "legacyEventType": "api.token.create"
      "outcome":
        "result": "SUCCESS"
      "published": "2021-01-08 21:28:34.875"
      "request": {}
      "severity": "INFO"
      "target":
        - "alternateId": "unknown"
          "details":
          "displayName": "test_key"
          "id": "00Tpki36zlWjhjQ1u2p4"
          "type": "Token"
      "uuid": "2a992f80-d1ad-4f62-900e-8c68bb72a21b"
      "version": "0"
    Name: API Key Created
