AnalysisType: rule
Description: >-
  A user has revoked an API Key in Okta
DisplayName: "Okta API Key Revoked"
Enabled: true
Filename: okta_api_key_revoked.py
LogTypes:
  - Okta.SystemLog
Reference: https://help.okta.com/en/prod/Content/Topics/Security/API.htm
RuleID: "Okta.APIKeyRevoked"
Runbook: >-
  Validate this action was authorized.
Severity: Info
SummaryAttributes:
  - eventType
  - severity
  - displayMessage
  - p_any_ip_addresses
Tags:
  - Identity & Access Management
  - Okta
Tests:
  - ExpectedResult: true
    Log:
      "actor":
        "alternateId": "user@example.com"
        "displayName": "Test User"
        "id": "00u3q14ei6KUOm4Xi2p4"
        "type": "User"
      "debugContext": {}
      "displayMessage": "Revoke API token"
      "eventType": "system.api_token.revoke"
      "legacyEventType": "api.token.revoke"
      "outcome":
        "result": "SUCCESS"
      "published": "2021-01-08 21:28:34.875"
      "request": {}
      "severity": "INFO"
      "target":
        - "alternateId": "unknown"
          "details":
          "displayName": "test_key"
          "id": "00Tpki36zlWjhjQ1u2p4"
          "type": "Token"
      "uuid": "2a992f80-d1ad-4f62-900e-8c68bb72a21b"
      "version": "0"
    Name: API Key Revoked
