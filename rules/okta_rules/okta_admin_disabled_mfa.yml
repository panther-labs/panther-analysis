AnalysisType: rule
DedupPeriodMinutes: 15
Description: >-
  An admin user has disabled the MFA requirement for your Okta account
DisplayName: "Okta MFA Globally Disabled"
Enabled: true
Filename: okta_admin_disabled_mfa.py
LogTypes:
  - Okta.SystemLog
Reference: 
  https://help.okta.com/oie/en-us/content/topics/identity-engine/authenticators/about-authenticators.htm
Reports:
  MITRE ATT&CK:
    - TA0005:T1556
RuleID: "Okta.Global.MFA.Disabled"
Runbook: >-
  Contact Admin to ensure this was sanctioned activity
Severity: High
SummaryAttributes:
  - eventType
  - severity
  - displayMessage
  - p_any_ip_addresses
Tags:
  - Identity & Access Management
  - DataModel
  - Okta
  - Defense Evasion:Modify Authentication Process
Tests:
  - ExpectedResult: true
    Log:
      "actor":
        "alternateId": "homer@springfield.gov"
        "displayName": "Homer Simpson"
        "id": "111111"
        "type": "User"
      "client":
        "device": "Computer"
        "ipAddress": "1.1.1.1"
        "userAgent":
          "browser": "CHROME"
          "os": "Mac OS X"
          "rawUserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
            (KHTML, like Gecko) Chrome/99.0.4844.83 Safari/537.36"
        "zone": "null"
      "eventType": "system.mfa.factor.deactivate"
      "p_log_type": "Okta.SystemLog"
      "published": "2022-03-22 14:21:53.225"
      "severity": "HIGH"
      "version": "0"
    Name: MFA Disabled
  - ExpectedResult: false
    Log:
      "actor":
        "alternateId": "homer@springfield.gov"
        "displayName": "Homer Simpson"
        "id": "111111"
        "type": "User"
      "client":
        "device": "Computer"
        "ipAddress": "1.1.1.1"
        "userAgent":
          "browser": "CHROME"
          "os": "Mac OS X"
          "rawUserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
            (KHTML, like Gecko) Chrome/99.0.4844.83 Safari/537.36"
        "zone": "null"
      "eventType": "user.session.start"
      "p_log_type": "Okta.SystemLog"
      "published": "2022-03-22 14:21:53.225"
      "severity": "INFO"
      "version": "0"
    Name: Login Event
