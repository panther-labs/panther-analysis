AnalysisType: rule
Description: >-
  An Admin has modified Panther's SAML configuration.
DisplayName: "Panther SAML configuration has been modified"
Enabled: true
Filename: panther_saml_modified.py
LogTypes:
  - Panther.Audit
Reference: https://docs.panther.com/system-configuration/saml
Reports:
  MITRE ATT&CK:
    - TA0005:T1562
RuleID: "Panther.SAML.Modified"
Runbook: >-
  Ensure this change was approved and appropriate.
Severity: High
SummaryAttributes:
  - p_any_ip_addresses
  - p_any_usernames
Tags:
  - DataModel
  - Defense Evasion:Impair Defenses
Tests:
  - ExpectedResult: true
    Log:
      "actionName": "UPDATE_SAML_SETTINGS"
      "actionParams": {}
      "actionResult": "SUCCEEDED"
      "actor":
        "attributes":
          "email": "homer@springfield.gov"
          "emailVerified": true
          "roleId": "111111"
        "id": "111111"
        "name": "Homer Simpson"
        "type": "USER"
      "errors":
      "p_log_type": "Panther.Audit"
    Name: SAML config modified
  - ExpectedResult: false
    Log:
      "actionName": "GET_SAML_SETTINGS"
      "actionParams": {}
      "actionResult": "SUCCEEDED"
      "actor":
        "attributes":
          "email": "homer@springfield.gov"
          "emailVerified": true
          "roleId": "111111"
        "id": "111111"
        "name": "Homer Simpson"
        "type": "USER"
      "errors":
      "p_log_type": "Panther.Audit"
    Name: SAML config viewed
