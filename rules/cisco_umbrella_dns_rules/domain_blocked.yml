AnalysisType: rule
DedupPeriodMinutes: 480
Description: >-
  Monitor blocked domains
DisplayName: "Cisco Umbrella Domain Blocked"
Enabled: true
Filename: domain_blocked.py
LogTypes:
  - CiscoUmbrella.DNS
Reference: 
  https://support.umbrella.com/hc/en-us/articles/230563627-How-to-determine-if-a-domain-or-resource-is-being-blocked-using-Chrome-Net-Internals
RuleID: "CiscoUmbrella.DNS.Blocked"
Runbook: >-
  Inspect the blocked domain and lookup for malware
Severity: Low
SummaryAttributes:
  - action
  - internalIp
  - externalIp
  - domain
  - responseCode
Tags:
  - DNS
Tests:
  - ExpectedResult: true
    Log:
      "action": "Blocked"
      "domain": "malware.gvt2.com."
      "externalIp": "136.24.229.58"
      "internalIp": "136.24.229.58"
      "responseCode": "NOERROR"
      "timestamp": "2020-05-21 19:20:25.000"
    Name: Domain Blocked
  - ExpectedResult: false
    Log:
      "action": "Allowed"
      "domain": "beacons3.gvt2.com."
      "externalIp": "136.24.229.58"
      "internalIp": "136.24.229.58"
      "responseCode": "NOERROR"
      "timestamp": "2020-05-21 19:20:25.000"
    Name: Action Allowed
