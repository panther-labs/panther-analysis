AnalysisType: rule
Description: 'Detects AWS API key creation for a user by another user.

  Backdoored users can be used to obtain persistence in the AWS environment.

  Also with this alert, you can detect a flow of AWS keys in your org.



  Status: test


  Author: faloker

  False Positives: Adding user keys to their own accounts (the filter cannot cover
  all possible variants of user naming), AWS API keys legitimate exchange workflows'
DisplayName: AWS IAM Backdoor Users Keys
Enabled: true
Filename: aws_iam_backdoor_users_keys.py
LogTypes:
- AWS.CloudTrail
Reference: https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/iam__backdoor_users_keys/main.py
Reports:
  MITRE ATT&CK:
  - TA0003:T1098
RuleID: aws_iam_backdoor_users_keys
Severity: Medium
Tags:
- Sigma
- persistence
- t1098
