AnalysisType: rule
Description: 'Detects when an Elastic Container Service (ECS) Task Definition includes
  a command to query the credential endpoint.

  This can indicate a potential adversary adding a backdoor to establish persistence
  or escalate privileges.



  Status: test


  Author: Darin Smith

  False Positives: Task Definition being modified to request credentials from the
  Task Metadata Service for valid reasons'
DisplayName: AWS ECS Task Definition That Queries The Credential Endpoint
Enabled: true
Filename: aws_ecs_task_definition_cred_endpoint_query.py
LogTypes:
- AWS.CloudTrail
Reference: https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/ecs__backdoor_task_def/main.py
Reports:
  MITRE ATT&CK:
  - TA0003:T1525
RuleID: aws_ecs_task_definition_cred_endpoint_query
Severity: Medium
Tags:
- Sigma
- persistence
- t1525
