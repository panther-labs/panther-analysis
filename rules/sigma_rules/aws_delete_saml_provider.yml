AnalysisType: rule
Description: 'Detects the deletion of an AWS SAML provider, potentially indicating
  malicious intent to disrupt administrative or security team access.

  An attacker can remove the SAML provider for the information security team or a
  team of system administrators, to make it difficult for them to work and investigate
  at the time of the attack and after it.



  Status: experimental


  Author: Ivan Saakov

  False Positives: Automated processes using tools like Terraform may trigger this
  alert., Legitimate administrative actions by authorized system administrators could
  cause this alert. Verify the user identity, user agent, and hostname to ensure they
  are expected., Deletions by unfamiliar users should be investigated. If the behavior
  is known and expected, it can be exempted from the rule.'
DisplayName: AWS SAML Provider Deletion Activity
Enabled: true
Filename: aws_delete_saml_provider.py
LogTypes:
- AWS.CloudTrail
Reference: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteSAMLProvider.html
Reports:
  MITRE ATT&CK:
  - TA0004:T1078.004
  - TA0004:T1531
  - TA0040:T1078.004
  - TA0040:T1531
RuleID: aws_delete_saml_provider
Severity: Medium
Tags:
- Sigma
- t1078.004
- privilege-escalation
- t1531
- impact
