AnalysisType: rule
DedupPeriodMinutes: 120
Description: >-
  Detects when unusual or undesirable 1Password clients access your 1Password account
DisplayName: "Unusual 1Password Client Detected"
Enabled: true
Filename: onepassword_unusual_client.py
LogTypes:
  - OnePassword.SignInAttempt
Reference: https://support.1password.com/category/accounts/
Reports:
  MITRE ATT&CK:
    - TA0006:T1555
RuleID: "OnePassword.Unusual.Client"
Severity: Medium
SummaryAttributes:
  - p_any_ip_addresses
  - p_any_emails
Tags:
  - 1Password
  - Credential Access:Credentials from Password Stores
Tests:
  - ExpectedResult: false
    Log:
      "category": "success"
      "client":
        "app_name": "1Password for Mac"
        "app_version": "70902005"
        "ip_address": "1.1.1.1"
        "os_name": "MacOSX"
        "os_version": "11.6.1"
        "platform_name": "US - C02FR0H8MD6P"
        "platform_version": "MacBookPro16,1"
      "country": "US"
      "p_log_type": "OnePassword.SignInAttempt"
      "session_uuid": "12345"
      "target_user":
        "email": "homer@springfield.gov"
        "name": "Homer Simpson"
        "uuid": "1234"
      "timestamp": "2021-12-15 18:02:23"
      "type": "credentials_ok"
      "uuid": "1234"
    Name: 1Password - Expected Client
  - ExpectedResult: true
    Log:
      "category": "success"
      "client":
        "app_name": "Bartco 1Password Manager"
        "app_version": "70902005"
        "ip_address": "1.1.1.1"
        "os_name": "MacOSX"
        "os_version": "11.6.1"
        "platform_name": "US - C02FR0H8MD6P"
        "platform_version": "MacBookPro16,1"
      "country": "US"
      "p_log_type": "OnePassword.SignInAttempt"
      "session_uuid": "12345"
      "target_user":
        "email": "homer@springfield.gov"
        "name": "Homer Simpson"
        "uuid": "1234"
      "timestamp": "2021-12-15 18:02:23"
      "type": "credentials_ok"
      "uuid": "1234"
    Name: 1Password - Bad Client
