AnalysisType: rule
Description: WIP
DisplayName: "Connection to Embargoed Country"
Enabled: false
Filename: crowdstrike_connection_to_embargoed_country.py
Severity: Medium
Tests:
    - ExpectedResult: true
      Log:
        RemoteAddressIP4: 152.206.0.1
        p_enrichment:
            ipinfo_asn:
                RemoteAddressIP4:
                    asn: AS27725
                    domain: etecsa.cu
                    name: Empresa de Telecomunicaciones de Cuba, S.A.
                    route: 152.206.0.0/17
                    type: isp
            ipinfo_location:
                RemoteAddressIP4:
                    city: Matanzas
                    country: CU
                    lat: "23.04111"
                    lng: "-81.5775"
                    postal_code: ""
                    region: Matanzas Province
                    region_code: "04"
                    timezone: America/Havana
        p_log_type: Crowdstrike.NetworkConnect
      Name: Connection to Cuba
    - ExpectedResult: false
      Log:
        RemoteAddressIP4: 8.8.8.8
        p_enrichment:
            greynoise_riot_advanced:
                RemoteAddressIP4:
                    ip_cidr: 8.8.8.8/32
                    provider:
                        category: public_dns
                        description: Google's global domain name sys...
                        explanation: Public DNS services are used as...
                        name: Google Public DNS
                        precedence: 0
                        trust_level: "1"
                    scan_time: "2023-03-08 17:11:38.522129575"
            greynoise_riot_basic:
                RemoteAddressIP4:
                    ip_cidr: 8.8.8.8/32
                    provider:
                        name: Google Public DNS
            ipinfo_asn:
                RemoteAddressIP4:
                    asn: AS15169
                    domain: google.com
                    name: Google LLC
                    route: 8.8.8.0/24
                    type: hosting
            ipinfo_location:
                RemoteAddressIP4:
                    city: Mountain View
                    country: US
                    lat: "37.4056"
                    lng: "-122.0775"
                    postal_code: "94043"
                    region: California
                    region_code: CA
                    timezone: America/Los_Angeles
            ipinfo_privacy:
                RemoteAddressIP4:
                    hosting: true
                    proxy: false
                    relay: false
                    service: ""
                    tor: false
                    vpn: false
        p_log_type: Crowdstrike.NetworkConnect
      Name: Google DNS
DedupPeriodMinutes: 60
LogTypes:
    - Crowdstrike.NetworkConnect
RuleID: "Connection.to.Embargoed.Country"
Threshold: 1
