AnalysisType: rule
Filename: slack_application_dos.py
RuleID: "Slack.AuditLogs.ApplicationDoS"
DisplayName: "Slack Denial of Service via Session Invalidation"
Enabled: true
LogTypes:
  - Slack.AuditLogs
Tags:
  - Slack
  - Impact
  - Endpoint Denial of Service
  - Application Exhaustion Flood
Reports:
  MITRE ATT&CK:
    - TA0040:T1499.003
Severity: Critical
Description: >
  Detects potential Denial of Service (DoS) attacks against Slack users through excessive session invalidation by workspace administrators. This rule monitors three admin actions that terminate user sessions: bulk_session_reset_by_admin (resets multiple sessions simultaneously), user_session_invalidated (programmatic session termination), and user_session_reset_by_admin (resets a specific user's session). The rule triggers when any combination of these actions occurs 60 or more times against the same user within a 24-hour period, indicating a targeted attempt to prevent the user from accessing the Slack workspace. Session invalidation forces users to re-authenticate, and repeated invalidation creates a denial of service condition where the targeted user cannot maintain access to their workspace, disrupting communication and productivity. Legitimate use cases for session resets include incident response when an account is suspected of compromise, enforcement of security policies after password changes, or troubleshooting authentication issues, but these typically involve a small number of resets (1-3 times). Reaching the 60-event threshold strongly suggests malicious intent such as a rogue or compromised administrator account being used to harass or exclude a specific user, an insider threat targeting an individual, automated abuse through compromised admin credentials, or an attempt to disrupt business operations by preventing critical personnel from accessing communication channels. This attack can also be part of a broader campaign to cover tracks by preventing security team members from investigating other malicious activities in the workspace. The high threshold (60 events) is designed to minimize false positives from legitimate administrative actions while detecting sustained abuse patterns that represent genuine denial of service attacks.
Reference: https://slack.com/intl/en-gb/help/articles/115005223763-Manage-session-duration-#pro-and-business+-subscriptions-2
Runbook: |
  1. Identify the administrator who performed the session resets (check actor.user.email and actor.user.name from alert context) and the targeted user (entity.user.name from deduplication key), then determine the total number of reset events and the time span over which they occurred
  2. Immediately contact the administrator through a secure out-of-band channel (phone call, in-person, secondary communication platform) to verify they intentionally performed these session resets and have a legitimate business justification such as responding to a suspected account compromise or enforcing a security policy
  3. If the administrator confirms this was intentional and authorized, document the business justification and validate that the targeted user was properly notified, then close the alert as a legitimate administrative action during incident response or policy enforcement
  4. If the administrator denies performing these actions or their account appears compromised, immediately revoke the administrator's Slack privileges through the Workspace Settings > Manage Members section to prevent further abuse while investigation continues
  5. Review the administrator's complete Slack audit log activity for the past 7 days to identify other malicious actions such as unauthorized user additions or removals, workspace settings changes, data exports, channel access modifications, or app installations that might indicate broader account compromise or insider threat activity
  6. Assess the impact on the targeted user by contacting them to determine if they experienced repeated logouts preventing them from performing work, check if they reported the issue to IT support, and evaluate business disruption including missed communications, delayed projects, or inability to participate in critical meetings
  7. Investigate potential motives by reviewing the relationship between the administrator and targeted user (manager-employee, peers, different departments), checking for recent HR issues, performance reviews, conflicts, or other workplace dynamics that might indicate harassment or insider threat activity
  8. Query Slack audit logs for other users who may have been targeted with similar session reset patterns to determine if this is an isolated incident or part of a broader campaign affecting multiple users, which would indicate a more serious insider threat or compromised admin account scenario
  9. If this was unauthorized activity, collect evidence including complete audit logs, administrator account authentication history, IP addresses and user agents used for the session reset actions, and any correlation with other suspicious activities for potential HR investigation or legal action
  10. Restore normal operations by ensuring the targeted user can successfully authenticate and access their workspace, implement preventive controls such as requiring multi-factor authentication for all administrators, establishing an approval process for bulk session operations, enabling enhanced audit logging and alerting for sensitive admin actions, and conducting security awareness training for administrators about session management best practices and consequences of abuse
DedupPeriodMinutes: 1440
Threshold: 60
SummaryAttributes:
  - action
  - p_any_ip_addresses
  - p_any_emails
Tests:
  - Name: User Session Reset By Admin
    ExpectedResult: true
    Log:
      {
        "action": "user_session_reset_by_admin",
        "actor":
          {
            "type": "user",
            "user":
              {
                "email": "admin@example.com",
                "id": "W012J3FEWAU",
                "name": "primary-owner",
                "team": "T01234N56GB",
              },
          },
        "entity":
          {
            "type": "user",
            "user":
              {
                "email": "target@example.com",
                "id": "U987654321",
                "name": "target-user",
                "team": "T01234N56GB",
              },
          },
        "context":
          {
            "ip_address": "1.2.3.4",
            "location":
              {
                "domain": "test-workspace-1",
                "id": "T01234N56GB",
                "name": "test-workspace-1",
                "type": "workspace",
              },
            "ua": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",
          },
      }
  - Name: Bulk Session Reset By Admin
    ExpectedResult: true
    Log:
      {
        "action": "bulk_session_reset_by_admin",
        "actor":
          {
            "type": "user",
            "user":
              {
                "email": "admin@example.com",
                "id": "W012J3FEWAU",
                "name": "workspace-admin",
                "team": "T01234N56GB",
              },
          },
        "entity":
          {
            "type": "user",
            "user":
              {
                "email": "target@example.com",
                "id": "U987654321",
                "name": "target-user",
                "team": "T01234N56GB",
              },
          },
        "context":
          {
            "ip_address": "5.6.7.8",
            "location":
              {
                "domain": "test-workspace-1",
                "id": "T01234N56GB",
                "name": "test-workspace-1",
                "type": "workspace",
              },
            "ua": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
          },
      }
  - Name: User Session Invalidated
    ExpectedResult: true
    Log:
      {
        "action": "user_session_invalidated",
        "actor":
          {
            "type": "user",
            "user":
              {
                "email": "admin@example.com",
                "id": "W012J3FEWAU",
                "name": "security-admin",
                "team": "T01234N56GB",
              },
          },
        "entity":
          {
            "type": "user",
            "user":
              {
                "email": "victim@example.com",
                "id": "U555666777",
                "name": "victim-user",
                "team": "T01234N56GB",
              },
          },
        "context":
          {
            "ip_address": "10.0.0.1",
            "location":
              {
                "domain": "test-workspace-1",
                "id": "T01234N56GB",
                "name": "test-workspace-1",
                "type": "workspace",
              },
            "ua": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",
          },
      }
  - Name: Other Action
    ExpectedResult: false
    Log:
      {
        "action": "organization_created",
        "actor":
          {
            "type": "user",
            "user":
              {
                "email": "user@example.com",
                "id": "A012B3CDEFG",
                "name": "username",
                "team": "T01234N56GB",
              },
          },
        "context":
          {
            "ip_address": "1.2.3.4",
            "location":
              {
                "domain": "test-workspace",
                "id": "T01234N56GB",
                "name": "test-workspace",
                "type": "workspace",
              },
            "ua": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",
          },
      }
