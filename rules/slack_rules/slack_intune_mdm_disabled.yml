AnalysisType: rule
Filename: slack_intune_mdm_disabled.py
RuleID: "Slack.AuditLogs.IntuneMDMDisabled"
DisplayName: "Slack Microsoft Intune Mobile Device Management Disabled"
Enabled: true
LogTypes:
  - Slack.AuditLogs
Tags:
  - Slack
  - Defense Evasion
  - Impair Defenses
  - Disable or Modify Tools
  - Mobile Security
  - Data Loss Prevention
Reports:
  MITRE ATT&CK:
    - TA0005:T1562.001
    - TA0010:T1567
Severity: Critical
Description: >
  Detects when Microsoft Intune Mobile Device Management (MDM) integration is disabled for a Slack workspace, removing critical mobile app security controls and enabling potential data exfiltration via unmanaged mobile devices. Microsoft Intune integration with Slack provides enterprise mobile application management (MAM) and mobile device management (MDM) capabilities that enforce security policies on iOS and Android devices accessing the Slack workspace. When Intune MDM is enabled, organizations can enforce mobile app protection policies including preventing copy/paste or screen capture of Slack content to unmanaged applications, requiring device-level security controls such as device encryption and PIN/biometric authentication, detecting and blocking jailbroken or rooted devices, remotely wiping Slack data from lost or stolen devices, controlling which applications can share data with Slack, and enforcing data loss prevention policies that prevent sensitive information from leaving corporate control. Disabling Intune MDM immediately removes all these mobile security controls, allowing users on unmanaged personal devices to freely access Slack without security restrictions, copy sensitive messages and files to personal applications or cloud storage, take screenshots of confidential communications, and access Slack from compromised or insecure devices without detection. This represents a severe security degradation particularly for organizations with BYOD (Bring Your Own Device) policies, those handling sensitive data in regulated industries (healthcare, financial services, legal), or any environment where mobile access to Slack presents data exfiltration risks. Legitimate reasons for disabling Intune MDM are extremely rare and typically only occur during migrations to alternative MDM solutions (VMware Workspace ONE, MobileIron), major organizational changes such as divestitures where devices are transitioning to new management, or troubleshooting critical technical issues with Intune connectivity, and should always require executive-level approval and thorough security review. Malicious disabling could indicate a compromised administrator account being used to remove mobile security controls in preparation for data exfiltration via mobile devices, an insider threat attempting to bypass data loss prevention controls to steal information, or an attacker setting up conditions for future mobile-based attacks by ensuring devices are not monitored or managed. This action should trigger immediate investigation to verify authorization, assess data exfiltration risk from unmanaged mobile devices, and determine if re-enabling Intune MDM is required to restore mobile security posture.
Reference: https://slack.com/intl/en-gb/help/articles/6495319642387-Set-up-Slack-for-Intune-mobile-apps
Runbook: |
  1. Query Slack audit logs for all security control modifications by actor.user.email in the 30 days around this event including EKM changes, data retention policy modifications, export permission changes, and session management settings to identify a pattern of defense evasion
  2. Search Slack audit logs for mobile app login events, file downloads, and data exports during the period when Intune MDM was disabled to detect potential data exfiltration via unmanaged mobile devices
  3. Review Microsoft Intune admin logs and Azure AD audit logs for correlated suspicious activity by the same actor such as removing devices from management or disabling other mobile security policies
DedupPeriodMinutes: 60
Threshold: 1
SummaryAttributes:
  - p_any_ip_addresses
  - p_any_emails
Tests:
  - Name: Intune Disabled
    ExpectedResult: true
    Log:
      {
        "action": "intune_disabled",
        "actor":
          {
            "type": "user",
            "user":
              {
                "email": "user@example.com",
                "id": "A012B3CDEFG",
                "name": "username",
                "team": "T01234N56GB",
              },
          },
        "context":
          {
            "ip_address": "1.2.3.4",
            "location":
              {
                "domain": "test-workspace",
                "id": "T01234N56GB",
                "name": "test-workspace",
                "type": "workspace",
              },
            "ua": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",
          },
      }
  - Name: User Logout
    ExpectedResult: false
    Log:
      {
        "action": "user_logout",
        "actor":
          {
            "type": "user",
            "user":
              {
                "email": "user@example.com",
                "id": "W012J3FEWAU",
                "name": "primary-owner",
                "team": "T01234N56GB",
              },
          },
        "context":
          {
            "ip_address": "1.2.3.4",
            "location":
              {
                "domain": "test-workspace-1",
                "id": "T01234N56GB",
                "name": "test-workspace-1",
                "type": "workspace",
              },
            "ua": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",
          },
        "date_create": "2022-07-28 15:22:32",
        "entity":
          {
            "type": "user",
            "user":
              {
                "email": "user@example.com",
                "id": "W012J3FEWAU",
                "name": "primary-owner",
                "team": "T01234N56GB",
              },
          },
        "id": "72cac009-9eb3-4dde-bac6-ee49a32a1789",
      }
