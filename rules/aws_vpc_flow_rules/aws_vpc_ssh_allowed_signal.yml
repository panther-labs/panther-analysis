AnalysisType: rule
CreateAlert: false
Description: >-
  VPC Flow Logs observed inbound traffic on SSH port. This rule is a signal to be
  used in correlation rules.
DisplayName: "Signal - VPC Flow Logs Allowed SSH"
Enabled: true
Filename: aws_vpc_ssh_allowed_signal.py
LogTypes:
  - AWS.VPCFlow
Reports:
  MITRE ATT&CK:
    - TA0008:T1021.004
RuleID: "AWS.VPC.SSHAllowedSignal"
Severity: Info
Tags:
  - AWS
  - Signal
Tests:
  - ExpectedResult: true
    Log:
      "action": "ACCEPT"
      "dstAddr": "10.0.0.1"
      "dstPort": 22
      "instanceId": "i-0d4c7318592c6a2c7"
      "p_log_type": "AWS.VPCFlow"
      "srcAddr": "1.1.1.1"
    Name: Public to Private IP on SSH Allowed
  - ExpectedResult: false
    Log:
      "action": "ACCEPT"
      "dstAddr": "10.0.0.1"
      "dstPort": 443
      "instanceId": "i-0d4c7318592c6a2c7"
      "p_log_type": "AWS.VPCFlow"
      "srcAddr": "1.1.1.1"
    Name: Public to Private IP on non-SSH
  - ExpectedResult: false
    Log:
      "action": "ACCEPT"
      "dstAddr": "10.0.0.1"
      "dstPort": 22
      "instanceId": "i-0d4c7318592c6a2c7"
      "p_log_type": "AWS.VPCFlow"
      "srcAddr": "10.10.10.1"
    Name: Private to Private IP on SSH
  - ExpectedResult: false
    Log:
      "action": "REJECT"
      "dstAddr": "10.0.0.1"
      "dstPort": 22
      "instanceId": "i-0d4c7318592c6a2c7"
      "p_log_type": "AWS.VPCFlow"
      "srcAddr": "1.1.1.1"
    Name: Public to Private IP on SSH Denied
