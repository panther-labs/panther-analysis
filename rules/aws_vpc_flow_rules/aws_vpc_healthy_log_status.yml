AnalysisType: rule
CreateAlert: false
DedupPeriodMinutes: 1440
Description: >-
  Checks for the log status `SKIPDATA`, which indicates that data was lost either
  to an internal server error or due to capacity constraints.
DisplayName: "AWS VPC Healthy Log Status"
Enabled: true
Filename: aws_vpc_healthy_log_status.py
LogTypes:
  - AWS.VPCFlow
  - OCSF.NetworkActivity
Reference: 
  https://www.reddit.com/r/aws/comments/zt1xhg/vpc_flow_logs_when_is_logstatus_skipdata_a_concern/?rdt=41505
RuleID: "AWS.VPC.HealthyLogStatus"
Runbook: >-
  Determine if the cause of the issue is capacity constraints, and consider adjusting
  VPC Flow Log configurations accordingly.
Severity: Info
Tags:
  - AWS
  - DataModel
  - Security Control
Tests:
  - ExpectedResult: false
    Log:
      "p_log_type": "AWS.VPCFlow"
      "status": "OK"
    Name: Healthy Log Status
  - ExpectedResult: true
    Log:
      "p_log_type": "AWS.VPCFlow"
      "status": "SKIPDATA"
    Name: Unhealthy Log Status
  - ExpectedResult: false
    Log:
      "p_log_type": "OCSF.NetworkActivity"
      "status_code": "OK"
    Name: Healthy Log Status - OCSF
  - ExpectedResult: true
    Log:
      "p_log_type": "OCSF.NetworkActivity"
      "status_code": "SKIPDATA"
    Name: Unhealthy Log Status - OCSF
