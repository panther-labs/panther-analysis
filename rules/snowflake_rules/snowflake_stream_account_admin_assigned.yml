AnalysisType: rule
Description: >-
  Detect when account admin is granted.
DisplayName: "Snowflake Account Admin Granted"
Enabled: true
Filename: snowflake_stream_account_admin_assigned.py
LogTypes:
  - Snowflake.GrantsToUsers
Reports:
  MITRE ATT&CK:
    - TA0004:T1078
RuleID: "Snowflake.Stream.AccountAdminGranted"
Severity: Medium
Tags:
  - Snowflake
  - '[MITRE] Privilege Escalation'
  - '[MITRE] Valid Accounts'
Tests:
  - ExpectedResult: true
    Log:
      "CREATED_ON": "2024-10-08 11:24:50.682000000"
      "GRANTED_BY": "SNOWFLAKE"
      "GRANTED_TO": "APPLICATION_ROLE"
      "GRANTEE_NAME": "TRUST_CENTER_ADMIN"
      "p_event_time": "2024-10-08 11:24:50.682000000"
      "p_log_type": "Snowflake.GrantsToUsers"
      "p_source_label": "Snowflake Prod"
    Name: Admin Role Assigned
  - ExpectedResult: false
    Log:
      "CREATED_ON": "2024-10-08 11:24:50.682000000"
      "GRANTED_BY": "SNOWFLAKE"
      "GRANTED_TO": "APPLICATION_ROLE"
      "GRANTEE_NAME": "TRUST_CENTER_VIEWER"
      "p_event_time": "2024-10-08 11:24:50.682000000"
      "p_log_type": "Snowflake.GrantsToUsers"
      "p_source_label": "Snowflake Prod"
    Name: Non-Admin Role Assigned
