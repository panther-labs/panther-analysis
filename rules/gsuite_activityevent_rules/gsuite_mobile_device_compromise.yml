AnalysisType: rule
Description: >-
  GSuite reported a user's device has been compromised.
DisplayName: "GSuite User Device Compromised"
Enabled: true
Filename: gsuite_mobile_device_compromise.py
LogTypes:
  - GSuite.ActivityEvent
Reference: https://support.google.com/a/answer/7562165?hl=en&sjid=864417124752637253-EU
RuleID: "GSuite.DeviceCompromise"
Runbook: >-
  Have the user change their passwords and reset the device.
Severity: Medium
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "callerType": "USER"
        "email": "homer.simpson@example.io"
      "id":
        "applicationName": "mobile"
      "name": "DEVICE_REGISTER_UNREGISTER_EVENT"
      "parameters":
        "USER_EMAIL": "homer.simpson@example.io"
      "type": "device_updates"
    Name: Normal Mobile Event
  - ExpectedResult: false
    Log:
      "actor":
        "callerType": "USER"
        "email": "homer.simpson@example.io"
      "id":
        "applicationName": "mobile"
      "name": "DEVICE_COMPROMISED_EVENT"
      "parameters":
        "DEVICE_COMPROMISED_STATE": "NOT_COMPROMISED"
        "USER_EMAIL": "homer.simpson@example.io"
      "type": "device_updates"
    Name: Suspicious Activity Shows not Compromised
  - ExpectedResult: true
    Log:
      "actor":
        "callerType": "USER"
        "email": "homer.simpson@example.io"
      "id":
        "applicationName": "mobile"
      "name": "DEVICE_COMPROMISED_EVENT"
      "parameters":
        "DEVICE_COMPROMISED_STATE": "COMPROMISED"
        "USER_EMAIL": "homer.simpson@example.io"
      "type": "device_updates"
    Name: Suspicious Activity Shows Compromised
