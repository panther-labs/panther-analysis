AnalysisType: rule
Description: >-
  A GSuite rule was triggered.
DisplayName: "GSuite Passthrough Rule Triggered"
Enabled: true
Filename: gsuite_passthrough_rule.py
LogTypes:
  - GSuite.ActivityEvent
Reference: https://support.google.com/a/answer/9420866
RuleID: "GSuite.Rule"
Runbook: >-
  Investigate what triggered the rule.
Severity: Info
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "rules"
      "parameters":
        "severity": "HIGH"
        "triggered_actions":
    Name: Non Triggered Rule
  - ExpectedResult: true
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "rules"
      "parameters":
        "data_source": "DRIVE"
        "severity": "HIGH"
        "triggered_actions":
          - "action_type": "DRIVE_UNFLAG_DOCUMENT"
    Name: High Severity Rule
  - ExpectedResult: true
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "rules"
      "parameters":
        "data_source": "DRIVE"
        "severity": "MEDIUM"
        "triggered_actions":
          - "action_type": "DRIVE_UNFLAG_DOCUMENT"
    Name: Medium Severity Rule
  - ExpectedResult: true
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "rules"
      "parameters":
        "severity": "LOW"
        "triggered_actions":
          - "action_type": "DRIVE_UNFLAG_DOCUMENT"
    Name: Low Severity Rule
  - ExpectedResult: true
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "rules"
      "parameters":
        "rule_name": "CEO Impersonation"
        "severity": "HIGH"
        "triggered_actions":
          - "action_type": "MAIL_MARK_AS_PHISHING"
    Name: High Severity Rule with Rule Name
