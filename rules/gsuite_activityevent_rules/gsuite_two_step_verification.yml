AnalysisType: rule
Description: >-
  A user disabled two step verification for themselves.
DisplayName: "GSuite User Two Step Verification Change"
Enabled: true
Filename: gsuite_two_step_verification.py
LogTypes:
  - GSuite.ActivityEvent
Reference: 
  https://support.google.com/mail/answer/185839?hl=en&co=GENIE.Platform%3DDesktop&sjid=864417124752637253-EU
Reports:
  MITRE ATT&CK:
    - TA0005:T1556
RuleID: "GSuite.TwoStepVerification"
Runbook: >-
  Depending on company policy, either suggest or require the user re-enable two step
  verification.
Severity: Low
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
  - Defense Evasion:Modify Authentication Process
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "callerType": "USER"
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "user_accounts"
      "kind": "admin#reports#activity"
      "name": "2sv_enroll"
      "type": "2sv_change"
    Name: Two Step Verification Enabled
  - ExpectedResult: true
    Log:
      "actor":
        "callerType": "USER"
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "user_accounts"
      "kind": "admin#reports#activity"
      "name": "2sv_disable"
      "type": "2sv_change"
    Name: Two Step Verification Disabled
