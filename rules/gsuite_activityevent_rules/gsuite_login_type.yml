AnalysisType: rule
Description: >-
  A login of a non-approved type was detected for this user.
DisplayName: "GSuite Login Type"
Enabled: false
Filename: gsuite_login_type.py
LogTypes:
  - GSuite.ActivityEvent
Reference: https://support.google.com/a/answer/9039184?hl=en&sjid=864417124752637253-EU
Reports:
  MITRE ATT&CK:
    - TA0001:T1078
RuleID: "GSuite.LoginType"
Runbook: >-
  Correct the user account settings so that only logins of approved types are available.
Severity: Medium
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
  - Configuration Required
  - Initial Access:Valid Accounts
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "login"
      "name": "login_success"
      "parameters":
        "login_type": "saml"
      "type": "login"
    Name: Login With Approved Type
  - ExpectedResult: true
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "login"
      "name": "login_success"
      "parameters":
        "login_type": "turbo-snail"
      "type": "login"
    Name: Login With Unapproved Type
  - ExpectedResult: false
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "logout"
      "name": "login_success"
      "parameters":
        "login_type": "saml"
      "type": "login"
    Name: Non-Login event
  - ExpectedResult: false
    Log:
      "actor":
        "email": "some.user@somedomain.com"
      "id":
        "applicationName": "saml"
        "time": "2022-05-26 15:26:09.421000000"
      "ipAddress": "10.10.10.10"
      "kind": "admin#reports#activity"
      "name": "login_success"
      "parameters":
        "application_name": "Some SAML Application"
        "initiated_by": "sp"
        "orgunit_path": "/SomeOrgUnit"
        "saml_status_code": "SUCCESS_URI"
      "type": "login"
    Name: Saml Login Event
