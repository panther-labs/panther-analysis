AnalysisType: rule
Description: >-
  A GSuite document's ownership was transferred to an external party.
DisplayName: "GSuite Document External Ownership Transfer"
Enabled: true
Filename: gsuite_doc_ownership_transfer.py
LogTypes:
  - GSuite.ActivityEvent
Reference: 
  https://support.google.com/drive/answer/2494892?hl=en&co=GENIE.Platform%3DDesktop&sjid=864417124752637253-EU
Reports:
  MITRE ATT&CK:
    - TA0009:T1213
RuleID: "GSuite.DocOwnershipTransfer"
Runbook: >-
  Verify that this document did not contain sensitive or private company information.
Severity: Low
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
  - Collection:Data from Information Repositories
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "email": "alice@panther.com"
        "profileId": "1234567890"
      "id":
        "applicationName": "drive"
        "customerId": "C123abcde"
        "time": "2025-08-12 18:41:56.232000000"
        "uniqueQualifier": "1234567890"
      "ipAddress": "1.2.3.4"
      "kind": "admin#reports#activity"
      "name": "change_owner"
      "parameters":
        "billable": true
        "doc_id": "1234567890"
        "doc_title": "sensitive_document.xlsx"
        "doc_type": "msexcel"
        "new_owner": "bob@panther.com"
        "owner": "alice@panther.com"
        "primary_event": true
        "visibility": "shared_internally"
      "type": "acl_change"
    Name: Ownership Transferred Within Organization
  - ExpectedResult: true
    Log:
      "actor":
        "email": "alice@panther.com"
        "profileId": "1234567890"
      "id":
        "applicationName": "drive"
        "customerId": "C123abcde"
        "time": "2025-07-11 19:50:09.324000000"
        "uniqueQualifier": "1234567890"
      "kind": "admin#reports#activity"
      "name": "change_owner"
      "parameters":
        "billable": true
        "doc_id": "1234567890"
        "doc_title": "sensitive_document.xlsx"
        "doc_type": "msexcel"
        "new_owner": "bob@example.com"
        "owner": "alice@panther.com"
        "primary_event": true
        "visibility": "unknown"
      "type": "acl_change"
    Name: Document Transferred to External User
  - ExpectedResult: false
    Log:
      "actor":
        "email": "alice@panther.com"
        "profileId": "100606748236723241722"
      "id":
        "applicationName": "drive"
        "customerId": "C123abcde"
        "time": "2025-07-07 23:50:22.743000000"
        "uniqueQualifier": "1234567890"
      "ipAddress": "1.2.3.4"
      "kind": "admin#reports#activity"
      "name": "change_owner"
      "parameters":
        "billable": true
        "doc_id": "1234567890"
        "doc_title": "sensitive_document.xlsx"
        "doc_type": "msexcel"
        "new_owner": "Execs"
        "new_owner_is_team_drive": true
        "new_owner_team_drive_id": "1234567890"
        "originating_app_id": "1234567890"
        "owner": "Engineering"
        "owner_is_shared_drive": true
        "owner_is_team_drive": true
        "owner_team_drive_id": "1234567890"
        "primary_event": true
        "shared_drive_id": "1234567890"
        "team_drive_id": "1234567890"
        "visibility": "shared_internally"
      "type": "acl_change"
    Name: Document Transferred to Group within Organization
