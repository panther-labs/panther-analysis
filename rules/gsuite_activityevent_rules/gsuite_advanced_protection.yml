AnalysisType: rule
Description: >-
  A user disabled advanced protection for themselves.
DisplayName: "GSuite User Advanced Protection Change"
Enabled: true
Filename: gsuite_advanced_protection.py
LogTypes:
  - GSuite.ActivityEvent
Reference: https://support.google.com/a/answer/9378686?hl=en&sjid=864417124752637253-EU
Reports:
  MITRE ATT&CK:
    - TA0005:T1562
RuleID: "GSuite.AdvancedProtection"
Runbook: >-
  Have the user re-enable Google Advanced Protection
Severity: Low
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
  - Defense Evasion:Impair Defenses
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "callerType": "USER"
        "email": "homer.simpson@example.com"
      "id":
        "applicationName": "user_accounts"
      "name": "titanium_enroll"
      "type": "titanium_change"
    Name: Advanced Protection Enabled
  - ExpectedResult: true
    Log:
      "actor":
        "callerType": "USER"
        "email": "homer.simpson@example.com"
      "id":
        "applicationName": "user_accounts"
      "name": "titanium_unenroll"
      "type": "titanium_change"
    Name: Advanced Protection Disabled
