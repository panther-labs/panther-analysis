AnalysisType: rule
Description: >-
  GSuite reported a suspicious login for this user.
DisplayName: "Suspicious GSuite Login"
Enabled: true
Filename: gsuite_suspicious_logins.py
LogTypes:
  - GSuite.ActivityEvent
Reference: https://support.google.com/a/answer/7102416?hl=en
RuleID: "GSuite.SuspiciousLogins"
Runbook: >-
  Checkout the details of the login and verify this behavior with the user to ensure
  the account wasn't compromised.
Severity: Medium
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
Tests:
  - ExpectedResult: false
    Log:
      "id":
        "applicationName": "login"
      "kind": "admin#reports#activity"
      "name": "login_success"
      "parameters":
        "affected_email_address": "bobert@ext.runpanther.io"
      "type": "account_warning"
    Name: Normal Login Event
  - ExpectedResult: false
    Log:
      "id":
        "applicationName": "login"
      "kind": "admin#reports#activity"
      "name": "account_disabled_spamming"
      "parameters":
        "affected_email_address": "bobert@ext.runpanther.io"
      "type": "account_warning"
    Name: Account Warning Not For Suspicious Login
  - ExpectedResult: true
    Log:
      "id":
        "applicationName": "login"
      "kind": "admin#reports#activity"
      "name": "suspicious_login"
      "parameters":
        "affected_email_address": "bobert@ext.runpanther.io"
      "type": "account_warning"
    Name: Account Warning For Suspicious Login
