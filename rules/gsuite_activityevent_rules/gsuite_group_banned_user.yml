AnalysisType: rule
Description: >-
  A GSuite user was banned from an enterprise group by moderator action.
DisplayName: "GSuite User Banned from Group"
Enabled: true
Filename: gsuite_group_banned_user.py
LogTypes:
  - GSuite.ActivityEvent
Reference: 
  https://support.google.com/a/users/answer/9303224?hl=en&sjid=864417124752637253-EU
RuleID: "GSuite.GroupBannedUser"
Runbook: >-
  Investigate the banned user to see if further disciplinary action needs to be taken.
Severity: Low
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "email": "homer.simpson@example.com"
      "id":
        "applicationName": "groups_enterprise"
      "name": "add_member"
      "type": "moderator_action"
    Name: User Added
  - ExpectedResult: true
    Log:
      "actor":
        "email": "homer.simpson@example.com"
      "id":
        "applicationName": "groups_enterprise"
      "name": "ban_user_with_moderation"
      "type": "moderator_action"
    Name: User Banned from Group
