AnalysisType: rule
Description: >-
  GSuite reported that it detected a government backed attack against your account.
DisplayName: "GSuite Government Backed Attack"
Enabled: true
Filename: gsuite_gov_attack.py
LogTypes:
  - GSuite.ActivityEvent
Reference: https://support.google.com/a/answer/9007870?hl=en
RuleID: "GSuite.GovernmentBackedAttack"
Runbook: >-
  Followup with GSuite support for more details.
Severity: Critical
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "email": "homer.simpson@example.com"
      "id":
        "applicationName": "login"
      "name": "login_success"
      "parameters":
        "is_suspicious":
        "login_challenge_method":
          - "none"
      "type": "login"
    Name: Normal Login Event
  - ExpectedResult: true
    Log:
      "actor":
        "email": "homer.simpson@example.com"
      "id":
        "applicationName": "login"
      "name": "gov_attack_warning"
      "parameters":
        "is_suspicious":
        "login_challenge_method":
          - "none"
      "type": "login"
    Name: Government Backed Attack Warning
