AnalysisType: rule
Filename: gsuite_gov_attack.py
RuleID: "GSuite.GovernmentBackedAttack"
DisplayName: "GSuite Government Backed Attack"
Enabled: true
LogTypes:
  - GSuite.ActivityEvent
Tags:
  - GSuite
  - APT
  - Advanced Persistent Threat
  - Nation State
  - Targeted Attack
  - Reconnaissance
  - Initial Access
  - Government Backed Attack
  - High Profile Target
Severity: Critical
Reports:
  MITRE ATT&CK:
    - TA0043:T1595
    - TA0001:T1566
    - TA0042:T1589
Description: >
  Detects when Google Workspace (GSuite) identifies and reports a government-backed attack targeting a user account within your organization. Google issues these warnings extremely rarely and only when their threat intelligence and security systems detect indicators consistent with nation-state threat actors or advanced persistent threat (APT) groups conducting reconnaissance, credential harvesting attempts, or targeted phishing campaigns against specific users. Government-backed attacks are characterized by sophisticated techniques, significant resources, persistence, and strategic objectives typically including espionage, intellectual property theft, supply chain compromise, or surveillance of high-value individuals such as executives, researchers, activists, journalists, or government officials. These threat actors employ advanced tactics including zero-day exploits, spear-phishing with legitimate-looking infrastructure, credential stuffing with previously compromised passwords, session hijacking, and social engineering tailored to the specific target. Google's detection is based on analyzing login patterns, device fingerprints, network infrastructure associated with known APT groups, correlation with global threat intelligence, and behavioral anomalies indicating reconnaissance or account compromise attempts. When Google issues this warning, it means the user account has been specifically targeted and is at elevated risk of compromise if not already compromised. This represents one of the highest severity security events because successful compromise by nation-state actors can lead to long-term persistent access, theft of sensitive intellectual property or communications, lateral movement to other systems, supply chain attacks affecting your customers, or reputational damage. Immediate action is required to protect the targeted user, investigate for signs of compromise, and implement enhanced security controls across the organization.
Reference: https://support.google.com/a/answer/9007870?hl=en
Runbook: |
  1. Query GSuite.ActivityEvent logs for all login events, OAuth app authorizations, email forwarding rules, delegated access grants, and data exports by actor:email in the 90 days before this warning to identify suspicious activity indicating potential compromise
  2. Review login locations, IP addresses, and device information from the targeted user's recent authentication events to detect unusual geographic access patterns or impossible travel that may indicate reconnaissance or account takeover attempts
  3. Contact Google Workspace enterprise support to obtain additional threat intelligence about the government-backed attack including threat actor attribution, attack vectors observed, and specific indicators of compromise related to this incident
SummaryAttributes:
  - actor:email
Tests:
  - Name: Normal Login Event
    ExpectedResult: false
    Log:
      {
        "id": { "applicationName": "login" },
        "actor": { "email": "homer.simpson@example.com" },
        "type": "login",
        "name": "login_success",
        "parameters":
          { "is_suspicious": null, "login_challenge_method": ["none"] },
      }
  - Name: Government Backed Attack Warning
    ExpectedResult: true
    Log:
      {
        "id": { "applicationName": "login" },
        "actor": { "email": "homer.simpson@example.com" },
        "type": "login",
        "name": "gov_attack_warning",
        "parameters":
          { "is_suspicious": null, "login_challenge_method": ["none"] },
      }
