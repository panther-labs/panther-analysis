AnalysisType: rule
Filename: signal_-_role_assumed_by_aws_service.py
RuleID: "SIGNAL.-.Role.Assumed.by.AWS.Service"
DisplayName: "SIGNAL - Role Assumed by AWS Service"
Enabled: true
LogTypes:
    - AWS.CloudTrail
Severity: Info
DedupPeriodMinutes: 60
Threshold: 1
InlineFilters:
    - All: []
Tests:
    - Name: Test-88a94b
      ExpectedResult: true
      Log:
        awsRegion: us-west-2
        eventCategory: Management
        eventID: 1f3d7d49-6637-3304-b959-9be15f20215d
        eventName: AssumeRole
        eventSource: sts.amazonaws.com
        eventTime: "2024-06-02 20:27:12"
        eventType: AwsApiCall
        eventVersion: "1.08"
        managementEvent: true
        p_any_aws_account_ids:
            - "042423170352"
        p_any_aws_arns:
            - arn:aws:iam::042423170352:role/panther-alert-search-rehydrate-api-fu-20230419225553598500000016
        p_any_domain_names:
            - lambda.amazonaws.com
        p_any_trace_ids:
            - ASIAQTYE6GUYIKQNXYMM
        p_event_time: "2024-06-02 20:27:12"
        p_log_type: AWS.CloudTrail
        p_parse_time: "2024-06-02 20:27:55.842"
        p_row_id: ea5a53042733b0969395d0dc1fead531
        p_schema_version: 0
        p_source_file:
            aws_s3_bucket: panther-hosted-ace-of-diamonds-cloudtrail-f9035976831c
            aws_s3_key: AWSLogs/o-he117ni5su/042423170352/CloudTrail/us-west-2/2024/06/02/042423170352_CloudTrail_us-west-2_20240602T2030Z_LBI6zrSBFvu8FtyB.json.gz
        p_source_id: 8cc9ee66-ba0d-4fef-b13f-2d82d7cf5615
        p_source_label: AWS CloudTrail Panther AoD
        p_timeline: "2024-06-02 20:27:12"
        p_udm:
            source:
                address: lambda.amazonaws.com
                domain: lambda.amazonaws.com
        readOnly: true
        recipientAccountId: "042423170352"
        requestID: a0dda101-6e27-4f88-8250-f3d475f88b56
        requestParameters:
            roleArn: arn:aws:iam::042423170352:role/panther-alert-search-rehydrate-api-fu-20230419225553598500000016
            roleSessionName: awslambda_55_20240602202712548
        resources:
            - accountId: "042423170352"
              arn: arn:aws:iam::042423170352:role/panther-alert-search-rehydrate-api-fu-20230419225553598500000016
              type: AWS::IAM::Role
        responseElements:
            credentials:
                accessKeyId: ASIAQTYE6GUYIKQNXYMM
                expiration: Jun 2, 2024, 10:37:12 PM
                sessionToken: IQoJb3JpZ2luX2VjEPX//////////wEaCXVzLXdlc3QtMiJHMEUCIQCxPVn4aRTEnxgckWiymH6sOtrMnEfuJQIq9XlNj9bnIwIgbbPFIEiSkJwP5USQBmNCCo+CiJqkOm2xyC38FqgSy50qogIIfhAAGgwwNDI0MjMxNzAzNTIiDAUOPCpTce+HW444dyr/ASU/DrVW3FqAeGrZAxrfWsanBHR1CwI5KhhJvJuS56GfLIdfYPfq6a/VPemw2SncxBek47+eOzNeewM7hrs9G9TT+6AWnjYh69urdNYL4CsePkmTriC7H2jwiqvpZ6/QTmS5b++4q4iC+QGvStfb5L4JQyz7f23BNsmKU1ebIhx8fkMQ2UOOTT2h6JMqaspy2YDYgAn7gHCH98KbPUCIQDN3Z3sb85V+V1lFy7zNtRLiNyXEdjKVLEnhk4uHT03HhU7Wzz9lptkkUMdXE62mnEsFLMA6uSGA8GbcbnIfXYeiCbbMY2NYbX7ZSwmoB+ZOOnX81uvVbjRlYbygT1JNCTCgq/OyBjqaATaJVSqYqa4MZr7zkp0Rgu+YhtMWELrFDm+2A+4MU6naYrl56jz+n13zzZbHhRsdpKFzXUaJmCdxMvt+QvziXRTxrb4dlwXGs1syrRllKFwkpovGuMSm0xVNnLdV1+1xJ5ItrnRaINt866ejHkeXJaIl+9qCJ7lWVMdig00mvdM5cFZkM00RFukINHTIUna1UYeHDdkeMgyZ6Ek=
        sharedEventID: 95e84e79-100a-40a6-985e-3c9c4b41f622
        sourceIPAddress: lambda.amazonaws.com
        userAgent: lambda.amazonaws.com
        userIdentity:
            invokedBy: lambda.amazonaws.com
            type: AWSService
CreateAlert: false
