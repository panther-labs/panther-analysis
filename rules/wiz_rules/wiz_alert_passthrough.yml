AnalysisType: rule
RuleID: Wiz.Alert.Passthrough
Description: This rule enriches and contextualizes security alerts generated by Wiz.
DisplayName: Wiz Alert Passthrough Rule
Runbook: Review the Wiz alert details to determine what malicious behavior was detected, and whether or not it was blocked.
Reference: https://www.wiz.io/product
Enabled: false
Filename: wiz_alert_passthrough.py
Severity: Medium
LogTypes:
  - Wiz.Issues
DedupPeriodMinutes: 720
Threshold: 1
Tests:
  - Name: Open Alert
    ExpectedResult: true
    Log:
      {
          "createdAt": "2024-06-04 02:28:06.763277000",
          "entitySnapshot": {
              "cloudProviderURL": "",
              "externalId": "someExternalId",
              "id": "12345",
              "name": "someName",
              "nativeType": "",
              "providerId": "someProviderId",
              "region": "",
              "resourceGroupExternalId": "",
              "subscriptionExternalId": "",
              "subscriptionName": "",
              "tags": { },
              "type": "DATA_FINDING"
          },
          "id": "54321",
          "notes": [ ],
          "projects": [
              {
                  "businessUnit": "",
                  "id": "45678",
                  "name": "Project 2",
                  "riskProfile": {
                      "businessImpact": "MBI"
                  },
                  "slug": "project-2"
              },
          ],
          "serviceTickets": [ ],
          "severity": "HIGH",
          "sourceRule": {
              "__typename": "Control",
              "controlDescription": "Alert Description",
              "id": "12345",
              "name": "Alert Name",
              "resolutionRecommendation": "Alert Resolution Recommendation",
              "securitySubCategories": [
                {
                  "category": {
                    "framework": {
                      "name": "Wiz for Risk Assessment"
                    },
                    "name": "High Profile Threats"
                  },
                  "title": "High-profile vulnerability exploited in the wild"
                },
                {
                  "category": {
                    "framework": {
                      "name": "MITRE ATT&CK Matrix"
                    },
                    "name": "TA0001 Initial Access"
                  },
                  "title": "T1190 Exploit Public-Facing Application"
                },
              ]
          },
          "status": "OPEN",
          "statusChangedAt": "2024-06-04 02:28:06.597355000",
          "type": "TOXIC_COMBINATION",
          "updatedAt": "2024-06-04 02:28:06.763277000"
      }
  - Name: Low-Severity Open Alert
    ExpectedResult: true
    Log:
      {
          "createdAt": "2024-06-04 02:28:06.763277000",
          "entitySnapshot": {
              "cloudProviderURL": "",
              "externalId": "someExternalId",
              "id": "12345",
              "name": "someName",
              "nativeType": "",
              "providerId": "someProviderId",
              "region": "",
              "resourceGroupExternalId": "",
              "subscriptionExternalId": "",
              "subscriptionName": "",
              "tags": { },
              "type": "DATA_FINDING"
          },
          "id": "54321",
          "notes": [ ],
          "projects": [
              {
                  "businessUnit": "",
                  "id": "45678",
                  "name": "Project 2",
                  "riskProfile": {
                      "businessImpact": "MBI"
                  },
                  "slug": "project-2"
              },
          ],
          "serviceTickets": [ ],
          "severity": "LOW",
          "sourceRule": {
              "__typename": "Control",
              "controlDescription": "Alert Description",
              "id": "12345",
              "name": "Alert Name",
              "resolutionRecommendation": "Alert Resolution Recommendation",
              "securitySubCategories": [
                {
                  "category": {
                    "framework": {
                      "name": "Wiz for Risk Assessment"
                    },
                    "name": "High Profile Threats"
                  },
                  "title": "High-profile vulnerability exploited in the wild"
                },
                {
                  "category": {
                    "framework": {
                      "name": "MITRE ATT&CK Matrix"
                    },
                    "name": "TA0001 Initial Access"
                  },
                  "title": "T1190 Exploit Public-Facing Application"
                },
              ]
          },
          "status": "OPEN",
          "statusChangedAt": "2024-06-04 02:28:06.597355000",
          "type": "TOXIC_COMBINATION",
          "updatedAt": "2024-06-04 02:28:06.763277000"
      }
  - Name: Resolved Alert
    ExpectedResult: false
    Log:
      {
          "createdAt": "2024-06-04 02:28:06.763277000",
          "entitySnapshot": {
              "cloudProviderURL": "",
              "externalId": "someExternalId",
              "id": "12345",
              "name": "someName",
              "nativeType": "",
              "providerId": "someProviderId",
              "region": "",
              "resourceGroupExternalId": "",
              "subscriptionExternalId": "",
              "subscriptionName": "",
              "tags": { },
              "type": "DATA_FINDING"
          },
          "id": "54321",
          "notes": [ ],
          "projects": [
              {
                  "businessUnit": "",
                  "id": "45678",
                  "name": "Project 2",
                  "riskProfile": {
                      "businessImpact": "MBI"
                  },
                  "slug": "project-2"
              },
          ],
          "serviceTickets": [ ],
          "severity": "HIGH",
          "sourceRule": {
              "__typename": "Control",
              "controlDescription": "Alert Description",
              "id": "12345",
              "name": "Alert Name",
              "resolutionRecommendation": "Alert Resolution Recommendation"
          },
          "status": "RESOLVED",
          "statusChangedAt": "2024-06-04 02:28:06.597355000",
          "type": "TOXIC_COMBINATION",
          "updatedAt": "2024-06-04 02:28:06.763277000"
      }
