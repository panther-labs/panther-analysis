AnalysisType: rule
DedupPeriodMinutes: 720
Description: >-
  This rule enriches and contextualizes security alerts generated by Wiz.
DisplayName: "Wiz Alert Passthrough Rule"
Enabled: true
Filename: wiz_alert_passthrough.py
LogTypes:
  - Wiz.Issues
Reference: https://www.wiz.io/product
RuleID: "Wiz.Alert.Passthrough"
Runbook: >-
  Review the Wiz alert details to determine what malicious behavior was detected,
  and whether or not it was blocked.
Severity: Medium
Tests:
  - ExpectedResult: true
    Log:
      "createdAt": "2024-06-04 02:28:06.763277000"
      "entitySnapshot":
        "cloudProviderURL": ""
        "externalId": "someExternalId"
        "id": "12345"
        "name": "someName"
        "nativeType": ""
        "providerId": "someProviderId"
        "region": ""
        "resourceGroupExternalId": ""
        "subscriptionExternalId": ""
        "subscriptionName": ""
        "tags": {}
        "type": "DATA_FINDING"
      "id": "54321"
      "notes": []
      "projects":
        - "businessUnit": ""
          "id": "45678"
          "name": "Project 2"
          "riskProfile":
            "businessImpact": "MBI"
          "slug": "project-2"
      "serviceTickets": []
      "severity": "HIGH"
      "sourceRule":
        "__typename": "Control"
        "controlDescription": "Alert Description"
        "id": "12345"
        "name": "Alert Name"
        "resolutionRecommendation": "Alert Resolution Recommendation"
        "securitySubCategories":
          - "category":
              "framework":
                "name": "Wiz for Risk Assessment"
              "name": "High Profile Threats"
            "title": "High-profile vulnerability exploited in the wild"
          - "category":
              "framework":
                "name": "MITRE ATT&CK Matrix"
              "name": "TA0001 Initial Access"
            "title": "T1190 Exploit Public-Facing Application"
      "status": "OPEN"
      "statusChangedAt": "2024-06-04 02:28:06.597355000"
      "type": "TOXIC_COMBINATION"
      "updatedAt": "2024-06-04 02:28:06.763277000"
    Name: Open Alert
  - ExpectedResult: true
    Log:
      "createdAt": "2024-06-04 02:28:06.763277000"
      "entitySnapshot":
        "cloudProviderURL": ""
        "externalId": "someExternalId"
        "id": "12345"
        "name": "someName"
        "nativeType": ""
        "providerId": "someProviderId"
        "region": ""
        "resourceGroupExternalId": ""
        "subscriptionExternalId": ""
        "subscriptionName": ""
        "tags": {}
        "type": "DATA_FINDING"
      "id": "54321"
      "notes": []
      "projects":
        - "businessUnit": ""
          "id": "45678"
          "name": "Project 2"
          "riskProfile":
            "businessImpact": "MBI"
          "slug": "project-2"
      "serviceTickets": []
      "severity": "LOW"
      "sourceRule":
        "__typename": "Control"
        "controlDescription": "Alert Description"
        "id": "12345"
        "name": "Alert Name"
        "resolutionRecommendation": "Alert Resolution Recommendation"
        "securitySubCategories":
          - "category":
              "framework":
                "name": "Wiz for Risk Assessment"
              "name": "High Profile Threats"
            "title": "High-profile vulnerability exploited in the wild"
          - "category":
              "framework":
                "name": "MITRE ATT&CK Matrix"
              "name": "TA0001 Initial Access"
            "title": "T1190 Exploit Public-Facing Application"
      "status": "OPEN"
      "statusChangedAt": "2024-06-04 02:28:06.597355000"
      "type": "TOXIC_COMBINATION"
      "updatedAt": "2024-06-04 02:28:06.763277000"
    Name: Low-Severity Open Alert
  - ExpectedResult: false
    Log:
      "createdAt": "2024-06-04 02:28:06.763277000"
      "entitySnapshot":
        "cloudProviderURL": ""
        "externalId": "someExternalId"
        "id": "12345"
        "name": "someName"
        "nativeType": ""
        "providerId": "someProviderId"
        "region": ""
        "resourceGroupExternalId": ""
        "subscriptionExternalId": ""
        "subscriptionName": ""
        "tags": {}
        "type": "DATA_FINDING"
      "id": "54321"
      "notes": []
      "projects":
        - "businessUnit": ""
          "id": "45678"
          "name": "Project 2"
          "riskProfile":
            "businessImpact": "MBI"
          "slug": "project-2"
      "serviceTickets": []
      "severity": "HIGH"
      "sourceRule":
        "__typename": "Control"
        "controlDescription": "Alert Description"
        "id": "12345"
        "name": "Alert Name"
        "resolutionRecommendation": "Alert Resolution Recommendation"
      "status": "RESOLVED"
      "statusChangedAt": "2024-06-04 02:28:06.597355000"
      "type": "TOXIC_COMBINATION"
      "updatedAt": "2024-06-04 02:28:06.763277000"
    Name: Resolved Alert
Threshold: 1
