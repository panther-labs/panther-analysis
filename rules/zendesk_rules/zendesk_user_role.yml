AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  A user's Zendesk role was changed
DisplayName: "Zendesk User Role Changed"
Enabled: true
Filename: zendesk_user_role.py
LogTypes:
  - Zendesk.Audit
Reference: 
  https://support.zendesk.com/hc/en-us/articles/4408824375450-Setting-roles-and-access-in-Zendesk-Admin-Center
RuleID: "Zendesk.UserRoleChanged"
Severity: Info
SummaryAttributes:
  - p_any_ip_addresses
Tests:
  - ExpectedResult: true
    Log:
      "action": "update"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Role changed from Administrator to End User"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Bob Cat"
      "source_type": "user"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - Role Changed
  - ExpectedResult: false
    Log:
      "action": "update"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Role changed from End User to Administrator"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Bob Cat"
      "source_type": "user"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - Admin Role Assigned
  - ExpectedResult: false
    Log:
      "action": "update"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Organization: AAAA is asigned"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Bob Cat"
      "source_type": "user"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - No changing roles
