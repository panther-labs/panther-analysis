AnalysisType: rule
Description: >-
  User enabled or disabled zendesk support user assumption.
DisplayName: "Enabled Zendesk Support to Assume Users"
Enabled: true
Filename: zendesk_user_assumption.py
LogTypes:
  - Zendesk.Audit
Reference: 
  https://support.zendesk.com/hc/en-us/articles/4408894200474-Assuming-end-users#:~:text=In%20Support%2C%20click%20the%20Customers,user%20in%20the%20information%20dialog
Reports:
  MITRE ATT&CK:
    - TA0008:T1550
RuleID: "Zendesk.UserAssumption"
Runbook: >-
  Investigate whether allowing zendesk support to assume users is necessary. If not,
  disable the feature.
Severity: Medium
SummaryAttributes:
  - p_any_ip_addresses
Tags:
  - Zendesk
  - Lateral Movement:Use Alternate Authentication Material
Tests:
  - ExpectedResult: true
    Log:
      "action": "update"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Changed"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Account Assumption"
      "source_type": "account_setting"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: User assumption settings changed
  - ExpectedResult: false
    Log:
      "action": "create"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Enabled"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Credit Card Redaction"
      "source_type": "account_setting"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - Credit Card Redaction On
