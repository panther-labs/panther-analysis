AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  A user's Zendesk suspension status was changed.
DisplayName: "Zendesk User Suspension Status Changed"
Enabled: true
Filename: zendesk_user_suspension.py
LogTypes:
  - Zendesk.Audit
Reference: 
  https://support.zendesk.com/hc/en-us/articles/4408889293978-Suspending-a-user#:~:text=select%20Unsuspend%20access.-,Identifying%20suspended%20users,name%20on%20the%20Customers%20page
Reports:
  MITRE ATT&CK:
    - TA0040:T1531
RuleID: "Zendesk.UserSuspension"
Runbook: >-
  Ensure the user's suspension status is appropriate.
Severity: High
SummaryAttributes:
  - p_any_ip_addresses
Tags:
  - Zendesk
  - Impact:Account Access Removal
Tests:
  - ExpectedResult: true
    Log:
      "action": "create"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Suspended"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Suspension state: Bob Cat"
      "source_type": "user_setting"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - Suspension Enabled
  - ExpectedResult: true
    Log:
      "action": "update"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Unsuspended"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Suspension state: Bob Cat"
      "source_type": "user_setting"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - Suspension Disabled
  - ExpectedResult: false
    Log:
      "action": "update"
      "action_label": "Updated"
      "actor_id": 123
      "actor_name": "John Doe"
      "change_description": "Role changed from End User to Administrator"
      "created_at": "2021-05-28T18:39:50Z"
      "id": 123456789123
      "ip_address": "127.0.0.1"
      "p_log_type": "Zendesk.Audit"
      "source_id": 123
      "source_label": "Bob Cat"
      "source_type": "user"
      "url": "https://myzendek.zendesk.com/api/v2/audit_logs/111222333444.json"
    Name: Zendesk - Admin Role Assigned
