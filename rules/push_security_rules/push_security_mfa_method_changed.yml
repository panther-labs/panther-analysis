AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  MFA method on SaaS app changed
DisplayName: "Push Security SaaS App MFA Method Changed"
Enabled: true
Filename: push_security_mfa_method_changed.py
LogTypes:
  - PushSecurity.Entities
RuleID: "Push.Security.MFA.Method.Changed"
Severity: Info
Tests:
  - ExpectedResult: true
    Log:
      "id": "d1e5794f-666d-4cba-abae-c6d889ca1903"
      "new":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods": []
        "mfaRegistered": false
        "passwordId":
      "object": "ACCOUNT"
      "old":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods":
          - "SMS"
        "mfaRegistered": false
        "passwordId":
      "timestamp": 1707775049.0
      "type": "CREATE"
      "version": "1"
    Name: All MFA methods removed
  - ExpectedResult: false
    Log:
      "id": "d1e5794f-666d-4cba-abae-c6d889ca1903"
      "new":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods":
          - "SMS"
          - "APP_OTP"
        "mfaRegistered": false
        "passwordId":
      "object": "ACCOUNT"
      "old":
      "timestamp": 1707775049.0
      "type": "CREATE"
      "version": "1"
    Name: First seen
  - ExpectedResult: true
    Log:
      "id": "d1e5794f-666d-4cba-abae-c6d889ca1903"
      "new":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods":
          - "SMS"
          - "APP_OTP"
        "mfaRegistered": false
        "passwordId":
      "object": "ACCOUNT"
      "old":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods":
          - "SMS"
        "mfaRegistered": false
        "passwordId":
      "timestamp": 1707775049.0
      "type": "CREATE"
      "version": "1"
    Name: MFA method added
  - ExpectedResult: false
    Log:
      "id": "d1e5794f-666d-4cba-abae-c6d889ca1903"
      "new":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods":
          - "SMS"
          - "APP_OTP"
        "mfaRegistered": false
        "passwordId":
      "object": "ACCOUNT"
      "old":
        "appId": "67ef5c13-b5e6-4945-af7b-c11ac98f630f"
        "appType": "CONTENTFUL"
        "creationTimestamp": 1707775048.0
        "email": "jet.black@issp.com"
        "employeeId": "ca6cf7ce-90e6-4eb5-a262-7899bc48c39c"
        "id": "5e15ce4c-6b93-4fbf-aed9-1890775efa90"
        "lastUsedTimestamp":
        "loginMethods":
          "oidcLogin":
          "oktaSwaLogin": false
          "passwordLogin": false
          "samlLogin":
        "mfaMethods":
          - "SMS"
          - "APP_OTP"
        "mfaRegistered": false
        "passwordId":
      "timestamp": 1707775049.0
      "type": "CREATE"
      "version": "1"
    Name: No MFA method change
Threshold: 1
