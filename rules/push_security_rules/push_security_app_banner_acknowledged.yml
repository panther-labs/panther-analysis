AnalysisType: rule
DedupPeriodMinutes: 60
DisplayName: "Push Security App Banner Acknowledged"
Enabled: true
Filename: push_security_app_banner_acknowledged.py
LogTypes:
  - PushSecurity.Activity
RuleID: "Push.Security.App.Banner.Acknowledged"
Severity: Low
Tests:
  - ExpectedResult: true
    Log:
      "id": "c478966c-f927-411c-b919-179832d3d50c"
      "new":
        "action": "ACKNOWLEDGED"
        "appBanner":
          "buttonText": "Proceed anyway"
          "mode": "ACKNOWLEDGE"
          "subtext": "This app is not approved, please use Google Drive instead."
          "title": "This app is not approved for use"
        "appType": "DROPBOX"
        "browser": "CHROME"
        "employee":
          "chatopsEnabled": true
          "creationTimestamp": 1698669223.0
          "department": "Security Engineering"
          "email": "john.hill@example.com"
          "firstName": "John"
          "id": "2a2197de-ad2c-47e4-8dcb-fb0f04cf83e0"
          "lastName": "Hill"
          "licensed": true
          "location": "New York"
        "os": "WINDOWS"
        "sourceIpAddress": "8.158.25.38"
        "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
          (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299"
      "object": "APP_BANNER"
      "timestamp": 1698604061.0
      "version": "1"
    Name: App Banner Acknowledged
  - ExpectedResult: false
    Log:
      "id": "c478966c-f927-411c-b919-179832d3d50c"
      "new":
        "action": "DISPLAYED"
        "appBanner":
          "buttonText": "Proceed anyway"
          "mode": "ACKNOWLEDGE"
          "subtext": "This app is not approved, please use Google Drive instead."
          "title": "This app is not approved for use"
        "appType": "DROPBOX"
        "browser": "CHROME"
        "employee":
          "chatopsEnabled": true
          "creationTimestamp": 1698669223.0
          "department": "Security Engineering"
          "email": "john.hill@example.com"
          "firstName": "John"
          "id": "2a2197de-ad2c-47e4-8dcb-fb0f04cf83e0"
          "lastName": "Hill"
          "licensed": true
          "location": "New York"
        "os": "WINDOWS"
        "sourceIpAddress": "8.158.25.38"
        "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
          (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299"
      "object": "APP_BANNER"
      "timestamp": 1698604061.0
      "version": "1"
    Name: App Banner Displayed
  - ExpectedResult: false
    Log:
      "id": "c478966c-f927-411c-b919-179832d3d50c"
      "new":
        "action": "DISPLAYED"
        "appBanner":
          "buttonText":
          "mode": "INFORM"
          "subtext": "This app is not approved, please use Google Drive instead."
          "title": "This app is not approved for use"
        "appType": "DROPBOX"
        "browser": "CHROME"
        "employee":
          "chatopsEnabled": true
          "creationTimestamp": 1698669223.0
          "department": "Security Engineering"
          "email": "john.hill@example.com"
          "firstName": "John"
          "id": "2a2197de-ad2c-47e4-8dcb-fb0f04cf83e0"
          "lastName": "Hill"
          "licensed": true
          "location": "New York"
        "os": "WINDOWS"
        "sourceIpAddress": "8.158.25.38"
        "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
          (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299"
      "object": "APP_BANNER"
      "timestamp": 1698604061.0
      "version": "1"
    Name: App Banner Inform Mode
Threshold: 1
