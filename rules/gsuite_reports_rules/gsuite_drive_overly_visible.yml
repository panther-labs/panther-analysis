AnalysisType: rule
DedupPeriodMinutes: 360
Description: >-
  A Google drive resource that is overly visible has been modified.
DisplayName: "GSuite Overly Visible Drive Document"
Enabled: true
Filename: gsuite_drive_overly_visible.py
LogTypes:
  - GSuite.Reports
Reference: 
  https://support.google.com/docs/answer/2494822?hl=en&co=GENIE.Platform%3DDesktop&sjid=864417124752637253-EU
Reports:
  MITRE ATT&CK:
    - TA0009:T1213
RuleID: "GSuite.DriveOverlyVisible"
Runbook: >-
  Investigate whether the drive document is appropriate to be this visible.
Severity: Info
SummaryAttributes:
  - actor:email
Tags:
  - GSuite
  - Collection:Data from Information Repositories
Tests:
  - ExpectedResult: false
    Log:
      "actor":
        "email": "bobert@example.com"
      "events":
        - "name": "download"
          "type": "access"
      "id":
        "applicationName": "drive"
      "p_row_id": "111222"
    Name: Access Event
  - ExpectedResult: false
    Log:
      "actor":
        "email": "bobert@example.com"
      "events":
        - "name": "edit"
          "parameters":
            - "name": "visibility"
              "value": "private"
          "type": "access"
      "id":
        "applicationName": "drive"
      "p_row_id": "111222"
    Name: Modify Event Without Over Visibility
  - ExpectedResult: true
    Log:
      "actor":
        "email": "bobert@example.com"
      "events":
        - "name": "edit"
          "parameters":
            - "name": "visibility"
              "value": "people_with_link"
            - "name": "doc_title"
              "value": "my shared document"
          "type": "access"
      "id":
        "applicationName": "drive"
      "p_row_id": "111222"
    Name: Overly Visible Doc Modified
  - ExpectedResult: true
    Log:
      "actor":
        "profileId": "1234567890123"
      "events":
        - "name": "edit"
          "parameters":
            - "name": "visibility"
              "value": "people_with_link"
            - "name": "doc_title"
              "value": "my shared document"
          "type": "access"
      "id":
        "applicationName": "drive"
      "p_row_id": "111222"
    Name: Overly Visible Doc Modified - no email
