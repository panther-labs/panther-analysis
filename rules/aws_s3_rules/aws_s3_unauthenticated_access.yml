AnalysisType: rule
Description: >-
  Checks for S3 access attempts where the requester is not an authenticated AWS user.
DisplayName: "AWS S3 Unauthenticated Access"
Enabled: false
Filename: aws_s3_unauthenticated_access.py
LogTypes:
  - AWS.S3ServerAccess
Reference: 
  https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-auth-workflow-bucket-operation.html
Reports:
  MITRE ATT&CK:
    - TA0009:T1530
RuleID: "AWS.S3.ServerAccess.Unauthenticated"
Runbook: >-
  If unauthenticated S3 access is not expected for this bucket, update its access
  policies.
Severity: Low
SummaryAttributes:
  - bucket
  - key
  - requester
Tags:
  - AWS
  - Configuration Required
  - Security Control
  - Collection:Data From Cloud Storage Object
Tests:
  - ExpectedResult: false
    Log:
      "bucket": "example-bucket"
      "requester": "79a59df900b949e55d96a1e698fbacedfd6e09d98eacf8f8d5218e7cd47ef2be"
    Name: Authenticated Access
  - ExpectedResult: true
    Log:
      "bucket": "example-bucket"
    Name: Unauthenticated Access
