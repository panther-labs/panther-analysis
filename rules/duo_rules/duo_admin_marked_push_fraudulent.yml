AnalysisType: rule
DedupPeriodMinutes: 15
Description: >-
  A Duo push was marked fraudulent by an admin.
DisplayName: "Duo Admin Marked Push Fraudulent"
Enabled: true
Filename: duo_admin_marked_push_fraudulent.py
LogTypes:
  - Duo.Administrator
Reference: https://duo.com/docs/adminapi#administrator-logs
RuleID: "DUO.Admin.Action.MarkedFraudulent"
Runbook: >-
  Follow up with the administrator to determine reasoning for marking fraud.
Severity: Medium
Tags:
  - Duo
Tests:
  - ExpectedResult: true
    Log:
      "action": "admin_2fa_error"
      "description": "{\"ip_address\": \"12.12.12.12\", \"email\": \"example@example.io\"\
        , \"factor\": \"push\", \"error\": \"Login request reported as fraudulent.\"\
        }"
      "isotimestamp": "2022-12-14 20:11:53"
      "timestamp": "2022-12-14 20:11:53"
      "username": "John P. Admin"
    Name: marked_fraud
  - ExpectedResult: false
    Log:
      "action": "admin_update"
      "description": "{}"
      "isotimestamp": "2022-12-14 20:11:53"
      "timestamp": "2022-12-14 20:11:53"
      "username": "John P. Admin"
    Name: different_admin_action
