AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  A Teleport Role was modified or created
DisplayName: "A Teleport Role was modified or created"
Enabled: true
Filename: teleport_role_created.py
LogTypes:
  - Gravitational.TeleportAudit
Reference: https://goteleport.com/docs/management/admin/
Reports:
  MITRE ATT&CK:
    - TA0003:T1098.001
RuleID: "Teleport.RoleCreated"
Runbook: >-
  A Teleport Role was modified or created. Validate its legitimacy.
Severity: Medium
SummaryAttributes:
  - event
  - code
  - user
  - name
Tags:
  - Teleport
Tests:
  - ExpectedResult: true
    Log:
      "cluster_name": "teleport.example.com"
      "code": "T9000I"
      "ei": 0
      "event": "role.created"
      "expires": "0001-01-01T00:00:00Z"
      "name": "teleport-event-handler"
      "time": "2023-09-20T23:00:000.000000Z"
      "uid": "88888888-4444-4444-4444-222222222222"
      "user": "max.mustermann@example.com"
    Name: A role was created
