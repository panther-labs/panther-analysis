AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  An external user has triggered a box enterprise event.
DisplayName: "Box event triggered by unknown or external user"
Enabled: false
Filename: box_event_triggered_externally.py
LogTypes:
  - Box.Event
Reference: 
  https://support.box.com/hc/en-us/articles/8391393127955-Using-the-Enterprise-Event-Stream
Reports:
  MITRE ATT&CK:
    - TA0010:T1567
RuleID: "Box.Event.Triggered.Externally"
Runbook: >-
  Investigate whether this user's activity is expected.
Severity: Medium
SummaryAttributes:
  - ip_address
Tags:
  - Box
  - Exfiltration:Exfiltration Over Web Service
  - Configuration Required
Tests:
  - ExpectedResult: false
    Log:
      "additional_details": "{\"key\": \"value\"}"
      "created_by":
        "id": "12345678"
        "login": "cat@example.com"
        "name": "Bob Cat"
        "type": "user"
      "event_type": "DELETE"
      "type": "event"
    Name: Regular Event
  - ExpectedResult: true
    Log:
      "created_by":
        "id": "2"
        "name": "Unknown User"
        "type": "user"
      "event_type": "PREVIEW"
      "ip_address": "1.2.3.4"
      "type": "event"
    Name: Previewed Anonymously
  - ExpectedResult: false
    Log:
      "event_type": "PREVIEW"
      "ip_address": "1.2.3.4"
      "type": "event"
    Name: Missing Created By
Threshold: 10
