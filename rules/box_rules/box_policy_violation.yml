AnalysisType: rule
Description: >-
  A user violated the content workflow policy.
DisplayName: "Box Content Workflow Policy Violation"
Enabled: true
Filename: box_policy_violation.py
LogTypes:
  - Box.Event
Reference: 
  https://support.box.com/hc/en-us/articles/360043692594-Creating-a-Security-Policy
RuleID: "Box.Content.Workflow.Policy.Violation"
Runbook: >-
  Investigate whether the user continues to violate the policy and take measure to
  ensure they understand policy.
Severity: Low
SummaryAttributes:
  - event_type
Tags:
  - Box
Tests:
  - ExpectedResult: false
    Log:
      "additional_details": "{\"key\": \"value\"}"
      "created_by":
        "id": "12345678"
        "login": "cat@example"
        "name": "Bob Cat"
        "type": "user"
      "event_type": "DELETE"
      "type": "event"
    Name: Regular Event
  - ExpectedResult: true
    Log:
      "additional_details": "{\"key\": \"value\"}"
      "created_by":
        "id": "12345678"
        "login": "cat@example"
        "name": "Bob Cat"
        "type": "user"
      "event_type": "CONTENT_WORKFLOW_UPLOAD_POLICY_VIOLATION"
      "source":
        "id": "12345678"
        "login": "user@example"
        "type": "user"
      "type": "event"
    Name: Upload Policy Violation
  - ExpectedResult: true
    Log:
      "additional_details":
        "key": "value"
      "created_by":
        "id": "12345678"
        "login": "cat@example"
        "name": "Mountain Lion"
        "type": "user"
      "event_type": "CONTENT_WORKFLOW_SHARING_POLICY_VIOLATION"
      "source":
        "id": "12345678"
        "login": "user@example"
        "type": "user"
      "type": "event"
    Name: Sharing Policy Violation
