AnalysisType: rule
DedupPeriodMinutes: 10
Description: >-
  Possible Denial of Service detected. Threshold for user account deletions exceeded.
DisplayName: "OneLogin Multiple Accounts Deleted"
Enabled: true
Filename: onelogin_threshold_accounts_deleted.py
LogTypes:
  - OneLogin.Events
Reference: https://en.wikipedia.org/wiki/Denial-of-service_attack
Reports:
  MITRE ATT&CK:
    - TA0040:T1531
RuleID: "OneLogin.ThresholdAccountsDeleted"
Runbook: >-
  Determine if this is normal user-cleanup activity.
Severity: Medium
SummaryAttributes:
  - account_id
  - user_name
  - user_id
Tags:
  - OneLogin
  - Impact:Account Access Removal
Tests:
  - ExpectedResult: false
    Log:
      "actor_user_id": 654321
      "actor_user_name": " Lion"
      "event_type_id": "16"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Normal User Activated Event
  - ExpectedResult: true
    Log:
      "actor_user_id": 654321
      "actor_user_name": " Lion"
      "event_type_id": "17"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: User Account Delete Event
Threshold: 10
