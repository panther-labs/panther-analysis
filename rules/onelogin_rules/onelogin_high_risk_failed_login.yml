AnalysisType: rule
Description: >-
  A OneLogin attempt with a high risk factor (>50) resulted in a failed authentication.
DisplayName: "OneLogin Failed High Risk Login"
Enabled: true
Filename: onelogin_high_risk_failed_login.py
LogTypes:
  - OneLogin.Events
Reference: https://resources.onelogin.com/OneLogin_RiskBasedAuthentication-WP-v5.pdf
RuleID: "OneLogin.HighRiskFailedLogin"
Runbook: >-
  Investigate why this user login is tagged as high risk as well as whether this was
  caused by expected user activity.
Severity: Low
SummaryAttributes:
  - account_id
  - user_name
  - user_id
Tags:
  - OneLogin
Tests:
  - ExpectedResult: false
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "event_type_id": "6"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Normal Login Event
  - ExpectedResult: true
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "event_type_id": "6"
      "risk_score": 55
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Failed High Risk Login
