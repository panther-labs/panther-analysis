AnalysisType: rule
Description: >-
  A user removed an authentication factor or otp device.
DisplayName: "OneLogin Authentication Factor Removed"
Enabled: true
Filename: onelogin_remove_authentication_factor.py
LogTypes:
  - OneLogin.Events
Reference: https://onelogin.service-now.com/kb_view_customer.do?sysparm_article=KB0010426
Reports:
  MITRE ATT&CK:
    - TA0005:T1556
RuleID: "OneLogin.AuthFactorRemoved"
Runbook: >-
  Investigate whether this was an intentional action and if other multifactor devices
  exist.
Severity: Low
SummaryAttributes:
  - account_id
  - event_type_id
  - user_name
  - user_id
  - authentication_factor_description
  - otp_device_name
Tags:
  - OneLogin
  - Identity & Access Management
  - Defense Evasion:Modify Authentication Process
Tests:
  - ExpectedResult: true
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "authentication_factor_description": "2FA Name"
      "event_type_id": "172"
      "user_id": 123456
      "user_name": "Bob Cat"
    LogType: OneLogin.Events
    Name: User removed an auth factor
  - ExpectedResult: true
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "event_type_id": "24"
      "otp_device_name": "2FA Name"
      "user_id": 123456
      "user_name": "Bob Cat"
    LogType: OneLogin.Events
    Name: User deactivated an otp deice
