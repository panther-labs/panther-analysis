AnalysisType: rule
Description: >-
  User locked or suspended from their account.
DisplayName: "OneLogin User Locked"
Enabled: true
Filename: onelogin_user_account_locked.py
LogTypes:
  - OneLogin.Events
Reference: https://onelogin.service-now.com/kb_view_customer.do?sysparm_article=KB0010420
Reports:
  MITRE ATT&CK:
    - TA0006:T1110
RuleID: "OneLogin.UserAccountLocked"
Runbook: >-
  Investigate whether this was caused by expected action.
Severity: Low
SummaryAttributes:
  - account_id
  - event_type_id
  - user_name
  - user_id
Tags:
  - OneLogin
  - Credential Access:Brute Force
Tests:
  - ExpectedResult: true
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "event_type_id": "531"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: User account locked via api - first method.
  - ExpectedResult: true
    Log:
      "actor_user_id": 654321
      "actor_user_name": "Mountain Lion"
      "event_type_id": "553"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: User account locked via api - second method.
  - ExpectedResult: true
    Log:
      "actor_user_id": 654321
      "actor_user_name": "Mountain Lion"
      "event_type_id": "551"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: User account suspended via api.
  - ExpectedResult: false
    Log:
      "actor_user_id": 654321
      "actor_user_name": "Mountain Lion"
      "event_type_id": "11"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Normal User Activated Event
