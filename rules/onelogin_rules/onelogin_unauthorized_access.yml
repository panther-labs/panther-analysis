AnalysisType: rule
DedupPeriodMinutes: 10
Description: >-
  A OneLogin user was denied access to an app more times than the configured threshold.
DisplayName: "OneLogin Unauthorized Access"
Enabled: true
Filename: onelogin_unauthorized_access.py
LogTypes:
  - OneLogin.Events
Reference: https://onelogin.service-now.com/kb_view_customer.do?sysparm_article=KB0010420
Reports:
  MITRE ATT&CK:
    - TA0008:T1550
RuleID: "OneLogin.UnauthorizedAccess"
Runbook: >-
  Analyze the user activity and actions.
Severity: Medium
SummaryAttributes:
  - account_id
  - user_name
  - user_id
  - app_name
Tags:
  - OneLogin
  - Lateral Movement:Use Alternate Authentication Material
Tests:
  - ExpectedResult: false
    Log:
      "app_name": "confluence"
      "event_type_id": "8"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Normal Event
  - ExpectedResult: true
    Log:
      "app_name": "confluence"
      "event_type_id": "90"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: User Unauthorized Access Event
Threshold: 10
