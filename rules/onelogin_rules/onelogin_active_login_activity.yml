AnalysisType: rule
Description: >-
  Multiple user accounts logged in from the same ip address.
DisplayName: "OneLogin Active Login Activity"
Enabled: true
Filename: onelogin_active_login_activity.py
LogTypes:
  - OneLogin.Events
Reference: https://support.onelogin.com/kb/4271392/user-policies
Reports:
  MITRE ATT&CK:
    - TA0008:T1550
RuleID: "OneLogin.ActiveLoginActivity"
Runbook: >-
  Investigate whether multiple user's logging in from the same ip address is expected.
  Determine if this ip address should be added to the SHARED_IP_SPACE array.
Severity: Medium
SummaryAttributes:
  - account_id
  - user_name
  - user_id
Tags:
  - OneLogin
  - Lateral Movement:Use Alternate Authentication Material
Tests:
  - ExpectedResult: false
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "event_type_id": "6"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Normal Login Event
  - ExpectedResult: false
    Log:
      "actor_user_id": 123456
      "actor_user_name": "Bob Cat"
      "event_type_id": "5"
      "ipaddr": "192.168.1.1"
      "user_id": 123456
      "user_name": "Bob Cat"
    Name: Shared IP Login Event
