AnalysisType: rule
Filename: log4j_exploit_iocs.py
RuleID: "IOC.Log4jExploit"
DisplayName: "DEPRECATED - Log4J Exploit IOC Search"
Enabled: False
LogTypes:
  - AWS.ALB
  - AWS.CloudTrail
  - AWS.S3ServerAccess
  - Apache.AccessCombined
  - Apache.AccessCommon
  - Cloudflare.Firewall
  - Cloudflare.HttpRequest
  - Fastly.Access
  - GCP.AuditLog
  - Juniper.Access
  - Juniper.Firewall
  - Nginx.Access
  - Syslog.RFC3164
  - Syslog.RFC5424
Tags:
  - AWS
  - GCP
  - Web
  - Log4J
  - Execution:Exploitation for Client Execution
  - Deprecated
Reports:
  MITRE ATT&CK:
    - TA0002:T1203
Severity: Info
Description: >
  Monitors for potential exploit attempts agains CVE-2021-44228, Log4J remote code execution
Reference: >
  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228
Runbook: >
  Investigate exploit attempt event content to determine scope and type of exploitation. Patch Log4J to the latest patched version
SummaryAttributes:
  - p_any_domain_names
  - p_any_ip_addresses
  - p_log_type
  - p_source_label
Tests:
  - Name: No Exploit found
    ExpectedResult: false
    Log:
      {
        "src_addr": "10.10.10.123",
        "dst_addr": "10.10.10.124",
        "payload": "Nothing to see here",
      }
