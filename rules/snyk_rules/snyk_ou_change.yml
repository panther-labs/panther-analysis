AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  Detects when Snyk Group or Organization Settings are changed.
DisplayName: "Snyk Org or Group Settings Change"
Enabled: true
Filename: snyk_ou_change.py
LogTypes:
  - Snyk.GroupAudit
  - Snyk.OrgAudit
Reference: https://docs.snyk.io/snyk-admin/introduction-to-snyk-administration
RuleID: "Snyk.OU.Change"
Runbook: >-
  These actions in the Snyk Audit logs indicate that a Organization or Group setting
  has changed, including Group and Org creation/deletion. Deletion events are marked
  with HIGH severity Creation events are marked with INFO severity Edit events are
  marked with MEDIUM Severity
Severity: High
SummaryAttributes:
  - event
Tags:
  - Snyk
Tests:
  - ExpectedResult: true
    Log:
      "content":
        "orgName": "expendable-org"
      "created": "2023-04-09T23:32:14.649Z"
      "event": "org.delete"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
      "orgId": "21111111-a222-4eee-8ddd-a99999999999"
      "userId": "05555555-3333-4ddd-8ccc-755555555555"
    Name: Snyk Org Deletion ( HIGH )
  - ExpectedResult: true
    Log:
      "content":
        "orgName": "expendable-org"
      "created": "2023-04-09T23:32:14.649Z"
      "event": "group.org.remove"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
      "orgId": "21111111-a222-4eee-8ddd-a99999999999"
      "userId": "05555555-3333-4ddd-8ccc-755555555555"
    Name: Snyk Group Org Remove ( HIGH )
  - ExpectedResult: true
    Log:
      "content":
        "updatedValues":
          "projectTestFrequencySetting": "daily"
      "created": "2023-04-11T23:22:57.667Z"
      "event": "group.edit"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
    Name: Snyk Group Edit ( MEDIUM )
  - ExpectedResult: true
    Log:
      "content":
        "newOrgPublicId": "21111111-a222-4eee-8ddd-a99999999999"
      "created": "2023-04-11T23:12:33.206Z"
      "event": "org.create"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
      "userId": "05555555-3333-4ddd-8ccc-755555555555"
    Name: Snyk Org Create ( INFO )
  - ExpectedResult: false
    Log:
      "content": {}
      "created": "2023-03-15 13:13:13.133"
      "event": "group.sso.membership.sync"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
    Name: Snyk Group SSO Membership sync
Threshold: 1
