AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  Detects when Snyk settings that lack a clear security impact are changed
DisplayName: "Snyk Miscellaneous Settings"
Enabled: true
Filename: snyk_misc_settings.py
LogTypes:
  - Snyk.GroupAudit
  - Snyk.OrgAudit
Reference: https://docs.snyk.io/snyk-admin/manage-settings
RuleID: "Snyk.Misc.Settings"
Severity: Low
SummaryAttributes:
  - event
Tags:
  - Snyk
Tests:
  - ExpectedResult: true
    Log:
      "created": "2023-04-11 23:32:14.173"
      "event": "group.feature_flags.edit"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
      "orgId": "21111111-a222-4eee-8ddd-a99999999999"
      "userId": "05555555-3333-4ddd-8ccc-755555555555"
    Name: Snyk Feature Flags changed
  - ExpectedResult: false
    Log:
      "content": {}
      "created": "2023-04-11 23:32:13.248"
      "event": "org.user.invite.revoke"
      "groupId": "8fffffff-1555-4444-b000-b55555555555"
      "orgId": "21111111-a222-4eee-8ddd-a99999999999"
      "userId": "05555555-3333-4ddd-8ccc-755555555555"
    Name: Snyk User Invite Revoke
Threshold: 1
