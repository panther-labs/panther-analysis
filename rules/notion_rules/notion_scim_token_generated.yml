AnalysisType: rule
DedupPeriodMinutes: 60
Description: >-
  A Notion User generated a SCIM token.
DisplayName: "Notion SCIM Token Generated"
Enabled: true
Filename: notion_scim_token_generated.py
LogTypes:
  - Notion.AuditLogs
Reference: https://www.notion.so/help/provision-users-and-groups-with-scim
RuleID: "Notion.Workspace.SCIM.Token.Generated"
Runbook: >-
  Possible Initial Access. Follow up with the Notion User to determine if this was
  done for a valid business reason.
Severity: Medium
Tags:
  - Notion
  - Application Security
  - Supply Chain Attack
Tests:
  - ExpectedResult: false
    Log:
      "event":
        "actor":
          "id": ".."
          "object": "user"
          "person":
            "email": "homer.simpson@yourcompany.io"
          "type": "person"
        "id": "..."
        "ip_address": "..."
        "platform": "mac-desktop"
        "timestamp": "2023-06-02T20:16:41.217Z"
        "type": "workspace.content_exported"
        "workspace.content_exported": {}
        "workspace_id": "123"
    Name: other event
  - ExpectedResult: true
    Log:
      "event":
        "actor":
          "id": ".."
          "object": "user"
          "person":
            "email": "homer.simpson@yourcompany.com"
          "type": "person"
        "id": "..."
        "ip_address": "..."
        "platform": "mac-desktop"
        "timestamp": "2023-06-02T20:21:01.873Z"
        "type": "workspace.scim_token_generated"
        "workspace.scim_token_generated": {}
        "workspace_id": "123"
    Name: Token Generated
Threshold: 1
