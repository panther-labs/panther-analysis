AnalysisType: pack
PackID: PantherManaged.AWS.Core
DisplayName: "Panther Core AWS Pack"
Description: This is a group of detections that act on data sourced from AWS.
PackDefinition:
  IDs:
    # Data Exposure
    - AWS.AMI.Private
    - AWS.CloudTrail.AMIModifiedForPublicAccess
    - AWS.CloudTrail.S3Bucket.Public
    - AWS.IAM.AccessKeyCompromised
    - AWS.KMS.RestrictsUsage
    - AWS.KMS.CustomerManagedKeyLoss
    - AWS.RDS.Instance.PublicAccess
    - AWS.RDS.Instance.SnapshotPublicAccess
    - AWS.S3.Bucket.PublicRead
    - AWS.S3.Bucket.PublicWrite
    - AWS.S3.Bucket.PolicyAllowWithNotPrincipal
    - AWS.S3.Bucket.PrincipalRestrictions
    - AWS.S3.Bucket.PublicAccessBlock
    - AWS.S3.Bucket.SecureAccess
    - AWS.S3.Bucket.Versioning
    - AWS.EC2.Traffic.Mirroring
    - AWS.Macie.Evasion
    - AWS.CloudTrail.ResourceMadePublic
    - AWS.CloudTrail.SnapshotMadePublic
    - AWS.EC2.Instance.DetailedMonitoring
    # Encryption Status
    - AWS.EC2.Volume.Encryption
    - AWS.EC2.Volume.Snapshot.Encrypted
    - AWS.EC2.EBS.Encryption.Disabled
    - AWS.Redshift.Cluster.Encryption
    - AWS.RDS.Instance.Encryption
    - AWS.S3.Bucket.Encryption
    # Networking Policies
    - AWS.NetworkACL.RestrictsInboundTraffic
    - AWS.SecurityGroup.AdministrativeIngress
    - AWS.SecurityGroup.OnlyDMZPubliclyAccessible
    - AWS.SecurityGroup.RestrictsInboundTraffic
    - AWS.EC2.GatewayModified
    - AWS.EC2.Monitoring
    - AWS.EC2.NetworkACLModified
    - AWS.EC2.RouteTableModified
    - AWS.EC2.VPCModified
    - AWS.IPSet.Modified
    - AWS.CloudTrail.NetworkACLPermissiveEntry
    - AWS.DNS.Crypto.Domain
    - AWS.VPC.HealthyLogStatus
    # Root Activity
    - AWS.Console.RootLogin
    - AWS.Console.RootLoginFailed
    - AWS.Root.Activity
    - AWS.CloudTrail.RootAccessKeyCreated
    - AWS.CloudTrail.RootPasswordChanged
    - AWS.RootAccount.AccessKeys
    - AWS.RootAccount.MFA
    - AWS.EC2.Instance.DetailedMonitoring
    # User and Account Policies and Rules
    - AWS.Console.LoginWithoutMFA
    - AWS.Console.LoginWithoutSAML
    - AWS.PasswordPolicy.PasswordReuse
    - AWS.Suspicious.SAML.Activity
    - AWS.IAM.Entity.InlinePolicyDoesNotGrantNetworkAdminAccess
    - AWS.IAM.User.MFA
    - AWS.Password.Unused
    - AWS.PasswordPolicy.ComplexityGuidelines
    - AWS.PasswordPolicy.PasswordAgeLimit
    - AWS.EC2.SecurityGroupModified
    - AWS.CloudTrail.IAMAnythingChanged
    - AWS.IAM.PolicyModified
    - AWS.IAM.Backdoor.User.Keys
    - AWS.IAMUser.ReconAccessDenied
    - AWS.IAM.CredentialsUpdated
    - AWS.User.Login.Profile.Modified
    - AWS.CloudTrail.Password.Policy.Discovery
    - AWS.IAM.Group.Users
    - AWS.IAM.Policy.AssignedToUser
    - AWS.CloudTrail.IAMCompromisedKeyQuarantine
    # General Policies and Rules
    - AWS.ACM.Certificate.Valid
    - AWS.ACM.Certificate.Expiration
    - AWS.CloudTrail.Created
    - AWS.CloudTrail.Enabled
    - AWS.CloudTrail.Stopped
    - AWS.CloudTrail.CodebuildProjectMadePublic
    - AWS.ConfigService.Created
    - AWS.ConfigService.DisabledDeleted
    - AWS.Config.RecordingEnabled
    - AWS.Config.RecordingNoErrors
    - AWS.IAM.Policy.AdministrativePrivileges
    - AWS.GuardDuty.Enabled
    - AWS.GuardDuty.HighSeverityFinding
    - AWS.GuardDuty.MediumSeverityFinding
    - AWS.GuardDuty.LowSeverityFinding
    - AWS.ELBV2.LoadBalancer.HasSSLPolicy
    - AWS.ELBv2.SSLPolicy
    - AWS.WAF.HasXSSPredicate
    - AWS.WAF.Disassociation
    - AWS.EC2.Startup.Script.Change
    - AWS.EC2.Instance.EBSOptimization
    - AWS.RDS.MasterPasswordUpdated
    - AWS.RDS.PublicRestore
    - AWS.RDS.InstanceHighAvailability
    - AWS.S3.GreyNoiseActivity
    - AWS.S3.BucketDeleted
    - AWS.S3.BucketPolicyModified
    - AWS.S3.Bucket.ActionRestrictions
    - AWS.S3.ServerAccess.Error
    - AWS.S3.ServerAccess.Insecure
    - AWS.S3.Bucket.LifecycleConfiguration
    - AWS.S3.Bucket.Logging
    - AWS.S3.Bucket.MFADelete
    - AWS.S3.Bucket.NameDNSCompliance
    - AWS.CloudTrail.SecurityConfigurationChange
    - AWS.SecurityHub.Finding.Evasion
    - AWS.CloudTrail.UnauthorizedAPICall
    - Amazon.EKS.Audit.Multiple403
    - Amazon.EKS.Audit.SystemNamespaceFromPublicIP
    - AWS.CloudFormation.Stack.Drifted
    - AWS.CloudFormation.Stack.UsesIAMServiceRole
    - AWS.CloudFormation.Stack.TerminationProtection
    - AWS.CloudWatchLogs.DataRetention1Year
    - AWS.CloudWatchLogs.Encrypted
    - AWS.Config.RecordAllResourceTypes
    - AWS.Config.GlobalResources
    - AWS.DynamoDB.Autoscaling
    - AWS.AccessKey.Rotation
    - AWS.AccessKey.Unused
    - AWS.AccessKeys.AccountCreation
    - AWS.Redshift.Cluster.Logging
    - AWS.Redshift.Cluster.SnapshotRetention
    - AWS.Redshift.Cluster.VersionUpgrade
    - AWS.VPC.CryptoPorts
    - AWS.VPC.FlowLogs
    # AWS DataModels
    - Standard.AWS.ALB
    - Standard.AWS.CloudTrail
    - Standard.AWS.S3ServerAccess
    - Standard.AWS.VPCFlow
    # Globals used in these rules/policies
    - panther_base_helpers
    - panther_default
    - panther_event_type_helpers
    - panther_greynoise_helpers
    - panther_lookuptable_helpers
    - panther_oss_helpers
